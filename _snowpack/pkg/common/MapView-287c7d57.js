import { e as e$e, y as y$e, j as o$g, i as i$o, a as a$j, D as e$f, w as u$j, F as o$h, u as u$k, L as L$5, G as r$e, H as m$l, n as n$v, I as u$l, J as t$f, K as L$6, O as S$7, s as s$n, v as c$r, P as r$f, Q as a$k, C as U$5, E as E$5, R as c$u, T as i$r, V as a$m, W as s$o, m as n$y, X as C$8, Y as e$i, Z as d$j, _ as j$5, $ as r$g, a0 as v$8, o as o$k, a1 as e$m, a2 as u$p, a3 as i$s, a4 as k$5, a5 as M$6, a6 as A$4, a7 as k$6, B as g$g, a8 as v$9, h as h$h, a9 as s$p, aa as q$4, ab as b$9, ac as o$l, ad as b$a, ae as m$n, af as L$8, ag as s$q, ah as x$4, ai as g$h, aj as n$A, k as f$d, ak as d$l, M as M$7, A as k$7, al as m$p, S as S$8, am as s$r, an as s$t, ao as c$A, ap as g$j, aq as S$9, ar as o$n, as as t$m, at as f$e, au as x$5, av as c$B, aw as o$o, ax as o$q, ay as y$i } from './Identifiable-c8406192.js';
import { y as y$f, a as t$g } from './config-b3bf08ce.js';
import { n as n$x } from './Graphic-9f79c7db.js';
import { l as l$n } from './CollectionFlattener-5ff807fc.js';
import { d as d$f, C as C$7, h as h$g, B as B$5, O as O$5, j as j$6, y as y$h, $ as $$4, x as x$6, b as b$c, w as w$5 } from './watchUtils-880dbce7.js';
import { m as m$q } from './workers-31c2755c.js';
import { i as i$p, o as o$i, e as e$h, L as L$7, p as p$y, u as u$n, d as d$i, y as y$g, g as g$f, a as e$l, r as r$h, t as t$j, b as o$p } from './Widget-2f53b352.js';
import { l as l$l, d as d$h, a as a$l } from './HandleOwner-2c2dff93.js';
import { n as n$w, o as o$j, i as i$q, c as c$s, a as c$t, b as c$v, d as c$w, e as c$x, f as a$o } from './PopupTemplate-77ad81c4.js';
import { e as e$j, a as e$k, t as t$i, n as n$z } from './GoTo-21ecf3ed.js';
import { e as e$g, r as r$d } from './widget-0e54f9c7.js';
import { G as G$4 } from './unitUtils-1b0a3531.js';
import { u as u$m, l as l$m } from './RelationshipQuery-1cbf03e3.js';
import { d as d$g, x as x$3 } from './QueryTask-60c0f90b.js';
import { c as ce, X as X$2, T as T$4, a as a$n } from './fieldUtils-a9f71c96.js';
import { R as R$4, m as m$m } from './Query-448be42b.js';
import { k as ke } from './FeatureLayer-346f29ad.js';
import { u as u$o, c as c$y } from './symbols-a702d148.js';
import { b as b$8 } from './Layer-d22ad00d.js';
import { v as v$7, M as M$5, q as q$3 } from './utils-68b4615c.js';
import { t as t$h, h as h$k } from './TileInfoView-40300351.js';
import { p as p$z } from './jsonUtils-d762dc00.js';
import { C as C$9 } from './mathUtils-25e61b42.js';
import { i as i$u, x as x$7 } from './TileInfo-f085f660.js';
import './TileKey-482fe256.js';
import { g as g$i } from './Map-3c24a571.js';
import { d as d$m, t as t$o } from './TimeExtent-155cb8a4.js';
import { v as v$a } from './HeightModelInfo-f665a73c.js';
import { m as m$o, u as u$q } from './GraphicsCollection-afd60f67.js';
import { d as d$k } from './arcgisLayerUrl-d85d6d65.js';
import { r as r$j, s as s$s, d as d$o } from './vec3-ae5ae182.js';
import { n as n$B, t as t$k, s as s$v, r as r$m, M as M$9, h as h$j, i as i$v } from './mat3-425ec876.js';
import { r as r$i, a as a$p, D as D$4, C as C$a, l as l$o, p as p$A, s as s$u, o as o$m, g as g$k, j as j$7, _ as _$7, b as b$b, d as d$n } from './vec2-f6c2e17c.js';
import { h as h$i, e as e$n, n as n$C, i as i$t, c as c$z, M as M$8, r as r$k, a as n$D, t as t$n } from './TileStrategy-ff1490fc.js';
import { t as t$l, r as r$l } from './unitBezier-6bff3f6f.js';
import { V as V$3, H as H$3 } from './projection-1aa78979.js';
import { r as r$n } from './capabilities-6619b906.js';

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
var c$q;let i$n=c$q=class extends a$j{constructor(o){super(o),this.color=new o$g([0,0,0,1]);}clone(){return new c$q(y$f({color:this.color}))}};e$e([y$e({type:o$g,json:{write:!0}})],i$n.prototype,"color",void 0),i$n=c$q=e$e([i$o("esri.webmap.background.ColorBackground")],i$n);var m$k=i$n;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const i$m=2048,h$f=1.5,e$d=8;function o$f(i,h){const{format:e,quality:o,rotation:n,disableDecorations:a}=i||{},r=x$2(i,h.padding),l=M$4(i,{width:h.width-r.left-r.right,height:h.height-r.top-r.bottom}),{width:g,height:d}=m$j(i,l),f=b$7(e),u=C$6[f];return {format:f,quality:e$f(null!=o?o:u,0,100),area:l,width:g,height:d,rotation:n,disableDecorations:!!a,ignoreBackground:!(!i||!i.ignoreBackground),ignorePadding:!(!i||!i.ignorePadding)}}function n$u(t,i){const h=o$f(t,i),e=h.area,n=h.width/e.width,a=x$2(h,i.padding),r=a.left+a.right,l=a.top+a.bottom,g=i.width-r,d=i.height-l,f=Math.floor(g*n+r),u=Math.floor(d*n+l),c=t&&t.layers?t.layers:[],s=h.ignoreBackground,w=h.ignorePadding;return {framebufferWidth:f,framebufferHeight:u,region:{x:Math.floor(e.x*n)+a.left,y:Math.floor(e.y*n)+a.top,width:h.width,height:h.height},format:h.format,quality:h.quality,rotation:h.rotation,pixelRatio:n,layers:c,disableDecorations:h.disableDecorations,ignoreBackground:s,ignorePadding:w}}function a$i(t,i,h,e){e.premultipliedAlpha&&D$3(t),h.width=t.width,h.height=t.height;const o=h.getContext("2d");o.putImageData(t,0,0),e.flipY&&j$4(o);const n=o.getImageData(0,0,t.width,t.height),a=r$c(h,i);return h.width=0,h.height=0,{dataUrl:a,data:n}}function r$c(t,i){const h=q$2[i.format],e=i.quality/100;return t.toDataURL(h,e)}function l$k(t,i,h){if(!t||!i)throw new Error("Cannot construct image data without dimensions");if(s$m)try{return new ImageData(t,i)}catch(e){s$m=!1;}return u$i(t,i,h)}function d$e(t,i,h,e=0,o=0,n=t.width-e,a=t.height-o,r=!1){const{data:l}=t,{width:g,height:d,data:f}=i,u=n/g,c=a/d,s=Math.ceil(u/2),w=Math.ceil(c/2),m=t.width;for(let M=0;M<d;M++)for(let t=0;t<g;t++){const i=4*(t+(r?d-M-1:M)*g);let n=0,a=0,p=0,y=0,x=0,b=0;const j=(M+.5)*c;for(let r=Math.floor(M*c);r<(M+1)*c;r++){const i=Math.abs(j-(r+.5))/w,g=(t+.5)*u,d=i*i;for(let f=Math.floor(t*u);f<(t+1)*u;f++){const t=Math.abs(g-(f+.5))/s,i=Math.sqrt(d+t*t);if(i>=1)continue;let u=2*i*i*i-3*i*i+1;const c=4*(e+f+(o+r)*m);b+=u*l[c+3],a+=u,!h&&l[c+3]<255&&(u=u*l[c+3]/255),p+=u*l[c],y+=u*l[c+1],x+=u*l[c+2],n+=u;}}f[i]=p/n,f[i+1]=y/n,f[i+2]=x/n,f[i+3]=b/a;}return i}function f$c(t,o,n){if(!o)return t;const{framebufferWidth:a,framebufferHeight:r,pixelRatio:l,region:g}=t,d=x$2(t,n),f=d.left+d.right,u=d.top+d.bottom,c=a-f,s=r-u,w=Math.min(e$d,Math.min((i$m-f)/c,(i$m-u)/s));return w<h$f?t:{...t,framebufferWidth:Math.round(c*w)+f,framebufferHeight:Math.round(s*w)+u,pixelRatio:l*w,resample:{region:{x:Math.round((g.x-d.left)*w)+d.left,y:Math.round((g.y-d.top)*w)+d.top,width:Math.round(g.width*w),height:Math.round(g.height*w)},width:a,height:r}}}function u$i(t,i,h){return h||(h=w$4()),h.getContext("2d").createImageData(t,i)}let c$p=null,s$m=!0;function w$4(){return c$p||(c$p=document.createElement("canvas"),c$p.width=1,c$p.height=1),c$p}function m$j(t,i){if(!t)return i;const h=t.width,e=t.height;if(null!=h&&null!=e)return {width:Math.floor(h),height:Math.floor(e)};if(null==h&&null==e)return i;const o=i.width/i.height;return null==e?{width:Math.floor(h),height:Math.floor(h/o)}:{width:Math.floor(e*o),height:Math.floor(e)}}function M$4(t,i){const h={x:0,y:0,width:i.width,height:i.height};if(t&&t.area){null!=t.area.x&&(h.x=Math.floor(t.area.x)),null!=t.area.y&&(h.y=Math.floor(t.area.y));const e=null!=t.area.width?Math.floor(t.area.width):null,o=null!=t.area.height?Math.floor(t.area.height):null;if(h.width=i.width-h.x,h.height=i.height-h.y,null!=e&&null!=o)h.width=Math.min(h.width,e),h.height=Math.min(h.height,o);else if(null==e&&null!=o){const t=Math.min(h.width,e);h.height=t/h.width*h.height,h.width=t;}else if(null!=e&&null==o){const t=Math.min(h.height,o);h.width=t/h.height*h.width,h.height=t;}}return p$x(y$d(h,t),i)}function p$x(t,i){const h=Math.floor(Math.max(t.x,0)),e=Math.floor(Math.max(t.y,0)),o={x:h,y:e,width:Math.floor(Math.min(t.width,i.width-h)),height:Math.floor(Math.min(t.height,i.height-e))},n=o.width/o.height,a=t.width/t.height;if(a===n)return o;if(a>n){const t=Math.floor(o.width/a),i=o.height-t;return {x:o.x,y:Math.floor(o.y+i/2),width:o.width,height:t}}const r=Math.floor(o.height*a),l=o.width-r;return {x:Math.floor(o.x+l/2),y:o.y,width:r,height:o.height}}function y$d(t,i){if(!i||null==i.width||null==i.height)return t;const h=i.width/i.height,e=t.width/t.height;if(e===h)return t;if(e<h){const i=Math.floor(t.height*h);return t.x-=(i-t.width)/2,t.width=i,t}const o=Math.floor(t.width/h);return t.y-=(o-t.height)/2,t.height=o,t}function x$2(t,i){return !i||t&&t.ignorePadding?P$5:i}function b$7(t){switch(t){case"png":case"jpg":case"jpeg":return t;case null:case void 0:default:return v$6}}function j$4(t){t.save(),t.globalCompositeOperation="copy",t.scale(1,-1),t.translate(0,-t.canvas.height),t.drawImage(t.canvas,0,0),t.restore();}function D$3(t){const i=t.data,h=i.length;for(let e=0;e<h;e+=4){const t=i[e+3];if(t>0){const h=t/255;i[e+0]=i[e+0]/h,i[e+1]=i[e+1]/h,i[e+2]=i[e+2]/h;}}}const q$2={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"},I$5=98,v$6="png",C$6={png:100,jpg:I$5,jpeg:I$5},P$5={top:0,right:0,bottom:0,left:0};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const l$j={widthBreakpoint:{getValue(e){const i=e.viewSize[0],s=e.breakpoints,t=this.values;return i<=s.xsmall?t.xsmall:i<=s.small?t.small:i<=s.medium?t.medium:i<=s.large?t.large:t.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue(e){const i=e.viewSize[1],s=e.breakpoints,t=this.values;return i<=s.xsmall?t.xsmall:i<=s.small?t.small:i<=s.medium?t.medium:i<=s.large?t.large:t.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue(e){const i=e.viewSize,s=i[0],t=i[1],r=this.values;return t>=s?r.portrait:r.landscape},values:{portrait:"portrait",landscape:"landscape"},valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},h$e={xsmall:544,small:768,medium:992,large:1200};function n$t(e){const i=e;return i&&i.xsmall<i.small&&i.small<i.medium&&i.medium<i.large}function o$e(e,i){return i?l$j[e].valueToClassName[i].split(" "):[]}const m$i=m=>{let g=class extends m{constructor(...e){super(...e),this._breakpointsHandles=new u$j,this.orientation=null,this.widthBreakpoint=null,this.heightBreakpoint=null,this.breakpoints=h$e;}initialize(){this._breakpointsHandles.add(d$f(this,["breakpoints","size"],this._updateClassNames));}destroy(){this.destroyed||(this._removeActiveClassNames(),this._breakpointsHandles.destroy(),this._breakpointsHandles=null);}set breakpoints(e){if(e===this._get("breakpoints"))return;const i=n$t(e);if(!i){const e=JSON.stringify(h$e,null,2);console.warn("provided breakpoints are not valid, using defaults:"+e);}e=i?e:h$e,this._set("breakpoints",{...e});}_updateClassNames(){if(!this.container)return;const e=o$h.acquire(),i=o$h.acquire();let s,r=!1;for(s in l$j){const t=this[s],a=l$j[s].getValue({viewSize:this.size,breakpoints:this.breakpoints});t!==a&&(r=!0,this[s]=a,o$e(s,t).forEach((e=>i.push(e))),o$e(s,a).forEach((i=>e.push(i))));}r&&(this._applyClassNameChanges(e,i),o$h.release(e),o$h.release(i));}_applyClassNameChanges(e,i){const s=this.container;s&&(i.forEach((e=>s.classList.remove(e))),e.forEach((e=>s.classList.add(e))));}_removeActiveClassNames(){const e=this.container;if(!e)return;let i;for(i in l$j)o$e(i,this[i]).forEach((i=>e.classList.remove(i)));}};return e$e([y$e()],g.prototype,"breakpoints",null),e$e([y$e()],g.prototype,"orientation",void 0),e$e([y$e()],g.prototype,"widthBreakpoint",void 0),e$e([y$e()],g.prototype,"heightBreakpoint",void 0),g=e$e([i$o("esri.views.BreakpointsOwner")],g),g};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
let c$o=class extends u$k{constructor(){super(...arguments),this.items=new L$5,this._watchUpdatingTracking=new l$l,this._callbacks=new Map,this._projector=i$p(),this._hiddenProjector=i$p();}get needsRender(){return this.items.length>0}initialize(){const t=document.createElement("div");t.className="esri-overlay-surface",this._set("surface",t),this._hiddenSurface=document.createElement("div"),this._hiddenSurface.setAttribute("style","visibility: hidden;"),t.appendChild(this._hiddenSurface),this._watchUpdatingTracking.addOnCollectionChange(this.items,(t=>{t.added.map((t=>{const e=()=>t.render();this._callbacks.set(t,e),this._projector.append(this.surface,e);})),t.removed.map((t=>{const e=this._projector.detach(this._callbacks.get(t));this.surface.removeChild(e.domNode),this._callbacks.delete(t);}));}));}addItem(t){this.items.add(t);}removeItem(t){this.items.remove(t);}destroy(){this.items.removeAll(),this._callbacks.forEach((t=>this._projector.detach(t))),this._callbacks=null,this._projector=null,this._watchUpdatingTracking.destroy();}render(){this._projector.renderNow();}computeBoundingRect(t){const e=this._hiddenSurface,r=this._hiddenProjector;let o=null;const s=()=>(o=t.render(),o);r.append(e,s),r.renderNow();const i={left:0,top:0,right:0,bottom:0};if(o&&o.domNode){const t=o.domNode.getBoundingClientRect();i.left=t.left,i.top=t.top,i.right=t.right,i.bottom=t.bottom;}for(r.detach(s);e.firstChild;)e.removeChild(e.firstChild);return i}overlaps(t,e){const r=this.computeBoundingRect(t),o=this.computeBoundingRect(e);return Math.max(r.left,o.left)<=Math.min(r.right,o.right)&&Math.max(r.top,o.top)<=Math.min(r.bottom,o.bottom)}get hasVisibleItems(){return this.items.some((t=>t.visible))}renderCanvas(t){if(!this.items.some((t=>t.visible)))return;const e=t.getContext("2d");e.save(),e.font=`10px ${getComputedStyle(this.surface).fontFamily}`,this.items.forEach((t=>{e.save(),t.renderCanvas(e),e.restore();})),e.restore();}};e$e([y$e({readOnly:!0})],c$o.prototype,"surface",void 0),e$e([y$e({readOnly:!0})],c$o.prototype,"items",void 0),e$e([y$e({readOnly:!0})],c$o.prototype,"needsRender",null),e$e([y$e({readOnly:!0})],c$o.prototype,"_watchUpdatingTracking",void 0),e$e([y$e({readOnly:!0,aliasOf:"_watchUpdatingTracking.updating"})],c$o.prototype,"updating",void 0),c$o=e$e([i$o("esri.views.overlay.ViewOverlay")],c$o);var n$s=c$o;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
function e$c(e,t,l,n){let o=null,u=1e3;"number"==typeof t?(u=t,n=l):(o=null!=t?t:null,u=l);let p,r=0;const a=()=>{r=0,e.apply(n,p);},c=(...e)=>{o&&o.apply(n,e),p=e,u?r||(r=setTimeout(a,u)):a();};return c.remove=()=>{r&&(clearTimeout(r),r=0);},c.forceUpdate=()=>{r&&(clearTimeout(r),a());},c.hasPendingUpdates=()=>!!r,c}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const i$l=i=>{let p=class extends i{constructor(){super(...arguments),this.renderNodeContent=e=>e$g(e)&&!e.destroyed?o$i("div",{key:e},e.render()):e instanceof HTMLElement?o$i("div",{key:e,bind:e,afterCreate:this._attachToNode}):r$d(e)?o$i("div",{key:e,bind:e.domNode,afterCreate:this._attachToNode}):null;}_attachToNode(e){const r=this;e.appendChild(r);}};return p=e$e([i$o("esri.widgets.Feature.ContentMixin")],p),p};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const $$3=["B","kB","MB","GB","TB"];function p$w(o,i){let e=0===i?0:Math.floor(Math.log(i)/Math.log(1024));e=e$f(e,0,$$3.length-1);const u=m$l(i/1024**e,{maximumFractionDigits:2});return r$e(o.units.bytes[$$3[e]],{fileSize:u})}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const s$l="esri.widgets.Feature.support.featureUtils",c$n=n$v.getLogger(s$l),d$d=/href=(""|'')/gi,p$v=/(\{([^\{\r\n]+)\})/g,m$h=/\'/g,y$c=/^\s*expression\//i,g$e=/(\n)/gi,h$d=/[\u00A0-\u9999<>\&]/gim,F$1=/href\s*=\s*(?:\"([^\"]+)\"|\'([^\']+)\')/gi,b$6=/^(?:mailto:|tel:)/,I$4="relationships/",w$3=S$7("short-date-short-time");function N$3(t){if(!t$f(t))return t.get("sourceLayer")||t.get("layer")}async function j$3(e,t){return "function"==typeof e?e.call(null,t):e}function v$5(e=""){if(e)return !b$6.test(e.trim().toLowerCase())}function C$5(e){return y$c.test(e)}function L$4(e,t){if(!C$5(t)||!e)return null;const r=t.replace(y$c,"").toLowerCase();let n;return e.some((e=>e.name.toLowerCase()===r&&(n=e,!0))),n}function q$1(e,t){const r=L$4(t,null==e?void 0:e.fieldName);return r?r.title||null:e?e.label||e.fieldName:null}function E$4(e,t){const r=t.get(e.toLowerCase());return `{${r&&r.fieldName||e}}`}function D$2(e){return e.replace(d$d,"")}function x$1(e,t){const r=M$3(t,e);return r?r.name:e}function A$3(e,t){return e&&e.map((e=>x$1(e,t)))}function M$3(e,t){return e&&"function"==typeof e.getField?e.getField(t):null}function $$2(e){return `${e}`.trim()}function R$3({attributes:e,globalAttributes:t,layer:r,text:n,fieldInfoMap:o}){return n?S$6({formattedAttributes:t,template:U$4(n,{...t,...e},r),fieldInfoMap:o}):""}function S$6({formattedAttributes:e,template:r,fieldInfoMap:n}){return $$2(D$2(r$e(r$e(r,(e=>E$4(e,n))),e)))}function T$3(e,t,r=!1){const n=t[e];if("string"==typeof n){const o="%27",i=(r?encodeURIComponent(n):n).replace(m$h,o);t[e]=i;}}function G$3(e,t=!1){const r={...e};return Object.keys(r).forEach((e=>T$3(e,r,t))),r}function O$4(e,r,n){const o=(r=$$2(r))&&"{"!==r[0];return r$e(e,G$3(n,o))}function k$4(e,t){return e.replace(p$v,((e,r,n)=>{const o=M$3(t,n);return o?`{${o.name}}`:r}))}function U$4(e,t,r){const n=k$4(e,r);return n?n.replace(F$1,((e,r,n)=>O$4(e,r||n,t))):n}function P$4(e,t){if("string"==typeof e&&t&&null==t.dateFormat&&(null!=t.places||null!=t.digitSeparator)){const t=Number(e);if(!isNaN(t))return t}return e}function Q$1(e,t){const r=t.fieldInfos,n=t.fieldName,o=z$2(r,n),i=null==o?void 0:o.clone(),a=t.preventPlacesFormatting,s=M$3(t.layer,n);if(i&&s&&"date"===s.type){const e=i.format||new n$w;e.dateFormat=e.dateFormat||"short-date-short-time",i.format=e;}const c=i&&i.format;return "string"==typeof(e=P$4(e,c))||null==e||null==c?e:a?m$l(e,{...u$l(c),minimumFractionDigits:0,maximumFractionDigits:20}):c.format(e)}function z$2(e,t){if(!e||!e.length||!t)return;const r=t.toLowerCase();let n;return e.some((e=>!(!e.fieldName||e.fieldName.toLowerCase()!==r)&&(n=e,!0))),n}function B$4({fieldName:e,graphic:t,layer:r}){if(te(e))return null;if(!r||"function"!=typeof r.getFeatureType)return null;const{typeIdField:n}=r;if(!n||e!==n)return null;const o=r.getFeatureType(t);return o?o.name:null}function H$2({fieldName:e,value:t,graphic:r,layer:n}){if(te(e))return null;if(!n||"function"!=typeof n.getFieldDomain)return null;const o=n.getFieldDomain(e,{feature:r});return o&&"coded-value"===o.type?o.getName(t):null}function J$1(e,t){const{creatorField:r,creationDateField:n,editorField:o,editDateField:a}=e;if(!t)return;const u=t[a];if("number"==typeof u){const e=t[o];return {type:"edit",date:L$6(u,w$3),user:e}}const l=t[n];if("number"==typeof l){const e=t[r];return {type:"create",date:L$6(l,w$3),user:e}}return null}function K$1(e,t){const r=new Map;return e&&e.forEach((e=>{const n=x$1(e.fieldName,t);e.fieldName=n,r.set(n.toLowerCase(),e);})),r}function V$2(e){const t=[];if(!e)return t;const{fieldInfos:r,content:n}=e;return r&&t.push(...r),n&&Array.isArray(n)?(n.forEach((e=>{if("fields"===e.type){const r=e&&e.fieldInfos;r&&t.push(...r);}})),t):t}function W$4(e){return e.replace(h$d,(e=>`&#${e.charCodeAt(0)};`))}function X$1(e){return "string"==typeof e?e.replace(g$e,'<br class="esri-text-new-line" />'):e}function Y$1(e){const{value:t,fieldName:r,fieldInfos:n,fieldInfoMap:o,layer:a,graphic:u}=e;if(null==t)return "";const l=H$2({fieldName:r,value:t,graphic:u,layer:a});if(l)return l;const f=B$4({fieldName:r,graphic:u,layer:a});if(f)return f;if(o.get(r.toLowerCase()))return Q$1(t,{fieldInfos:n,fieldName:r,layer:a});const s=a&&a.fieldsIndex;return s&&s.isDateField(r)?L$6(t,w$3):X$1(t)}function Z$1({fieldInfos:e,attributes:t,layer:r,graphic:n,fieldInfoMap:o,relatedInfos:i}){const a={...t};return null==i||i.forEach((e=>oe(a,e))),Object.keys(a).forEach((t=>{const i=a[t];a[t]=Y$1({fieldName:t,fieldInfos:e,fieldInfoMap:o,layer:r,value:i,graphic:n});})),a}async function _$6(e,t){const{layer:r,graphic:o,outFields:i,objectIds:a,returnGeometry:u,spatialReference:l}=e,f=a[0];if("number"!=typeof f&&"string"!=typeof f){const e="Could not query required fields for the specified feature. The feature's ID is invalid.",t={layer:r,graphic:o,objectId:f,requiredFields:i},a=new s$n("layer-query-features-invalid-objectid",e,t);throw c$n.warn(e,t),a}if("function"!=typeof r.queryFeatures){const e="The specified layer does not support the method 'queryFeatures'. The following fields will not be available.",t={layer:r,graphic:o,requiredFields:i},a=new s$n("layer-query-features-unsupported",e,t);throw c$n.warn(e,t),a}const s=r.createQuery();s.objectIds=a,s.outFields=i,s.returnGeometry=!!u,s.outSpatialReference=l;return (await r.queryFeatures(s,t)).features[0]}async function ee({graphic:e,popupTemplate:t,layer:r,spatialReference:n},i){if(!r||!t)return;const{returnGeometry:a}=t;"function"==typeof r.load&&await r.load(i);const u=e.attributes[r.objectIdField];if(null==u)return;const l=[u],f=await t.getRequiredFields(r.fields),s=ce(f,e),c=s?[]:f;if(s&&!a)return;const d=await _$6({layer:r,graphic:e,outFields:c,objectIds:l,returnGeometry:a,spatialReference:n},i);d&&(d.geometry&&(e.geometry=d.geometry),d.attributes&&(e.attributes={...e.attributes,...d.attributes}));}function te(e=""){return !!e&&-1!==e.indexOf(I$4)}function re(e){return e?`${I$4}${e.layerId}/${e.fieldName}`:""}function ne({attributes:e,graphic:t,relatedInfo:r}){e&&t&&r&&Object.keys(t.attributes).forEach((n=>{const o=re({layerId:r.relation.id.toString(),fieldName:n});e[o]=t.attributes[n];}));}function oe(e,t){e&&t&&(t.relatedFeatures&&t.relatedFeatures&&t.relatedFeatures.forEach((r=>ne({attributes:e,graphic:r,relatedInfo:t}))),t.relatedStatsFeatures&&t.relatedStatsFeatures&&t.relatedStatsFeatures.forEach((r=>ne({attributes:e,graphic:r,relatedInfo:t}))));}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const p$u={editing:!1,operations:{add:!0,update:!0,delete:!0}},u$h=L$5.ofType(d$g),y$b="graphic.layer.capabilities.operations.supportsResizeAttachments";let f$b=class extends d$h{constructor(t){super(t),this._getAttachmentsPromise=null,this._attachmentLayer=null,this.abilities={...p$u},this.activeAttachmentInfo=null,this.attachmentInfos=new u$h,this.graphic=null,this.mode="view",this.handles.add([d$f(this,"graphic",(()=>this._graphicChanged()))]);}destroy(){this._attachmentLayer=null,this.graphic=null;}castAbilities(t){return {...p$u,...t}}get state(){return this._getAttachmentsPromise?"loading":this.graphic?"ready":"disabled"}get supportsResizeAttachments(){return this.get(y$b)||!1}async getAttachments(){const{_attachmentLayer:t,attachmentInfos:e}=this;if(!t||"function"!=typeof t.queryAttachments)throw new s$n("invalid-layer","getAttachments(): A valid layer is required.");const a=this._getFeatureId(),i=new u$m({objectIds:[a],returnMetadata:!0}),r=[],s=t.queryAttachments(i).then((t=>t[a]||r)).catch((()=>r));this._getAttachmentsPromise=s,this.notifyChange("state");const o=await s;return e.removeAll(),o.length&&e.addMany(o),this._getAttachmentsPromise=null,this.notifyChange("state"),o}async addAttachment(t){const{_attachmentLayer:e,attachmentInfos:a,graphic:i,abilities:r}=this;if(!t)throw new s$n("invalid-attachment","addAttachment(): An attachment is required.",{attachment:t});if(!r.operations.add)throw new s$n("invalid-abilities","addAttachment(): add abilities are required.");if(!e||"function"!=typeof e.addAttachment)throw new s$n("invalid-layer","addAttachment(): A valid layer is required.");const s=e.addAttachment(i,t).then((t=>this._queryAttachment(t.objectId))),o=await s;return a.add(o),o}async deleteAttachment(t){const{_attachmentLayer:e,attachmentInfos:a,graphic:i,abilities:r}=this;if(!t)throw new s$n("invalid-attachment-info","deleteAttachment(): An attachmentInfo is required.",{attachmentInfo:t});if(!r.operations.delete)throw new s$n("invalid-abilities","deleteAttachment(): delete abilities are required.");if(!e||"function"!=typeof e.deleteAttachments)throw new s$n("invalid-layer","deleteAttachment(): A valid layer is required.");const s=e.deleteAttachments(i,[t.id]).then((()=>t)),o=await s;return a.remove(o),o}async updateAttachment(t,e=this.activeAttachmentInfo){const{_attachmentLayer:a,attachmentInfos:i,graphic:r,abilities:s}=this;if(!t)throw new s$n("invalid-attachment","updateAttachment(): An attachment is required.",{attachment:t});if(!e)throw new s$n("invalid-attachment-info","updateAttachment(): An attachmentInfo is required.",{attachmentInfo:e});if(!s.operations.update)throw new s$n("invalid-abilities","updateAttachment(): Update abilities are required.");const o=i.findIndex((t=>t===e));if(!a||"function"!=typeof a.updateAttachment)throw new s$n("invalid-layer","updateAttachment(): A valid layer is required.");const c=a.updateAttachment(r,e.id,t).then((t=>this._queryAttachment(t.objectId))),h=await c;return i.splice(o,1,h),h}async _queryAttachment(t){if(!t)throw new s$n("invalid-attachment-id","Could not query attachment.");const{_attachmentLayer:e}=this,a=this._getFeatureId(),i=new u$m({objectIds:[a],attachmentsWhere:`AttachmentId=${t}`,returnMetadata:!0});return e.queryAttachments(i).then((t=>t[a][0]))}_getFeatureId(){const{_attachmentLayer:t,graphic:e}=this;if(!t||!e)return null;const{objectIdField:a}=t,{attributes:i}=e;return i&&i[a]}_graphicChanged(){this.graphic&&(this._setAttachmentLayer(),this.getAttachments().catch((()=>{})));}_setAttachmentLayer(){const{graphic:t}=this,a=N$3(t);this._attachmentLayer=a?"scene"===a.type&&r$f(a.associatedLayer)?a.associatedLayer:a:null;}};e$e([y$e()],f$b.prototype,"abilities",void 0),e$e([c$r("abilities")],f$b.prototype,"castAbilities",null),e$e([y$e()],f$b.prototype,"activeAttachmentInfo",void 0),e$e([y$e({readOnly:!0,type:u$h})],f$b.prototype,"attachmentInfos",void 0),e$e([y$e({type:n$x})],f$b.prototype,"graphic",void 0),e$e([y$e()],f$b.prototype,"mode",void 0),e$e([y$e({readOnly:!0})],f$b.prototype,"state",null),e$e([y$e({readOnly:!0})],f$b.prototype,"supportsResizeAttachments",null),f$b=e$e([i$o("esri.widgets.Attachments.AttachmentsViewModel")],f$b);var A$2=f$b;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
function e$b(i){const e=i.toLowerCase();return "image/bmp"===e||"image/emf"===e||"image/exif"===e||"image/gif"===e||"image/x-icon"===e||"image/jpeg"===e||"image/png"===e||"image/tiff"===e||"image/x-wmf"===e}function p$t(e){const p=a$k("esri/themes/base/images/files/");return e?"text/plain"===e?`${p}text-32.svg`:"application/pdf"===e?`${p}pdf-32.svg`:"text/csv"===e?`${p}csv-32.svg`:"application/gpx+xml"===e?`${p}gpx-32.svg`:"application/x-dwf"===e?`${p}cad-32.svg`:"application/postscript"===e||"application/json"===e||"text/xml"===e||"model/vrml"===e?`${p}code-32.svg`:"application/x-zip-compressed"===e||"application/x-7z-compressed"===e||"application/x-gzip"===e||"application/x-tar"===e||"application/x-gtar"===e||"application/x-bzip2"===e||"application/gzip"===e||"application/x-compress"===e||"application/x-apple-diskimage"===e||"application/x-rar-compressed"===e||"application/zip"===e?`${p}zip-32.svg`:-1!==e.indexOf("image/")?`${p}image-32.svg`:-1!==e.indexOf("audio/")?`${p}sound-32.svg`:-1!==e.indexOf("video/")?`${p}video-32.svg`:-1!==e.indexOf("msexcel")||-1!==e.indexOf("ms-excel")||-1!==e.indexOf("spreadsheetml")?`${p}excel-32.svg`:-1!==e.indexOf("msword")||-1!==e.indexOf("ms-word")||-1!==e.indexOf("wordprocessingml")?`${p}word-32.svg`:-1!==e.indexOf("powerpoint")||-1!==e.indexOf("presentationml")?`${p}report-32.svg`:`${p}generic-32.svg`:`${p}generic-32.svg`}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const f$a={addButton:!0,addSubmitButton:!0,cancelAddButton:!0,cancelUpdateButton:!0,deleteButton:!0,errorMessage:!0,progressBar:!0,updateButton:!0},v$4={base:"esri-attachments",loaderContainer:"esri-attachments__loader-container",loader:"esri-attachments__loader",fadeIn:"esri-attachments--fade-in",container:"esri-attachments__container",containerList:"esri-attachments__container--list",containerPreview:"esri-attachments__container--preview",actions:"esri-attachments__actions",deleteButton:"esri-attachments__delete-button",addAttachmentButton:"esri-attachments__add-attachment-button",errorMessage:"esri-attachments__error-message",items:"esri-attachments__items",item:"esri-attachments__item",itemButton:"esri-attachments__item-button",itemMask:"esri-attachments__item-mask",itemMaskIcon:"esri-attachments__item-mask--icon",itemImage:"esri-attachments__image",itemImageResizable:"esri-attachments__image--resizable",itemLabel:"esri-attachments__label",itemFilename:"esri-attachments__filename",itemChevronIcon:"esri-attachments__item-chevron-icon",itemLink:"esri-attachments__item-link",itemLinkOverlay:"esri-attachments__item-link-overlay",itemLinkOverlayIcon:"esri-attachments__item-link-overlay-icon",itemEditIcon:"esri-attachments__item-edit-icon",itemAddIcon:"esri-attachments__item-add-icon",itemAddButton:"esri-attachments__item-add-button",formNode:"esri-attachments__form-node",fileFieldset:"esri-attachments__file-fieldset",fileLabel:"esri-attachments__file-label",fileName:"esri-attachments__file-name",fileInput:"esri-attachments__file-input",metadata:"esri-attachments__metadata",metadataFieldset:"esri-attachments__metadata-fieldset",progressBar:"esri-attachments__progress-bar",esriWidget:"esri-widget",esriButton:"esri-button",buttonDisabled:"esri-button--disabled",esriButtonSecondary:"esri-button--secondary",esriButtonTertiary:"esri-button--tertiary",esriButtonThird:"esri-button--third",esriButtonSmall:"esri-button--small",esriButtonHalf:"esri-button--half",empty:"esri-widget__content--empty",iconExternalLink:"esri-icon-link-external",iconEdit:"esri-icon-edit",iconRight:"esri-icon-right",iconLeft:"esri-icon-left",iconPlus:"esri-icon-plus"},y$a=window.CSS;let B$3=class extends L$7{constructor(t,e){super(t,e),this.abilities=null,this.displayType="list",this.graphic=null,this.label=void 0,this.messages=null,this.messagesUnits=null,this.selectedFile=null,this.submitting=!1,this.viewModel=new A$2,this.visibleElements={...f$a},this._supportsImageOrientation=y$a&&y$a.supports&&y$a.supports("image-orientation","from-image"),this._addAttachmentForm=null,this._updateAttachmentForm=null;}initialize(){this.own(C$7(this,"viewModel.attachmentInfos","change",(()=>this.scheduleRender())),d$f(this,"viewModel.mode",(()=>this._modeChanged())));}castVisibleElements(t){return {...f$a,...t}}addAttachment(){const{_addAttachmentForm:t,viewModel:e}=this;return this._set("submitting",!0),this._set("error",null),e.addAttachment(t).then((t=>(this._set("submitting",!1),this._set("error",null),e.mode="view",t))).catch((t=>{throw this._set("submitting",!1),this._set("error",new s$n("attachments:add-attachment",this.messages.addErrorMessage,t)),t}))}deleteAttachment(t){const{viewModel:e}=this;return this._set("submitting",!0),this._set("error",null),e.deleteAttachment(t).then((t=>(this._set("submitting",!1),this._set("error",null),e.mode="view",t))).catch((t=>{throw this._set("submitting",!1),this._set("error",new s$n("attachments:delete-attachment",this.messages.deleteErrorMessage,t)),t}))}updateAttachment(){const{viewModel:t}=this,{_updateAttachmentForm:e}=this;return this._set("submitting",!0),this._set("error",null),t.updateAttachment(e).then((e=>(this._set("submitting",!1),this._set("error",null),t.mode="view",e))).catch((t=>{throw this._set("submitting",!1),this._set("error",new s$n("attachments:update-attachment",this.messages.updateErrorMessage,t)),t}))}render(){const{submitting:t,viewModel:e}=this,{state:s}=e;return o$i("div",{class:this.classes(v$4.base,v$4.esriWidget)},t?this.renderProgressBar():null,"loading"===s?this.renderLoading():this.renderAttachments(),this.renderErrorMessage())}renderErrorMessage(){const{error:t,visibleElements:e}=this;return t&&e.errorMessage?o$i("div",{key:"error-message",class:v$4.errorMessage},t.message):null}renderAttachments(){const{mode:t,activeAttachmentInfo:e}=this.viewModel;return "add"===t?this.renderAddForm():"edit"===t?this.renderDetailsForm(e):this.renderAttachmentContainer()}renderLoading(){return o$i("div",{class:v$4.loaderContainer,key:"loader"},o$i("div",{class:v$4.loader}))}renderProgressBar(){return this.visibleElements.progressBar?o$i("div",{class:v$4.progressBar,key:"progress-bar"}):null}renderAddForm(){const{submitting:t,selectedFile:e}=this,s=t||!e,i=this.visibleElements.cancelAddButton?o$i("button",{type:"button",bind:this,disabled:t,onclick:this._cancelForm,class:this.classes(v$4.esriButton,v$4.esriButtonTertiary,v$4.esriButtonSmall,v$4.esriButtonHalf,t&&v$4.buttonDisabled)},this.messages.cancel):null,a=this.visibleElements.addSubmitButton?o$i("button",{type:"submit",disabled:s,class:this.classes(v$4.esriButton,v$4.esriButtonSecondary,v$4.esriButtonSmall,v$4.esriButtonHalf,{[v$4.buttonDisabled]:s})},this.messages.add):null,n=e?o$i("span",{key:"file-name",class:v$4.fileName},e.name):null,r=o$i("form",{bind:this,afterCreate:p$y,afterRemoved:u$n,"data-node-ref":"_addAttachmentForm",onsubmit:this._submitAddAttachment},o$i("fieldset",{class:v$4.fileFieldset},n,o$i("label",{class:this.classes(v$4.fileLabel,v$4.esriButton,v$4.esriButtonSecondary)},e?this.messages.changeFile:this.messages.selectFile,o$i("input",{class:v$4.fileInput,type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))),a,i);return o$i("div",{key:"add-form-container",class:v$4.formNode},r)}renderDetailsForm(t){const{visibleElements:e,viewModel:s,selectedFile:i,submitting:a}=this,{contentType:n,size:r,url:o}=t,{abilities:c}=s,h=a||!i,p=c.editing&&c.operations.delete&&e.deleteButton?o$i("button",{key:"delete-button",type:"button",disabled:a,bind:this,onclick:e=>this._submitDeleteAttachment(e,t),class:this.classes(v$4.esriButton,v$4.esriButtonSmall,v$4.esriButtonTertiary,v$4.deleteButton,{[v$4.buttonDisabled]:a})},this.messages.delete):null,b=c.editing&&c.operations.update&&e.updateButton?o$i("button",{disabled:h,key:"update-button",type:"submit",class:this.classes(v$4.esriButton,v$4.esriButtonSmall,v$4.esriButtonThird,{[v$4.buttonDisabled]:h})},this.messages.update):null,_=this.visibleElements.cancelUpdateButton?o$i("button",{disabled:a,key:"cancel-button",type:"button",bind:this,onclick:this._cancelForm,class:this.classes(v$4.esriButton,v$4.esriButtonSmall,v$4.esriButtonTertiary,v$4.esriButtonThird,{[v$4.buttonDisabled]:a})},this.messages.cancel):null,g=i?o$i("span",{key:"file-name",class:v$4.fileName},i.name):null,f=c.editing&&c.operations.update?o$i("fieldset",{key:"file",class:v$4.fileFieldset},g,o$i("label",{class:this.classes(v$4.fileLabel,v$4.esriButton,v$4.esriButtonSecondary)},this.messages.changeFile,o$i("input",{class:v$4.fileInput,type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))):null,y=o$i("fieldset",{key:"size",class:v$4.metadataFieldset},o$i("label",null,p$w(this.messagesUnits,r))),B=o$i("fieldset",{key:"content-type",class:v$4.metadataFieldset},o$i("label",null,n)),A=o$i("form",{bind:this,afterCreate:p$y,afterRemoved:u$n,"data-node-ref":"_updateAttachmentForm",onsubmit:this._submitUpdateAttachment},o$i("div",{class:v$4.metadata},y,B),f,o$i("div",{class:v$4.actions},p,_,b));return o$i("div",{key:"edit-form-container",class:v$4.formNode},o$i("a",{class:v$4.itemLink,href:o,rel:"noreferrer",target:"_blank"},this.renderImageMask({attachmentInfo:t,size:400}),o$i("div",{class:v$4.itemLinkOverlay},o$i("span",{class:v$4.itemLinkOverlayIcon},o$i("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 32 32"},o$i("path",{d:"M28 13h1v16H3V3h16v1H4v24h24zm-5-9h4.293L15.646 15.638l.707.707L28 4.707V9h1V3h-6z"}),o$i("path",{fill:"none",d:"M0 0h32v32H0z"}))))),A)}renderImageMask({attachmentInfo:t,size:e}){const{supportsResizeAttachments:s}=this.viewModel,{contentType:i,name:a,url:n}=t,r=s&&e$b(i),o=this._getCSSTransform(t,r),l=o?{transform:o,"image-orientation":"none"}:{},m=-1===n.indexOf("?")?"?":"&",d=r?`${n}${m}w=${e}`:p$t(i),c={[v$4.itemMaskIcon]:!r},h={[v$4.itemImageResizable]:s};return o$i("div",{class:this.classes(c,v$4.itemMask)},o$i("img",{styles:l,alt:a,src:d,class:this.classes(h,v$4.itemImage)}))}renderAttachmentInfo({attachmentInfo:t,displayType:e}){const{viewModel:s}=this,{abilities:i}=s,{name:a,url:n}=t,r=this.renderImageMask({attachmentInfo:t,size:"list"===e?48:400}),o=i.editing?o$i("span",{"aria-hidden":"true",class:this.classes(v$4.itemChevronIcon,d$i()?v$4.iconLeft:v$4.iconRight)}):null,l=[r,o$i("label",{class:v$4.itemLabel},o$i("span",{class:v$4.itemFilename},a||this.messages.noTitle),o)],m=i.editing?o$i("button",{key:"details-button",bind:this,class:v$4.itemButton,title:this.messages.attachmentDetails,"aria-label":this.messages.attachmentDetails,"data-attachment-info-id":t.id,onclick:()=>this._startEditAttachment(t),type:"button"},l):o$i("a",{key:"details-link",class:v$4.itemButton,href:n,target:"_blank"},l);return o$i("li",{class:v$4.item,key:t},m)}renderAttachmentContainer(){const{displayType:t,viewModel:e,visibleElements:s}=this,{attachmentInfos:i,abilities:a}=e,n=i&&i.length,r={[v$4.containerList]:"preview"!==t,[v$4.containerPreview]:"preview"===t},o=a.editing&&a.operations.add&&s.addButton?o$i("button",{bind:this,onclick:()=>this._startAddAttachment(),class:this.classes(v$4.esriButton,v$4.esriButtonTertiary,v$4.addAttachmentButton),type:"button"},o$i("span",{"aria-hidden":"true",class:this.classes(v$4.itemAddIcon,v$4.iconPlus)}),this.messages.add):null,l=n?o$i("ul",{class:v$4.items},i.toArray().map((e=>this.renderAttachmentInfo({attachmentInfo:e,displayType:t})))):o$i("div",{class:v$4.empty},this.messages.noAttachments);return o$i("div",{key:"attachments-container",class:this.classes(v$4.container,r)},l,o)}_modeChanged(){this._set("error",null),this._set("selectedFile",null);}_handleFileInputChange(t){const e=t.target,s=e&&e.files&&e.files.item(0);this._set("selectedFile",s);}_submitDeleteAttachment(t,e){t.preventDefault(),this.deleteAttachment(e);}_submitAddAttachment(t){t.preventDefault(),this.addAttachment();}_submitUpdateAttachment(t){t.preventDefault(),this.updateAttachment();}_startEditAttachment(t){const{viewModel:e}=this;e.activeAttachmentInfo=t,e.mode="edit";}_startAddAttachment(){this.viewModel.mode="add";}_cancelForm(t){t.preventDefault(),this.viewModel.mode="view";}_getCSSTransform(t,e){const{orientationInfo:s}=t;return !this._supportsImageOrientation&&e&&s?[s.rotation?`rotate(${s.rotation}deg)`:"",s.mirrored?"scaleX(-1)":""].join(" "):""}};e$e([o$j("viewModel.abilities")],B$3.prototype,"abilities",void 0),e$e([y$e()],B$3.prototype,"displayType",void 0),e$e([o$j("viewModel.graphic")],B$3.prototype,"graphic",void 0),e$e([y$e({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],B$3.prototype,"label",void 0),e$e([y$e(),e$h("esri/widgets/Attachments/t9n/Attachments")],B$3.prototype,"messages",void 0),e$e([y$e(),e$h("esri/core/t9n/Units")],B$3.prototype,"messagesUnits",void 0),e$e([y$e({readOnly:!0})],B$3.prototype,"selectedFile",void 0),e$e([y$e({readOnly:!0})],B$3.prototype,"submitting",void 0),e$e([y$e({readOnly:!0})],B$3.prototype,"error",void 0),e$e([y$e({type:A$2})],B$3.prototype,"viewModel",void 0),e$e([y$e()],B$3.prototype,"visibleElements",void 0),e$e([c$r("visibleElements")],B$3.prototype,"castVisibleElements",null),B$3=e$e([i$o("esri.widgets.Attachments")],B$3);var A$1=B$3;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
let s$k=class extends A$2{constructor(t){super(t),this.description=null,this.title=null;}};e$e([y$e()],s$k.prototype,"description",void 0),e$e([y$e()],s$k.prototype,"title",void 0),s$k=e$e([i$o("esri.widgets.Feature.FeatureAttachments.FeatureAttachmentsViewModel")],s$k);var p$s=s$k;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const i$k={base:"esri-feature-element-info",title:"esri-feature-element-info__title",description:"esri-feature-element-info__description"};let p$r=class extends L$7{constructor(e,r){super(e,r),this.description=null,this.title=null;}render(){return o$i("div",{class:i$k.base},this.renderTitle(),this.renderDescription())}renderTitle(){const{title:e}=this;return e?o$i("h2",{key:"title",class:i$k.title},e):null}renderDescription(){const{description:e}=this;return e?o$i("div",{key:"description",class:i$k.description},e):null}};e$e([y$e()],p$r.prototype,"description",void 0),e$e([y$e()],p$r.prototype,"title",void 0),p$r=e$e([i$o("esri.widgets.Feature.support.FeatureElementInfo")],p$r);var n$r=p$r;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const l$i={base:"esri-feature-attachments"};let d$c=class extends L$7{constructor(t,e){super(t,e),this._featureElementInfo=null,this.attachmentsWidget=new A$1,this.description=null,this.displayType=null,this.graphic=null,this.title=null,this.viewModel=new p$s;}initialize(){this._featureElementInfo=new n$r,d$f(this,["viewModel.description","viewModel.title"],(()=>this._setupFeatureElementInfo())),d$f(this,"viewModel.graphic",(t=>this.attachmentsWidget.graphic=t));}destroy(){this.attachmentsWidget.destroy(),this._featureElementInfo.destroy();}render(){var t;const{attachmentsWidget:e}=this;return o$i("div",{class:l$i.base},null==(t=this._featureElementInfo)?void 0:t.render(),null==e?void 0:e.render())}_setupFeatureElementInfo(){const{description:t,title:e}=this;this._featureElementInfo.set({description:t,title:e});}};e$e([y$e({readOnly:!0})],d$c.prototype,"attachmentsWidget",void 0),e$e([o$j("viewModel.description")],d$c.prototype,"description",void 0),e$e([o$j("attachmentsWidget.displayType")],d$c.prototype,"displayType",void 0),e$e([o$j("viewModel.graphic")],d$c.prototype,"graphic",void 0),e$e([o$j("viewModel.title")],d$c.prototype,"title",void 0),e$e([y$e({type:p$s})],d$c.prototype,"viewModel",void 0),d$c=e$e([i$o("esri.widgets.Feature.FeatureAttachments")],d$c);var m$g=d$c;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
let n$q=class extends(a$l(u$k)){constructor(t){super(t),this._loadingPromise=null,this.created=null,this.creator=null,this.destroyer=null,this.graphic=null,this.handles.add(d$f(this,"creator",(t=>{this._destroyContent(),this._createContent(t);})));}destroy(){this._destroyContent();}get state(){return this._loadingPromise?"loading":"ready"}_destroyContent(){const{created:t,graphic:r,destroyer:e}=this;t&&(j$3(e,{graphic:r}).catch((()=>null)),this._set("created",null));}async _createContent(t){const{graphic:r}=this,e=j$3(t,{graphic:r}).catch((()=>null));this._loadingPromise=e,this.notifyChange("state");const o=await e;e===this._loadingPromise&&(this._loadingPromise=null,this.notifyChange("state"),this._set("created",o));}};e$e([y$e({readOnly:!0})],n$q.prototype,"created",void 0),e$e([y$e()],n$q.prototype,"creator",void 0),e$e([y$e()],n$q.prototype,"destroyer",void 0),e$e([y$e({type:n$x})],n$q.prototype,"graphic",void 0),e$e([y$e({readOnly:!0})],n$q.prototype,"state",null),n$q=e$e([i$o("esri.widgets.Feature.FeatureContent.FeatureContentViewModel")],n$q);var p$q=n$q;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const c$m={base:"esri-feature-content",loaderContainer:"esri-feature-content__loader-container",loader:"esri-feature-content__loader"};let p$p=class extends L$7{constructor(e,r){super(e,r),this.creator=null,this.graphic=null,this.viewModel=null,this._addTargetToAnchors=e=>{Array.from(e.querySelectorAll("a")).forEach((e=>{v$5(e.href)&&!e.hasAttribute("target")&&e.setAttribute("target","_blank");}));};}renderLoading(){return o$i("div",{class:c$m.loaderContainer,key:"loader"},o$i("div",{class:c$m.loader}))}renderCreated(){var e;const r=null==(e=this.viewModel)?void 0:e.created;return r?r instanceof HTMLElement?o$i("div",{key:r,bind:r,afterCreate:this._attachToNode}):e$g(r)?o$i("div",{key:r},!r.destroyed&&r.render()):o$i("div",{key:r,innerHTML:r,afterCreate:this._addTargetToAnchors}):null}render(){var e;const r=null==(e=this.viewModel)?void 0:e.state;return o$i("div",{class:c$m.base},"loading"===r?this.renderLoading():this.renderCreated())}_attachToNode(e){const r=this;e.appendChild(r);}};e$e([o$j("viewModel.creator")],p$p.prototype,"creator",void 0),e$e([o$j("viewModel.graphic")],p$p.prototype,"graphic",void 0),e$e([y$e({type:p$q})],p$p.prototype,"viewModel",void 0),p$p=e$e([i$o("esri.widgets.Feature.FeatureContent")],p$p);var l$h=p$p;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
let l$g=class extends u$k{constructor(o){super(o),this.attributes=null,this.expressionInfos=null,this.description=null,this.fieldInfos=null,this.title=null;}get formattedFieldInfos(){const{expressionInfos:o,fieldInfos:r}=this,e=[];return null==r||r.forEach((r=>{if(!(!r.hasOwnProperty("visible")||r.visible))return;const s=r.clone();s.label=q$1(s,o),e.push(s);})),e}};e$e([y$e()],l$g.prototype,"attributes",void 0),e$e([y$e({type:[i$q]})],l$g.prototype,"expressionInfos",void 0),e$e([y$e()],l$g.prototype,"description",void 0),e$e([y$e({type:[c$s]})],l$g.prototype,"fieldInfos",void 0),e$e([y$e({readOnly:!0})],l$g.prototype,"formattedFieldInfos",null),e$e([y$e()],l$g.prototype,"title",void 0),l$g=e$e([i$o("esri.widgets.Feature.FeatureFields.FeatureFieldsViewModel")],l$g);var n$p=l$g;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const s$j=[{pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,target:"_blank",label:"{messages.view}"},{pattern:/^\s*(tel:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(mailto:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"App Studio Player"},{pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Collector"},{pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Explorer"},{pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Navigator"},{pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Survey123"},{pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Trek2There"},{pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Workforce"},{pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"iForm"},{pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"FlowFinity"},{pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Laserfische"},{pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Microsoft Power Bi"}];function a$h(e){let a=null;return s$j.some((s=>(s.pattern.test(e)&&(a=s),!!a))),a}function p$o(s,p){if("string"!=typeof p||!p)return p;const r=a$h(p);if(!r)return p;const t=p.match(r.pattern),n=t&&t[2],l=r$e(r$e(r.label,{messages:s,hierPart:n}),{appName:r.appName}),i=r.target?` target="${r.target}"`:"",o="_blank"===r.target?' rel="noreferrer"':"";return p.replace(r.pattern,`<a${i} href="$1"${o}>${l}</a>`)}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const f$9={base:"esri-feature-fields",fieldHeader:"esri-feature-fields__field-header",fieldData:"esri-feature-fields__field-data",fieldDataDate:"esri-feature-fields__field-data--date",esriTable:"esri-widget__table"};let u$g=class extends L$7{constructor(e,t){super(e,t),this._featureElementInfo=null,this.attributes=null,this.description=null,this.expressionInfos=null,this.fieldInfos=null,this.title=null,this.viewModel=new n$p,this.messages=null,this.messagesURIUtils=null;}initialize(){this._featureElementInfo=new n$r,d$f(this,["viewModel.description","viewModel.title"],(()=>this._setupFeatureElementInfo()));}destroy(){this._featureElementInfo.destroy();}renderFieldInfo(e,t){const{attributes:s}=this.viewModel,r=e.fieldName,i=e.label||r,o=s?null==s[r]?"":s[r]:"",a=!(!e.format||!e.format.dateFormat),d="number"==typeof o&&!a?this._forceLTR(o):p$o(this.messagesURIUtils,o),n={[f$9.fieldDataDate]:a};return o$i("tr",{key:`fields-element-info-row-${r}-${t}`},o$i("th",{key:`fields-element-info-row-header-${r}-${t}`,class:f$9.fieldHeader,innerHTML:i}),o$i("td",{key:`fields-element-info-row-data-${r}-${t}`,class:this.classes(f$9.fieldData,n),innerHTML:d}))}renderFields(){const{formattedFieldInfos:e}=this.viewModel;return e.length?o$i("table",{class:f$9.esriTable,summary:this.messages.fieldsSummary},o$i("tbody",null,e.map(((e,t)=>this.renderFieldInfo(e,t))))):null}render(){var e;return o$i("div",{class:f$9.base},null==(e=this._featureElementInfo)?void 0:e.render(),this.renderFields())}_setupFeatureElementInfo(){const{description:e,title:t}=this;this._featureElementInfo.set({description:e,title:t});}_forceLTR(e){return `&lrm;${e}`}};e$e([o$j("viewModel.attributes")],u$g.prototype,"attributes",void 0),e$e([o$j("viewModel.description")],u$g.prototype,"description",void 0),e$e([o$j("viewModel.expressionInfos")],u$g.prototype,"expressionInfos",void 0),e$e([o$j("viewModel.fieldInfos")],u$g.prototype,"fieldInfos",void 0),e$e([o$j("viewModel.title")],u$g.prototype,"title",void 0),e$e([y$e({type:n$p})],u$g.prototype,"viewModel",void 0),e$e([y$e(),e$h("esri/widgets/Feature/t9n/Feature")],u$g.prototype,"messages",void 0),e$e([y$e(),e$h("esri/widgets/support/t9n/uriUtils")],u$g.prototype,"messagesURIUtils",void 0),u$g=e$e([i$o("esri.widgets.Feature.FeatureFields")],u$g);var m$f=u$g;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const d$b="esri.widgets.Feature.support.relatedFeatureUtils",f$8=n$v.getLogger(d$b),p$n=new Map;function m$e(e){if(!te(e))return null;const[t,r]=e.split("/").slice(1);return {layerId:t,fieldName:r}}function y$9(e,t){if(!t.relationships)return null;let r=null;const{relationships:s}=t;return s.some((t=>t.id===parseInt(e,10)&&(r=t,!0))),r}function F({originRelationship:e,relationships:t,layerId:r}){let s;return t&&t.some((t=>(`${t.relatedTableId}`===r&&t.id===e.id&&(s=t),!!s))),s}function h$c(e,t){const r=t.toLowerCase();for(const s in e)if(s.toLowerCase()===r)return e[s];return null}function I$3(e,t){const r=y$9(e,t);if(!r)return;const s=`${t.url}/${r.relatedTableId}`;return {url:s,queryTask:new x$3({url:s,sourceSpatialReference:t.spatialReference}),relation:r,relatedFields:[],outStatistics:[]}}function w$2(e,t){if(!t)return;if(!e)return;const{features:r,statsFeatures:s}=e,i=r&&r.value;t.relatedFeatures=i?i.features:[];const o=s&&s.value;t.relatedStatsFeatures=o?o.features:[];}function b$5(e,t,r,s){const i=new l$m;return i.outFields=["*"],i.relationshipId="number"==typeof t.id?t.id:parseInt(t.id,10),i.objectIds=[e.attributes[r.objectIdField]],r.queryRelatedFeatures(i,s)}function j$2(e,t,r){let s=0;const i=[];for(;s<t.length;)i.push(`${e} IN (${t.slice(s,r+s)})`),s+=r;return i.join(" OR ")}async function g$d(e,t,o,n){const l=o.layerId.toString(),{layerInfo:u,queryTask:c,relation:d,relatedFields:f,outStatistics:p}=t,m=F({originRelationship:d,relationships:u.relationships,layerId:l});if(m.relationshipTableId&&m.keyFieldInRelationshipTable){const t=(await b$5(e,m,o,n))[e.attributes[o.objectIdField]];if(!t)return null;const s=t.features.map((e=>e.attributes[u.objectIdField]));if((null==p?void 0:p.length)>0&&u.supportsStatistics){const e=new R$4;e.where=j$2(u.objectIdField,s,1e3),e.outFields=f,e.outStatistics=p;const i={features:Promise.resolve(t),statsFeatures:c.execute(e)};return E$5(i)}}const y=null==m?void 0:m.keyField;if(y){const o=X$2(T$4(u.fields,y)),l=h$c(e.attributes,d.keyField),f=o?`${y}=${l}`:`${y}='${l}'`,p=c.execute(new R$4({where:f,outFields:t.relatedFields}),n),m=t.outStatistics&&t.outStatistics.length>0&&u.supportsStatistics?c.execute(new R$4({where:f,outFields:t.relatedFields,outStatistics:t.outStatistics}),n):null,F={features:p};return m&&(F.statsFeatures=m),E$5(F)}return null}function S$5(e,t){return U$5(e,{query:{f:"json"},signal:t&&t.signal})}function T$2({relatedInfos:e,layer:s},i){const o={};return e.forEach(((e,r)=>{const{relation:n}=e;if(!n){const e=new s$n("relation-required","A relation is required on a layer to retrieve related records.");throw f$8.error(e),e}const{relatedTableId:a}=n;if("number"!=typeof a){const e=new s$n("A related table ID is required on a layer to retrieve related records.");throw f$8.error(e),e}const l=`${s.url}/${a}`,u=p$n.get(l),c=u||S$5(l,i);u||p$n.set(l,c),o[r]=c;})),E$5(o)}function $$1({graphic:e,relatedInfos:t,layer:s},i){const o={};return t.forEach(((t,r)=>{t.layerInfo&&(o[r]=g$d(e,t,s,i));})),E$5(o)}function k$3({relatedInfo:e,fieldName:t,fieldInfo:r}){if(e.relatedFields.push(t),r.statisticType){const s=new m$m({statisticType:r.statisticType,onStatisticField:t,outStatisticFieldName:t});e.outStatistics.push(s);}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
let y$8=class extends u$k{constructor(t){super(t),this.activeMediaInfoIndex=0,this.attributes=null,this.description=null,this.fieldInfoMap=null,this.formattedAttributes=null,this.layer=null,this.mediaInfos=null,this.popupTemplate=null,this.relatedInfos=null,this.title=null;}get activeMediaInfo(){return this.formattedMediaInfos[this.activeMediaInfoIndex]||null}get formattedMediaInfos(){return this._formatMediaInfos()||[]}get formattedMediaInfoCount(){return this.formattedMediaInfos.length}setActiveMedia(t){this._setContentElementMedia(t);}next(){this._pageContentElementMedia(1);}previous(){this._pageContentElementMedia(-1);}_setContentElementMedia(t){const{formattedMediaInfoCount:e}=this,o=(t+e)%e;this.activeMediaInfoIndex=o;}_pageContentElementMedia(t){const{activeMediaInfoIndex:e}=this,o=e+t;this._setContentElementMedia(o);}_formatMediaInfos(){const{attributes:t,mediaInfos:e,formattedAttributes:o,fieldInfoMap:r,layer:i}=this;return null==e?void 0:e.map((e=>{if(!e)return null;if(e.title=R$3({attributes:t,fieldInfoMap:r,globalAttributes:o,layer:i,text:e.title}),e.caption=R$3({attributes:t,fieldInfoMap:r,globalAttributes:o,layer:i,text:e.caption}),e.altText=R$3({attributes:t,fieldInfoMap:r,globalAttributes:o,layer:i,text:e.altText}),"image"===e.type){const{value:t}=e;return this._setImageValue({value:t,formattedAttributes:o,layer:i}),e.value.sourceURL?e:void 0}if("pie-chart"===e.type||"line-chart"===e.type||"column-chart"===e.type||"bar-chart"===e.type){const{value:r}=e;return this._setChartValue({value:r,chartType:e.type,attributes:t,formattedAttributes:o,layer:i}),e}return null})).filter(Boolean)}_setImageValue(t){const{fieldInfoMap:e}=this,{value:o,formattedAttributes:r,layer:i}=t,{linkURL:a,sourceURL:l}=o;if(l){const t=k$4(l,i);o.sourceURL=S$6({formattedAttributes:r,template:t,fieldInfoMap:e});}if(a){const t=k$4(a,i);o.linkURL=S$6({formattedAttributes:r,template:t,fieldInfoMap:e});}}_setChartValue(t){const{value:e,attributes:o,formattedAttributes:r,chartType:i,layer:a}=t,{popupTemplate:l,relatedInfos:s}=this,{fields:n,normalizeField:f}=e;e.fields=A$3(n,a),f&&(e.normalizeField=x$1(f,a));if(!n.some((t=>!!(null!=r[t]||te(t)&&s.size))))return;const m=null==l?void 0:l.fieldInfos;n.forEach((t=>{if(te(t))return void(e.series=[...e.series,...this._getRelatedChartInfos({fieldInfos:m,fieldName:t,formattedAttributes:r,chartType:i,value:e})]);const a=this._getChartOption({value:e,attributes:o,chartType:i,formattedAttributes:r,fieldName:t,fieldInfos:m});e.series.push(a);}));}_getRelatedChartInfos(t){var e;const{fieldInfos:o,fieldName:r,formattedAttributes:i,chartType:a,value:l}=t,s=[],n=m$e(r),{layerId:d,fieldName:p}=n,u=null==(e=this.relatedInfos)?void 0:e.get(d.toString());if(!u)return s;const{relatedFeatures:f,relation:m}=u;if(!m||!f)return s;const{cardinality:c}=m;f.forEach((t=>{const{attributes:e}=t;e&&Object.keys(e).forEach((t=>{t===p&&s.push(this._getChartOption({value:l,attributes:e,formattedAttributes:i,fieldName:r,chartType:a,relatedFieldName:t,fieldInfos:o}));}));}));return "one-to-many"===c||"many-to-many"===c?s:[s[0]]}_getTooltip({label:t,value:e,chartType:o}){return "pie-chart"===o?t:`${t}: ${e}`}_getChartOption(t){var e;const{value:o,attributes:r,formattedAttributes:l,fieldName:s,relatedFieldName:n,fieldInfos:d,chartType:y}=t,{layer:I}=this,{normalizeField:v,tooltipField:b}=o,M=v?te(v)?r[m$e(v).fieldName]:r[v]:null,g=n&&void 0!==r[n]?r[n]:void 0!==r[s]?r[s]:l[s],_=void 0===g?null:g&&M?g/M:g,T=new c$t({value:_});if(te(s)){const t=m$e(s),e=m$e(b),o=e?e.fieldName:null,i=Q$1(_,{fieldInfos:d,fieldName:n,layer:I,preventPlacesFormatting:!!M}),a=t?t.label||t.fieldName:n,l=o&&void 0!==r[o]?r[o]:a;return T.tooltip=this._getTooltip({label:l,value:i,chartType:y}),T}const A=z$2(d,s),C=x$1(s,I),j=b&&void 0!==l[b]?l[b]:q$1(A||new c$s({fieldName:C}),null==(e=this.popupTemplate)?void 0:e.expressionInfos),x=l[C];return T.tooltip=this._getTooltip({label:j,value:x,chartType:y}),T}};e$e([y$e()],y$8.prototype,"activeMediaInfoIndex",void 0),e$e([y$e({readOnly:!0})],y$8.prototype,"activeMediaInfo",null),e$e([y$e()],y$8.prototype,"attributes",void 0),e$e([y$e()],y$8.prototype,"description",void 0),e$e([y$e()],y$8.prototype,"fieldInfoMap",void 0),e$e([y$e()],y$8.prototype,"formattedAttributes",void 0),e$e([y$e({readOnly:!0})],y$8.prototype,"formattedMediaInfos",null),e$e([y$e()],y$8.prototype,"layer",void 0),e$e([y$e({readOnly:!0})],y$8.prototype,"formattedMediaInfoCount",null),e$e([y$e()],y$8.prototype,"mediaInfos",void 0),e$e([y$e()],y$8.prototype,"popupTemplate",void 0),e$e([y$e()],y$8.prototype,"relatedInfos",void 0),e$e([y$e()],y$8.prototype,"title",void 0),y$8=e$e([i$o("esri.widgets.Feature.FeatureMedia.FeatureMediaViewModel")],y$8);var I$2=y$8;

var f$7=["#ffffff","#858585","#ffbebe","#ffebbe","#ffebaf","#ffffbe","#e9ffbe","#d3ffbe","#beffe8","#bee8ff","#bed2ff","#e8beff","#ffbee8","#ebebeb","#707070","#ff7f7f","#ffa77f","#ffd37f","#ffff73","#d1ff73","#a3ff73","#73ffdf","#73dfff","#73b2ff","#df73ff","#ff73df","#d6d6d6","#5c5c5c","#ff0000","#ff5500","#ffaa00","#ffff00","#aaff00","#55ff00","#00ffc5","#00c5ff","#0070ff","#c500ff","#ff00c5","#c2c2c2","#474747","#e60000","#e64c00","#e69800","#e6e600","#98e600","#4ce600","#00e6a9","#00a9e6","#005ce6","#a900e6","#e600a9","#adadad","#242424","#a80000","#a83800","#a87000","#a8a800","#70a800","#38a800","#00a884","#0084a8","#004da8","#8400a8","#a80084","#999999","#1a1a1a","#730000","#732600","#734c00","#737300","#4c7300","#267300","#00734c","#004c73","#002673","#4c0073","#73004"],b$4=[].concat(f$7.slice(30,39),f$7.slice(28,30).reverse()),e$a=[{name:"default",colors:b$4},{name:"cat-dark",colors:["#ed5151","#149ece","#a7c636","#9e559c","#fc921f","#ffde3e","#f789d8","#b7814a","#3caf99","#6b6bd6","#b54779","#7f7f7f"]},{name:"tropical-bliss",colors:["#fce138","#ff9399","#fcd27e","#f1983c","#a553b7","#b1a9d0","#6ecffc","#4c81cd","#fc6f84","#fc3e5a","#6af689","#48885c"]},{name:"desert-blooms",colors:["#102432","#144d59","#ffc730","#ed9310","#a64f1b","#661510","#d9351a","#b31515","#4a0932","#8c213f","#18382e","#2c6954"]},{name:"under-the-sea",colors:["#bf9727","#607100","#00734c","#704489","#01acca","#024e76","#f09100","#ea311f","#c6004b","#7570b3","#666666","#333333"]},{name:"vibrant-rainbow",colors:["#fffb00","#f5cb11","#9fd40c","#46e39c","#32b8a6","#7ff2fa","#ac08cc","#dd33ff","#eb7200","#e8a784","#bf2e2e","#6c7000"]},{name:"ocean-bay",colors:["#191921","#11495c","#78b1c2","#454f4b","#8f8f82","#9be0c0","#87b051","#f7ec88","#ebdcc1","#dbb658","#c43541","#75351e"]},{name:"prairie-summer",colors:["#332424","#751555","#d47013","#d68989","#211173","#82aad6","#7bfaeb","#6ec9a8","#6b6408","#eada40","#ccc54a","#1fc235"]},{name:"pastel-chalk",colors:["#fffd99","#f5e6a4","#c1d48c","#b8e3d0","#a0b8b5","#cbf7fa","#d791f2","#dfc1eb","#f2b983","#e8c4b2","#bf8e8e","#94995c"]},{name:"seq-yellow-orange-red-bright",colors:["#910000","#b1260b","#c0370f","#e05919","#ef6a1d","#ff7b22","#ffa143","#ffb454","#ffda74","#ffed85"]},{name:"seq-reds-bright",colors:["#57453b","#7b4238","#9f4036","#c23d33","#d7483c","#ec5244","#f3696c","#f9816c","#ffc4ae","#fff0dc"]},{name:"seq-purples-bright",colors:["#4e465c","#5a4a78","#695291","#775baa","#8663c3","#946bdc","#aa89e8","#c1a6f3","#d7c4ff","#e6e1ff"]},{name:"seq-blues-bright",colors:["#404d54","#435c6c","#48799d","#4b88b6","#4d96ce","#50a5e7","#74bbed","#98d0f3","#bce6f9","#e6faff"]},{name:"seq-greens-bright",colors:["#39544c","#386757","#368165","#359b73","#33b581","#4bc392","#64d2a2","#7ce0b3","#cbf6d9","#f4ffea"]},{name:"seq-browns-bright",colors:["#524834","#715b38","#8f6e3c","#ae8140","#cc9444","#eba748","#eeb664","#f0c47f","#f9e0b7","#fff8eb"]}];

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const r$b="en-us",u$f=new Map([["ar",()=>import('./ar-7ca9d8cb.js').then((function(n){return n.a}))],["bs-ba",()=>import('./bs_BA-f1841062.js').then((function(n){return n.b}))],["ca-es",()=>import('./ca_ES-0d2c799d.js').then((function(n){return n.c}))],["cs-cz",()=>import('./cs_CZ-8a959bb9.js').then((function(n){return n.c}))],["da-dk",()=>import('./da_DK-8ca92baa.js').then((function(n){return n.d}))],["de-de",()=>import('./de_DE-7476cca5.js').then((function(n){return n.d}))],["de-ch",()=>import('./de_CH-3f6fadae.js').then((function(n){return n.d}))],["el-gr",()=>import('./el_GR-fd4d0a80.js').then((function(n){return n.e}))],["en-us",()=>import('./en_US-fc7dd5ca.js').then((function(n){return n.e}))],["en-ca",()=>import('./en_CA-726595fe.js').then((function(n){return n.e}))],["es-es",()=>import('./es_ES-a260367b.js').then((function(n){return n.e}))],["et-ee",()=>import('./et_EE-23cf343c.js').then((function(n){return n.e}))],["fi-fi",()=>import('./fi_FI-21d9fe9c.js').then((function(n){return n.f}))],["fr-fr",()=>import('./fr_FR-ff93f7d5.js').then((function(n){return n.f}))],["he-il",()=>import('./he_IL-d3733b63.js').then((function(n){return n.h}))],["hr-hr",()=>import('./hr_HR-9f513f4a.js').then((function(n){return n.h}))],["hu-hu",()=>import('./hu_HU-fc49d5c0.js').then((function(n){return n.h}))],["id-id",()=>import('./id_ID-39939dc2.js').then((function(n){return n.i}))],["it-it",()=>import('./it_IT-54dc3bd2.js').then((function(n){return n.i}))],["ja-jp",()=>import('./ja_JP-b717e695.js').then((function(n){return n.j}))],["ko-kr",()=>import('./ko_KR-2dcf9e8a.js').then((function(n){return n.k}))],["lt-lt",()=>import('./lt_LT-f7e8c83f.js').then((function(n){return n.l}))],["lv-lv",()=>import('./lv_LV-d1064b91.js').then((function(n){return n.l}))],["nb-no",()=>import('./nb_NO-3b983639.js').then((function(n){return n.n}))],["nl-nl",()=>import('./nl_NL-9cf1652b.js').then((function(n){return n.n}))],["pl-pl",()=>import('./pl_PL-320f68b8.js').then((function(n){return n.p}))],["pt-br",()=>import('./pt_BR-2f5c509d.js').then((function(n){return n.p}))],["pt-pt",()=>import('./pt_PT-72f8cdb1.js').then((function(n){return n.p}))],["ro-ro",()=>import('./ro_RO-8c941ae1.js').then((function(n){return n.r}))],["ru-ru",()=>import('./ru_RU-5e99daf4.js').then((function(n){return n.r}))],["sk-sk",()=>import('./sk_SK-2dea1fad.js').then((function(n){return n.s}))],["sl-sl",()=>import('./sl_SL-81fcb707.js').then((function(n){return n.s}))],["sr-rs",()=>import('./sr_RS-3e325a54.js').then((function(n){return n.s}))],["sv-se",()=>import('./sv_SE-2a7514f3.js').then((function(n){return n.s}))],["th-th",()=>import('./th_TH-20bb7c4b.js').then((function(n){return n.t}))],["tr-tr",()=>import('./tr_TR-7fa593b9.js').then((function(n){return n.t}))],["uk-ua",()=>import('./uk_UA-dcf6c27a.js').then((function(n){return n.u}))],["vi-vn",()=>import('./vi_VN-58e1a651.js').then((function(n){return n.v}))],["zh-cn",()=>import('./zh_Hans-7c9b5e7a.js').then((function(n){return n.z}))],["zh-hk",()=>import('./zh_Hant-45734618.js').then((function(n){return n.z}))],["zh-tw",()=>import('./zh_Hant-45734618.js').then((function(n){return n.z}))]]);function e$9(n){const t=n.split("-")[0].toLowerCase();let r=null;for(const e of u$f.keys())if(e.startsWith(t)){r=e;break}return r}function s$i(n){return n?u$f.has(n.toLowerCase())?n.toLowerCase():e$9(n)||r$b:r$b}let o$d,i$j;async function c$l(t=c$u()){if(t=s$i(t),o$d&&t===i$j)return o$d;o$d=import('./index2-dba72cc2.js').then((function(n){return n.i})),i$j=t;try{const[n,r]=await Promise.all([o$d,u$f.get(i$j)()]);i$j===t&&(n.am4core.options.defaultLocale=r.default),n.am4core.options.suppressWarnings=!0,n.am4core.options.autoDispose=!0;}catch{return o$d=null,i$j=null,null}return o$d}function h$b(n,r="default"){const u=e$a.find((n=>n.name===r));return u?u.colors.map((t=>n.color(t))):null}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const v$3={base:"esri-feature-media",mediaContainer:"esri-feature-media__container",mediaItemContainer:"esri-feature-media__item-container",mediaItem:"esri-feature-media__item",mediaItemTitle:"esri-feature-media__item-title",mediaItemCaption:"esri-feature-media__item-caption",mediaPrevious:"esri-feature-media__previous",mediaPreviousIconLTR:"esri-feature-media__previous-icon",mediaPreviousIconRTL:"esri-feature-media__previous-icon--rtl",mediaNext:"esri-feature-media__next",mediaNextIconLTR:"esri-feature-media__next-icon",mediaNextIconRTL:"esri-feature-media__next-icon--rtl",mediaChart:"esri-feature-media__chart",mediaButton:"esri-feature-media__button",mediaIcon:"esri-feature-media__icon",iconLeftTriangleArrow:"esri-icon-left-triangle-arrow",iconRightTriangleArrow:"esri-icon-right-triangle-arrow"},_$5=.05,I$1=.95,M$2=15;let w$1=class extends L$7{constructor(e,t){super(e,t),this._refreshTimer=null,this._refreshIntervalInfo=null,this._featureElementInfo=null,this.attributes=null,this.activeMediaInfoIndex=null,this.description=null,this.fieldInfoMap=null,this.layer=null,this.mediaInfos=null,this.popupTemplate=null,this.relatedInfos=null,this.title=null,this.viewModel=new I$2,this.messages=null;}initialize(){this._featureElementInfo=new n$r,this.own(d$f(this,["viewModel.activeMediaInfo","viewModel.activeMediaInfoIndex"],(()=>this._setupMediaRefreshTimer())),d$f(this,["viewModel.description","viewModel.title"],(()=>this._setupFeatureElementInfo())));}destroy(){this._clearMediaRefreshTimer(),this._featureElementInfo.destroy();}render(){var e;return o$i("div",{bind:this,class:v$3.base,onkeyup:this._handleMediaKeyup},null==(e=this._featureElementInfo)?void 0:e.render(),this.renderMedia())}renderMedia(){const{formattedMediaInfoCount:e}=this.viewModel;return e?o$i("div",{key:"media-element-container",class:v$3.mediaContainer},this.renderMediaPageButton("previous"),this.renderMediaInfo(),this.renderMediaPageButton("next")):null}renderImageMediaInfo(e){const{_refreshIntervalInfo:t}=this,{activeMediaInfoIndex:i,formattedMediaInfoCount:r}=this.viewModel,{value:a,refreshInterval:o,altText:s,title:n,type:l}=e,{sourceURL:c,linkURL:u}=a,p=v$5(u)?"_blank":"_self",h="_blank"===p?"noreferrer":"",f=o?t:null,v=f?f.timestamp:0,_=f?f.sourceURL:c,I=o$i("img",{alt:s||n,key:`media-${l}-${i}-${r}-${v}`,src:_}),M=u?o$i("a",{title:n,href:u,rel:h,target:p},I):null;return M||I}renderChartMediaInfo(e){const{activeMediaInfoIndex:t,formattedMediaInfoCount:i}=this.viewModel;return o$i("div",{key:`media-${e.type}-${t}-${i}`,bind:this,class:v$3.mediaChart,afterCreate:this._getChartDependencies})}renderMediaInfoType(){const{activeMediaInfo:e}=this.viewModel;return e?"image"===e.type?this.renderImageMediaInfo(e):-1!==e.type.indexOf("chart")?this.renderChartMediaInfo(e):null:null}renderMediaInfo(){const{activeMediaInfo:e}=this.viewModel,t=e.title?o$i("div",{key:"media-title",class:v$3.mediaItemTitle,innerHTML:e.title}):null,i=e.caption?o$i("div",{key:"media-caption",class:v$3.mediaItemCaption,innerHTML:e.caption}):null;return o$i("div",{key:"media-container",class:v$3.mediaItemContainer},o$i("div",{key:"media-item-container",class:v$3.mediaItem},this.renderMediaInfoType()),t,i)}renderMediaPageButton(e){if(this.viewModel.formattedMediaInfoCount<2)return null;const t="previous"===e,i=t?this.messages.previous:this.messages.next,r=t?this.classes(v$3.mediaButton,v$3.mediaPrevious):this.classes(v$3.mediaButton,v$3.mediaNext),a=t?this.classes(v$3.mediaIcon,v$3.mediaPreviousIconLTR,v$3.iconLeftTriangleArrow):this.classes(v$3.mediaIcon,v$3.mediaNextIconLTR,v$3.iconRightTriangleArrow),o=t?this.classes(v$3.mediaIcon,v$3.mediaPreviousIconRTL,v$3.iconRightTriangleArrow):this.classes(v$3.mediaIcon,v$3.mediaNextIconRTL,v$3.iconLeftTriangleArrow),s=t?"media-previous":"media-next",n=t?this._previous:this._next;return o$i("button",{type:"button",key:s,title:i,"aria-label":i,tabIndex:0,class:r,bind:this,onclick:n},o$i("span",{"aria-hidden":"true",class:a}),o$i("span",{"aria-hidden":"true",class:o}))}_setupFeatureElementInfo(){const{description:e,title:t}=this;this._featureElementInfo.set({description:e,title:t});}_next(){this.viewModel.next();}_previous(){this.viewModel.previous();}async _getChartDependencies(e){const t=await c$l(),{activeMediaInfo:i}=this.viewModel;this._renderChart({chartDiv:e,mediaInfo:i,chartsModule:t});}_handleMediaKeyup(e){const t=i$r(e);"ArrowLeft"===t&&(e.stopPropagation(),this.viewModel.previous()),"ArrowRight"===t&&(e.stopPropagation(),this.viewModel.next());}_renderChart(e){const{chartsModule:t,chartDiv:i,mediaInfo:r}=e,{value:a,type:o}=r,{am4core:n}=t,l=h$b(n);function d(e){e instanceof n.ColorSet&&l&&(e.list=l);}y$g()&&n.useTheme(t.am4themes_dark),n.useTheme(t.am4themes_animated),n.useTheme(d);const c="pie-chart"===o?this._createPieChart(e):this._createXYChart(e);i.setAttribute("aria-label",r.altText||r.title),c.data=a.series.map((e=>({tooltip:e.tooltip,value:e.value}))).filter((e=>"pie-chart"!==o||e.value>0));}_customizeChartTooltip(e,t){e.label.wrap=!0,e.label.maxWidth=200,e.autoTextColor=!1,e.getFillFromObject=!1,e.label.fill=t.color("#ffffff"),e.background.fill=t.color({r:0,g:0,b:0,a:.7});}_createPieChart(e){const{chartDiv:t,chartsModule:i}=e,{am4core:r,am4charts:a}=i,o=r.create(t,a.PieChart);o.rtl=d$i();const s=o.series.push(new a.PieSeries);return s.labels.template.disabled=!0,s.ticks.template.disabled=!0,s.dataFields.value="value",s.dataFields.category="tooltip",this._customizeChartTooltip(s.tooltip,r),o}_getMinSeriesValue(e){let t=0;return e.forEach((e=>t=Math.min(e.value,t))),t}_createColumnChart(e,t){const{chartsModule:i,mediaInfo:r}=t,{value:a}=r,{am4core:o,am4charts:s}=i,n=e.xAxes.push(new s.CategoryAxis);n.dataFields.category="tooltip",n.renderer.labels.template.disabled=!0,this._customizeChartTooltip(n.tooltip,o),n.tooltip.events.on("sizechanged",(()=>{n.tooltip.dy=-n.tooltip.contentHeight;}));const l=e.yAxes.push(new s.ValueAxis),d=l.renderer.labels.template;l.renderer.minLabelPosition=_$5,l.renderer.maxLabelPosition=I$1,l.min=this._getMinSeriesValue(a.series),this._customizeChartTooltip(l.tooltip,o),d.wrap=!0;const c=e.series.push(new s.ColumnSeries);c.dataFields.valueY="value",c.dataFields.categoryX="tooltip",e.cursor=new s.XYCursor,a.series.length>M$2&&(e.scrollbarX=new o.Scrollbar);}_createBarChart(e,t){const{chartsModule:i,mediaInfo:r}=t,{value:a}=r,{am4core:o,am4charts:s}=i,n=e.yAxes.push(new s.CategoryAxis);n.dataFields.category="tooltip",n.renderer.inversed=!0,n.renderer.labels.template.disabled=!0,this._customizeChartTooltip(n.tooltip,o),n.tooltip.events.on("sizechanged",(()=>{n.tooltip.dx=n.tooltip.contentWidth;}));const l=e.xAxes.push(new s.ValueAxis),d=l.renderer.labels.template;l.renderer.minLabelPosition=_$5,l.renderer.maxLabelPosition=I$1,l.min=this._getMinSeriesValue(a.series),this._customizeChartTooltip(l.tooltip,o),d.wrap=!0;const c=e.series.push(new s.ColumnSeries);c.dataFields.valueX="value",c.dataFields.categoryY="tooltip",e.cursor=new s.XYCursor,a.series.length>M$2&&(e.scrollbarY=new o.Scrollbar);}_createLineChart(e,t){const{chartsModule:i,mediaInfo:r}=t,{value:a}=r,{am4core:o,am4charts:s}=i,n=e.xAxes.push(new s.CategoryAxis);n.dataFields.category="tooltip",n.renderer.labels.template.disabled=!0,this._customizeChartTooltip(n.tooltip,o),n.tooltip.events.on("sizechanged",(()=>{n.tooltip.dy=-n.tooltip.contentHeight;}));const l=e.yAxes.push(new s.ValueAxis),d=l.renderer.labels.template;l.renderer.minLabelPosition=_$5,l.renderer.maxLabelPosition=I$1,l.min=this._getMinSeriesValue(a.series),this._customizeChartTooltip(l.tooltip,o),d.wrap=!0;const c=e.series.push(new s.LineSeries);c.dataFields.categoryX="tooltip",c.dataFields.valueY="value",e.cursor=new s.XYCursor,a.series.length>M$2&&(e.scrollbarX=new o.Scrollbar);}_createXYChart(e){const{chartDiv:t,chartsModule:i,mediaInfo:r}=e,{type:a}=r,{am4core:o,am4charts:s}=i,l=o.create(t,s.XYChart);return l.rtl=d$i(),"column-chart"===a&&this._createColumnChart(l,e),"bar-chart"===a&&this._createBarChart(l,e),"line-chart"===a&&this._createLineChart(l,e),l}_clearMediaRefreshTimer(){const{_refreshTimer:e}=this;e&&(clearTimeout(e),this._refreshTimer=null);}_updateMediaInfoTimestamp(e){const t=Date.now();this._refreshIntervalInfo={timestamp:t,sourceURL:this._getImageSource(e,t)},this.scheduleRender();}_setupMediaRefreshTimer(){this._clearMediaRefreshTimer();const{activeMediaInfo:e}=this.viewModel;e&&"image"===e.type&&e.refreshInterval&&this._setRefreshTimeout(e);}_setRefreshTimeout(e){const{refreshInterval:t,value:i}=e;if(!t)return;const r=6e4*t;this._updateMediaInfoTimestamp(i.sourceURL);const a=setInterval((()=>{this._updateMediaInfoTimestamp(i.sourceURL);}),r);this._refreshTimer=a;}_getImageSource(e,t){const i=-1!==e.indexOf("?")?"&":"?",[r,a=""]=e.split("#");return `${r}${i}timestamp=${t}${a?"#":""}${a}`}};e$e([o$j("viewModel.attributes")],w$1.prototype,"attributes",void 0),e$e([o$j("viewModel.activeMediaInfoIndex")],w$1.prototype,"activeMediaInfoIndex",void 0),e$e([o$j("viewModel.description")],w$1.prototype,"description",void 0),e$e([o$j("viewModel.fieldInfoMap")],w$1.prototype,"fieldInfoMap",void 0),e$e([o$j("viewModel.layer")],w$1.prototype,"layer",void 0),e$e([o$j("viewModel.mediaInfos")],w$1.prototype,"mediaInfos",void 0),e$e([o$j("viewModel.popupTemplate")],w$1.prototype,"popupTemplate",void 0),e$e([o$j("viewModel.relatedInfos")],w$1.prototype,"relatedInfos",void 0),e$e([o$j("viewModel.title")],w$1.prototype,"title",void 0),e$e([y$e({type:I$2})],w$1.prototype,"viewModel",void 0),e$e([y$e(),e$h("esri/widgets/Feature/t9n/Feature")],w$1.prototype,"messages",void 0),w$1=e$e([i$o("esri.widgets.Feature.FeatureMedia")],w$1);var g$c=w$1;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const i$i=["$datastore","$map","$layer","$aggregatedfeatures"],o$c="esri.widgets.Feature.support.arcadeFeatureUtils",n$o=n$v.getLogger(o$c);function c$k(e){return `<ul class="esri-widget__list">${e.map((e=>`<li>${"string"==typeof e?X$1(W$4(e)):e}</li>`)).join("")}</ul>`}function p$m(e){return `<table class="esri-widget__table">${e.keys().map((r=>{const t=e.field(r);return `<tr><th>${r}</th><td>${"string"==typeof t?X$1(W$4(t)):t}</td></tr>`})).join("")}</table>`}function l$f({aggregatedFeatures:e,arcadeUtils:r,featureSetVars:a,context:s,viewInfo:i,map:o,graphic:n}){a.forEach((a=>{const c=a.toLowerCase(),p={map:o,spatialReference:i.sr};if("$map"===c&&(s.vars[c]=r.convertMapToFeatureSetCollection(p)),"$layer"===c&&(s.vars[c]=r.convertFeatureLayerToFeatureSet(n.sourceLayer,i.sr)),"$datastore"===c&&(s.vars[c]=r.convertServiceUrlToWorkspace(n.sourceLayer.url,i.sr)),"$aggregatedfeatures"===c){const a=n.layer,{fields:o,objectIdField:p,geometryType:l,spatialReference:u,displayField:f}=a,d=new ke({fields:o,objectIdField:p,geometryType:l,spatialReference:u,displayField:f,..."feature"===a.type?{templates:a.templates,typeIdField:a.typeIdField,types:a.types}:null,source:e});s.vars[c]=r.convertFeatureLayerToFeatureSet(d,i.sr);}}));}function u$e(){return import('./arcadeUtils-0513dddf.js').then(function (n) { return n.aq; })}async function f$6({graphic:e,view:r}){const{isAggregate:t,layer:a}=e;if(!t||!a||"2d"!==(null==r?void 0:r.type))return [];const s=await r.whenLayerView(a);if(!s.createQuery||!s.queryFeatures)return [];const i=s.createQuery();i.aggregateIds=[e.getObjectId()];const{features:o}=await s.queryFeatures(i);return o}async function d$a({expressionAttributes:e,info:r,arcadeUtils:t,spatialReference:o,map:u,graphic:d,view:g}){const y=`expression/${r.name}`,m=t.createSyntaxTree(r.expression),w=i$i.filter((e=>t.hasVariable(m,e)));await t.loadScriptDependencies(m,!0,w);const F=t.getViewInfo({spatialReference:o}),v=t.createExecContext(d,F);v.useAsync=!0;l$f({aggregatedFeatures:await f$6({graphic:d,view:g}),arcadeUtils:t,featureSetVars:w,context:v,viewInfo:F,map:u,graphic:d});const h=t.createFunction(m,v),x=await t.executeAsyncFunction(h,v).catch((e=>n$o.error("arcade-execution-error",{error:e,graphic:d,expressionInfo:r})));e[y]="string"==typeof x?X$1(W$4(x)):Array.isArray(x)?c$k(x):x&&"esri.arcade.Dictionary"===x.declaredClass?p$m(x):x;}async function g$b({popupTemplate:e,spatialReference:t,graphic:a,map:s,view:i}){const o=e.expressionInfos,n=[],c={};if(!o||!o.length)return c;const p=await u$e();for(const r of o)n.push(d$a({expressionAttributes:c,info:r,arcadeUtils:p,spatialReference:t,map:s,graphic:a,view:i}));return await E$5(n),c}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const P$3=1,R$2="esri.widgets.FeatureViewModel",O$3=n$v.getLogger(R$2);let U$3=class extends u$k{constructor(e){super(e),this._handles=new u$j,this._featureAbortController=null,this.graphicChangedThrottled=e$c(this.graphicChanged,P$3,this),this.content=null,this.contentViewModels=[],this.defaultPopupTemplateEnabled=!1,this.formattedAttributes=null,this.lastEditInfo=null,this.relatedInfos=new Map,this.title="",this.view=null,this._handles.add(d$f(this,["graphic","_effectivePopupTemplate"],(()=>this.graphicChangedThrottled())));}destroy(){this._clear(),this._cancelFeatureQuery(),this._handles.destroy(),this._handles=null,this.graphic=null,this._destroyContentViewModels(),this.relatedInfos.clear();}get _effectivePopupTemplate(){return r$f(this.graphic)?this.graphic.getEffectivePopupTemplate(this.defaultPopupTemplateEnabled):null}get _fieldInfoMap(){return K$1(V$2(this._effectivePopupTemplate),this._sourceLayer)}get _sourceLayer(){return N$3(this.graphic)}set graphic(e){this._set("graphic",e?e.clone():null);}get spatialReference(){return this.get("view.spatialReference")||null}set spatialReference(e){void 0!==e?this._override("spatialReference",e):this._clearOverride("spatialReference");}get map(){return this.get("view.map")||null}set map(e){void 0!==e?this._override("map",e):this._clearOverride("map");}get waitingForContent(){return !!this._featureAbortController}setActiveMedia(e,t){const r=this.contentViewModels[e];r instanceof I$2&&r.setActiveMedia(t);}nextMedia(e){const t=this.contentViewModels[e];t instanceof I$2&&t.next();}previousMedia(e){const t=this.contentViewModels[e];t instanceof I$2&&t.previous();}_clear(){this._set("title",""),this._set("content",null),this._set("formattedAttributes",null);}async graphicChanged(){this._cancelFeatureQuery(),this._clear();const{graphic:e}=this;if(!e)return;const t=a$m();this._featureAbortController=t;try{await this._queryFeature({signal:t.signal});}catch(r){O$3.error("error","error loading popupTemplate for graphic",{error:r,graphic:e});}this._featureAbortController===t&&(this._featureAbortController=null);}_cancelFeatureQuery(){const{_featureAbortController:e}=this;e&&e.abort(),this._featureAbortController=null;}_compileContent(e){if(this._destroyContentViewModels(),this.graphic)return Array.isArray(e)?e.map(((e,t)=>"attachments"===e.type?this._compileAttachments(e,t):"custom"===e.type?this._compileCustom(e,t):"fields"===e.type?this._compileFields(e,t):"media"===e.type?this._compileMedia(e,t):"text"===e.type?this._compileText(e,t):void 0)):"string"==typeof e?this._compileText(new c$v({text:e}),0).text:e}_destroyContentViewModels(){this.contentViewModels.forEach((e=>e&&!e.destroyed&&e.destroy())),this._set("contentViewModels",[]);}_compileAttachments(e,t){const{graphic:r}=this,{description:o,title:i}=e;return this.contentViewModels[t]=new p$s({graphic:r,...this._compileTitleAndDesc({title:i,description:o})}),e}_compileCustom(e,t){const{graphic:r}=this,{creator:o,destroyer:i}=e;return this.contentViewModels[t]=new p$q({graphic:r,creator:o,destroyer:i}),e}_compileTitleAndDesc({title:e,description:t}){const{_fieldInfoMap:r,_sourceLayer:o,graphic:i,formattedAttributes:s}=this,{attributes:a}=i,l=s.global;return {title:R$3({attributes:a,fieldInfoMap:r,globalAttributes:l,layer:o,text:e}),description:R$3({attributes:a,fieldInfoMap:r,globalAttributes:l,layer:o,text:t})}}_compileFields(e,t){const{_effectivePopupTemplate:r,formattedAttributes:o}=this,i=e.clone(),s=(null==e?void 0:e.fieldInfos)||(null==r?void 0:r.fieldInfos),a=null==r?void 0:r.expressionInfos,l={...o.global,...o.content[t]},{description:n,title:p}=i,c=new n$p({attributes:l,expressionInfos:a,fieldInfos:s,...this._compileTitleAndDesc({title:p,description:n})});return this.contentViewModels[t]=c,i.fieldInfos=c.formattedFieldInfos.slice(0),i}_compileMedia(e,t){const{graphic:r,_fieldInfoMap:o,_effectivePopupTemplate:i,relatedInfos:s,_sourceLayer:a}=this,{attributes:l}=r,n=this.formattedAttributes.global,p=e.clone(),{description:c,mediaInfos:d,title:u}=p,f=new I$2({activeMediaInfoIndex:p.activeMediaInfoIndex||0,attributes:l,layer:a,fieldInfoMap:o,formattedAttributes:n,mediaInfos:d,popupTemplate:i,relatedInfos:s,...this._compileTitleAndDesc({title:u,description:c})});return p.mediaInfos=f.formattedMediaInfos.slice(0),this.contentViewModels[t]=f,p}_compileText(e,t){const r=e.clone(),{graphic:o,_fieldInfoMap:i,_sourceLayer:s}=this;if(r&&r.text){const{attributes:e}=o,t=this.formattedAttributes.global;r.text=R$3({attributes:e,fieldInfoMap:i,globalAttributes:t,layer:s,text:r.text});}return this.contentViewModels[t]=new p$q({graphic:o,creator:r.text}),r}_compileLastEditInfo(){const{_effectivePopupTemplate:e,_sourceLayer:t,graphic:r}=this;if(!e)return;const{lastEditInfoEnabled:o}=e,i=null==t?void 0:t.editFieldsInfo;return o&&i?J$1(i,r.attributes):void 0}_compileTitle(e){const{_fieldInfoMap:t,_sourceLayer:r,graphic:o}=this,{attributes:i}=o,s=this.formattedAttributes.global;return R$3({attributes:i,fieldInfoMap:t,globalAttributes:s,layer:r,text:e})}async _getTitle(){const{_effectivePopupTemplate:e,graphic:t}=this,r=null==e?void 0:e.title;return j$3(r,{graphic:t})}async _getContent(){const{_effectivePopupTemplate:e,graphic:t}=this,r=null==e?void 0:e.content;return j$3(r,{graphic:t})}async _queryFeature(e){const{_featureAbortController:t,_sourceLayer:r,graphic:o,_effectivePopupTemplate:i,spatialReference:s,map:l,view:n}=this,{content:{value:p},title:{value:c}}=await E$5({content:this._getContent(),title:this._getTitle()});if(t!==this._featureAbortController||!o)return;const{expressionAttributes:{value:d}}=await E$5({checkForRelatedFeatures:this._checkForRelatedFeatures(e),expressionAttributes:g$b({popupTemplate:this._effectivePopupTemplate,spatialReference:s,graphic:o,map:l,view:n}),queryUpdatedFeature:ee({graphic:o,popupTemplate:i,layer:r,spatialReference:s},e)});t===this._featureAbortController&&o&&(this._set("formattedAttributes",this._createFormattedAttributes(p,d)),this._set("title",this._compileTitle(c)),this._set("lastEditInfo",this._compileLastEditInfo()||null),this._set("content",this._compileContent(p)||null));}_createFormattedAttributes(e,t){const{_effectivePopupTemplate:r,graphic:o,relatedInfos:i,_sourceLayer:s,_fieldInfoMap:a}=this,l=null==r?void 0:r.fieldInfos,n={...o.attributes,...t},p={global:Z$1({fieldInfos:l,graphic:o,attributes:n,layer:s,fieldInfoMap:a,relatedInfos:i}),content:[]};return Array.isArray(e)&&e.forEach(((e,t)=>{"fields"===e.type&&e.fieldInfos&&(p.content[t]=Z$1({fieldInfos:e.fieldInfos,graphic:o,attributes:n,layer:s,fieldInfoMap:a,relatedInfos:i}));})),p}_checkForRelatedFeatures(e){const{graphic:t,_effectivePopupTemplate:r}=this;return this._queryRelatedInfos(t,V$2(r),e)}async _queryRelatedInfos(e,r,o){const{relatedInfos:i,_sourceLayer:s}=this;i.clear();const a=r$f(s.associatedLayer)?await s.associatedLayer.load(o):s;if(!a)return;const l=r.filter((e=>e&&te(e.fieldName)));if(!l||!l.length)return;r.forEach((e=>this._configureRelatedInfo(e,a)));const n=await T$2({relatedInfos:i,layer:a},o);Object.keys(n).forEach((e=>{var t;const r=i.get(e.toString()),o=null==(t=n[e])?void 0:t.value;r&&o&&(r.layerInfo=o.data);}));const p=await $$1({graphic:e,relatedInfos:i,layer:a},o);Object.keys(p).forEach((e=>{var t;w$2(null==(t=p[e])?void 0:t.value,i.get(e.toString()));}));}_configureRelatedInfo(e,t){const{relatedInfos:r}=this,o=m$e(e.fieldName);if(!o)return;const{layerId:i,fieldName:s}=o;if(!i)return;const a=r.get(i.toString())||I$3(i,t);a&&(k$3({relatedInfo:a,fieldName:s,fieldInfo:e}),this.relatedInfos.set(i,a));}};e$e([y$e()],U$3.prototype,"_featureAbortController",void 0),e$e([y$e({readOnly:!0})],U$3.prototype,"_effectivePopupTemplate",null),e$e([y$e({readOnly:!0})],U$3.prototype,"_fieldInfoMap",null),e$e([y$e({readOnly:!0})],U$3.prototype,"_sourceLayer",null),e$e([y$e({readOnly:!0})],U$3.prototype,"content",void 0),e$e([y$e({readOnly:!0})],U$3.prototype,"contentViewModels",void 0),e$e([y$e({type:Boolean})],U$3.prototype,"defaultPopupTemplateEnabled",void 0),e$e([y$e({readOnly:!0})],U$3.prototype,"formattedAttributes",void 0),e$e([y$e({type:n$x,value:null})],U$3.prototype,"graphic",null),e$e([y$e({readOnly:!0})],U$3.prototype,"lastEditInfo",void 0),e$e([y$e()],U$3.prototype,"relatedInfos",void 0),e$e([y$e()],U$3.prototype,"spatialReference",null),e$e([y$e({readOnly:!0})],U$3.prototype,"title",void 0),e$e([y$e()],U$3.prototype,"map",null),e$e([y$e({readOnly:!0})],U$3.prototype,"waitingForContent",null),e$e([y$e()],U$3.prototype,"view",void 0),U$3=e$e([i$o(R$2)],U$3);var k$2=U$3;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const v$2={iconText:"esri-icon-font-fallback-text",iconLoading:"esri-icon-loading-indicator esri-rotating",esriTable:"esri-widget__table",esriWidget:"esri-widget",base:"esri-feature",container:"esri-feature__size-container",title:"esri-feature__title",main:"esri-feature__main-container",btn:"esri-feature__button",icon:"esri-feature__icon",content:"esri-feature__content",contentElement:"esri-feature__content-element",text:"esri-feature__text",lastEditedInfo:"esri-feature__last-edited-info",fields:"esri-feature__fields",fieldHeader:"esri-feature__field-header",fieldData:"esri-feature__field-data",fieldDataDate:"esri-feature__field-data--date",loadingSpinnerContainer:"esri-feature__loading-container",spinner:"esri-feature__loading-spinner"},y$7={title:!0,content:!0,lastEditedInfo:!0};let g$a=class extends(i$l(L$7)){constructor(e,t){super(e,t),this._contentWidgets=[],this.graphic=null,this.defaultPopupTemplateEnabled=!1,this.label=void 0,this.messages=null,this.messagesURIUtils=null,this.spatialReference=null,this.title=null,this.visibleElements={...y$7},this.map=null,this.view=null,this.viewModel=new k$2;}initialize(){this.own(d$f(this,"viewModel.contentViewModels",(()=>this._setupContentWidgets())));}destroy(){this._destroyContentWidgets();}castVisibleElements(e){return {...y$7,...e}}render(){const{waitingForContent:e}=this.viewModel;return o$i("div",{class:this.classes(v$2.base,v$2.esriWidget)},o$i("div",{class:v$2.container},this.renderTitle(),e?this.renderLoading():this.renderContentContainer()))}setActiveMedia(e,t){this.viewModel.setActiveMedia(e,t);}nextMedia(e){this.viewModel.nextMedia(e);}previousMedia(e){this.viewModel.previousMedia(e);}renderLoading(){return o$i("div",{key:"loading-container",class:v$2.loadingSpinnerContainer},o$i("span",{class:this.classes(v$2.iconLoading,v$2.spinner)}))}renderContentContainer(){const{visibleElements:e}=this;return e.content?o$i("div",{class:v$2.main},[this.renderContent(),this.renderLastEditInfo()]):null}renderTitle(){const{visibleElements:e,title:t}=this;return e.title?o$i("h4",{class:v$2.title,innerHTML:t}):null}renderContent(){const e=this.viewModel.content,t="content";if(!e)return null;if(Array.isArray(e))return e.length?o$i("div",{key:`${t}-content-elements`},e.map(this.renderContentElement,this)):null;if("string"==typeof e){const e=this._contentWidgets[0];return !e||e.destroyed?null:o$i("div",{key:`${t}-content`},e.render())}return this.renderNodeContent(e)}renderContentElement(e,t){const{visibleElements:i}=this;if("boolean"!=typeof i.content&&!i.content[e.type])return null;switch(e.type){case"attachments":return this.renderAttachments(t);case"custom":return this.renderCustom(e,t);case"fields":return this.renderFields(t);case"media":return this.renderMedia(t);case"text":return this.renderText(e,t);default:return null}}renderAttachments(e){const t=this._contentWidgets[e];if(!t||t.destroyed)return null;const{state:i,attachmentInfos:s}=t.viewModel;return "loading"===i||s.length>0?o$i("div",{key:this._buildKey("attachments-element",e),class:this.classes(v$2.contentElement)},t.render()):null}renderCustom(e,t){const{creator:i}=e,s=this._contentWidgets[t];return !s||s.destroyed?null:i?o$i("div",{key:this._buildKey("custom-element",t),class:v$2.contentElement},s.render()):null}renderFields(e){const t=this._contentWidgets[e];return !t||t.destroyed?null:o$i("div",{key:this._buildKey("fields-element",e),class:v$2.contentElement},t.render())}renderMedia(e){const t=this._contentWidgets[e];return !t||t.destroyed?null:o$i("div",{key:this._buildKey("media-element",e),class:v$2.contentElement},t.render())}renderLastEditInfo(){const{visibleElements:e,messages:t}=this,{lastEditInfo:i}=this.viewModel;if(!i||!e.lastEditedInfo)return null;const{date:s,user:n}=i,o="edit"===i.type?n?t.lastEditedByUser:t.lastEdited:n?t.lastCreatedByUser:t.lastCreated,d=s$o(o,{date:s,user:n});return o$i("div",{key:"edit-info-element",class:this.classes(v$2.lastEditedInfo,v$2.contentElement)},d)}renderText(e,t){const i=e.text,s=this._contentWidgets[t];return !s||s.destroyed?null:i?o$i("div",{key:this._buildKey("text-element",t),class:this.classes(v$2.contentElement,v$2.text)},s.render()):null}_buildKey(e,...t){return `${e}__${this.get("viewModel.graphic.uid")||"0"}-${t.join("-")}`}_destroyContentWidgets(){this._contentWidgets.forEach((e=>{e.viewModel=null,e&&!e.destroyed&&e.destroy();})),this._contentWidgets=[];}_setupContentWidgets(){this._destroyContentWidgets();const e=this.get("viewModel.content"),{contentViewModels:t}=this.viewModel;if(Array.isArray(e))e.forEach(((e,i)=>{"attachments"===e.type&&(this._contentWidgets[i]=new m$g({displayType:e.displayType,viewModel:t[i]})),"fields"===e.type&&(this._contentWidgets[i]=new m$f({viewModel:t[i]})),"media"===e.type&&(this._contentWidgets[i]=new g$c({viewModel:t[i]})),"text"===e.type&&(this._contentWidgets[i]=new l$h({viewModel:t[i]})),"custom"===e.type&&(this._contentWidgets[i]=new l$h({viewModel:t[i]}));}),this);else {const e=t[0];e&&!e.destroyed&&(this._contentWidgets[0]=new l$h({viewModel:e}));}this.scheduleRender();}};e$e([o$j("viewModel.graphic")],g$a.prototype,"graphic",void 0),e$e([o$j("viewModel.defaultPopupTemplateEnabled")],g$a.prototype,"defaultPopupTemplateEnabled",void 0),e$e([y$e({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],g$a.prototype,"label",void 0),e$e([y$e(),e$h("esri/widgets/Feature/t9n/Feature")],g$a.prototype,"messages",void 0),e$e([y$e(),e$h("esri/widgets/support/t9n/uriUtils")],g$a.prototype,"messagesURIUtils",void 0),e$e([o$j("viewModel.spatialReference")],g$a.prototype,"spatialReference",void 0),e$e([o$j("viewModel.title")],g$a.prototype,"title",void 0),e$e([y$e()],g$a.prototype,"visibleElements",void 0),e$e([c$r("visibleElements")],g$a.prototype,"castVisibleElements",null),e$e([o$j("viewModel.map")],g$a.prototype,"map",void 0),e$e([o$j("viewModel.view")],g$a.prototype,"view",void 0),e$e([y$e({type:k$2})],g$a.prototype,"viewModel",void 0),g$a=e$e([i$o("esri.widgets.Feature")],g$a);var _$4=g$a;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
let a$g=class extends n$y.EventedAccessor{constructor(e){super(e),this._anchorHandles=new u$j,this.location=null,this.screenLocation=null,this.screenLocationEnabled=!1,this.view=null,this._anchorHandles.add([h$g(this,["screenLocationEnabled","location","view.size","view.stationary"],(()=>this._updateScreenPointAndHandle())),h$g(this,["view","view.ready"],(()=>this._wireUpView()))]);}destroy(){this.view=null,this._anchorHandles&&this._anchorHandles.destroy(),this._anchorHandles=null,this._viewpointHandle=null;}_wireUpView(){const e="view";this._anchorHandles.remove(e),this._viewpointHandle=null;if(!this.get("view.ready"))return;this._setScreenLocation();const{view:t}=this,o="3d"===t.type?"camera":"viewpoint",i=B$5(t,o,(()=>this._viewpointChange()));this._anchorHandles.add(i,e),this._viewpointHandle=i,this._toggleWatchingViewpoint();}_viewpointChange(){this._setScreenLocation(),this.emit("view-change");}_updateScreenPointAndHandle(){this._setScreenLocation(),this._toggleWatchingViewpoint();}_toggleWatchingViewpoint(){const{_viewpointHandle:e,location:t,screenLocationEnabled:o}=this;if(!e)return;t&&o?e.resume():e.pause();}_setScreenLocation(){const{location:e,view:o,screenLocationEnabled:i}=this,s=this.get("view.ready"),n=i&&s&&r$f(e)?o.toScreen(e):null;this._set("screenLocation",n);}};e$e([y$e()],a$g.prototype,"location",void 0),e$e([y$e({readOnly:!0})],a$g.prototype,"screenLocation",void 0),e$e([y$e()],a$g.prototype,"screenLocationEnabled",void 0),e$e([y$e()],a$g.prototype,"view",void 0),a$g=e$e([i$o("esri.widgets.support.AnchorElementViewModel")],a$g);var l$e=a$g;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const t$e="esri.widgets.CompassViewModel";let p$l=class extends l$e{constructor(o){super(o),this.visible=!1;}};e$e([y$e()],p$l.prototype,"visible",void 0),p$l=e$e([i$o(t$e)],p$l);var i$h=p$l;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const c$j={base:"esri-spinner",spinnerStart:"esri-spinner--start",spinnerFinish:"esri-spinner--finish"};let m$d=class extends L$7{constructor(i,e){super(i,e),this._animationDelay=500,this._animationPromise=null,this.location=null,this.view=null,this.viewModel=new i$h,this.visible=!1;}initialize(){this.own([h$g(this,"visible",(i=>this._visibleChange(i)))]);}destroy(){this._animationPromise=null;}show(i){const{location:e,promise:s}=i;e&&(this.viewModel.location=e),this.visible=!0;const o=()=>this.hide();s&&s.catch((()=>{})).then(o);}hide(){this.visible=!1;}render(){const{visible:i}=this,{screenLocation:e}=this.viewModel,s=!!e,o=i&&s,t=!i&&s,r={[c$j.spinnerStart]:o,[c$j.spinnerFinish]:t},n=this._getPositionStyles();return o$i("div",{class:this.classes(c$j.base,r),styles:n})}_visibleChange(i){if(i)return void(this.viewModel.screenLocationEnabled=!0);const e=C$8(this._animationDelay);this._animationPromise=e,e.catch((()=>{})).then((()=>{this._animationPromise===e&&(this.viewModel.screenLocationEnabled=!1,this._animationPromise=null);}));}_getPositionStyles(){const{screenLocation:i,view:s}=this.viewModel;if(!s||t$f(i))return {};const{padding:o}=s;return {left:i.x-o.left+"px",top:i.y-o.top+"px"}}};e$e([o$j("viewModel.location")],m$d.prototype,"location",void 0),e$e([o$j("viewModel.view")],m$d.prototype,"view",void 0),e$e([y$e({type:i$h})],m$d.prototype,"viewModel",void 0),e$e([o$j("viewModel.visible")],m$d.prototype,"visible",void 0),m$d=e$e([i$o("esri.widgets.Spinner")],m$d);var h$a=m$d;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
function b$3(e){return e&&"opacity"in e?e.opacity*b$3(e.parent):1}async function f$5(o,n){if(!o)return;const c=b$3(o.layer||o.sourceLayer);if(r$f(o.symbol)&&(!r$f(n)||!0!==n.ignoreGraphicSymbol)){const t="web-style"===o.symbol.type?await o.symbol.fetchSymbol(r$f(n)?n.abortOptions:null):o.symbol.clone();return v$7(t,null,c),t}const u=r$f(n)&&n.renderer||o.get("layer.renderer")||o.get("sourceLayer.renderer");let y=await u.getSymbolAsync(o,n);if(!y)return;if(y="web-style"===y.type?await y.fetchSymbol(r$f(n)?n.abortOptions:null):y.clone(),!("visualVariables"in u)||"visualVariables"in u&&!u.visualVariables||"visualVariables"in u&&u.visualVariables&&!u.visualVariables.length)return y;if(u.arcadeRequiredForVisualVariables&&(t$f(n)||t$f(n.arcade))){const e={...e$i(n)};e.arcade=await a$n(),n=e;}const p=await import('./visualVariableUtils-66f67c57.js'),h=[],f=[],m=[],d=[];for(const e of u.visualVariables)switch(e.type){case"color":h.push(e);break;case"opacity":f.push(e);break;case"rotation":d.push(e);break;case"size":e.target||m.push(e);}const g=!!h.length&&h[h.length-1],w=g?p.getColor(g,o,n):null,v=!!f.length&&f[f.length-1];let S=v?p.getOpacity(v,o,n):null;if(null!=c&&(S=null!=S?S*c:c),v$7(y,w,S),m.length){const e=p.getAllSizes(m,o,n);await M$5(y,e);}for(const e of d)q$3(y,p.getRotationAngle(e,o,n),e.axis);return y}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const t$d=t$g("mac")?"Meta":"Ctrl",o$b={8:"Backspace",9:"Tab",13:"Enter",27:"Escape",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete"};for(let s=48;s<58;s++)o$b[s]=String.fromCharCode(s);for(let s=1;s<25;s++)o$b[111+s]=`F${s}`;for(let s=65;s<91;s++)o$b[s]=[String.fromCharCode(s+32),String.fromCharCode(s)];function a$f(r){if(void 0!==r.key)return i$r(r);const t=o$b[r.keyCode];return Array.isArray(t)?r.shiftKey?t[1]:t[0]:t}function n$n(r){switch(r){case"Ctrl":case"Alt":case"Shift":case"Meta":case"Primary":return !0}return !1}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
class e$8{constructor(e,t=[]){this.eventType=e,this.keyModifiers=t;}matches(e){if(e.type!==this.eventType)return !1;if(0===this.keyModifiers.length)return !0;const t=e.modifiers;for(const i of this.keyModifiers)if(!t.has(i))return !1;return !0}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const n$m=n$v.getLogger("esri.views.input.InputHandler");class i$g{constructor(e){this._manager=null,this._incoming={},this._outgoing={},this._incomingEventMatches=null,this._incomingEventTypes=null,this._outgoingEventTypes=null,this._hasSideEffects=e;}get incomingEventMatches(){if(!this._incomingEventMatches){this._incomingEventMatches=[];for(const e in this._incoming){const t=this._incoming[e];for(const e of t)this._incomingEventMatches.push(e.match);}}return this._incomingEventMatches}get incomingEventTypes(){return this._incomingEventTypes||(this._incomingEventTypes=this.incomingEventMatches.map((e=>e.eventType))),this._incomingEventTypes}get outgoingEventTypes(){return this._outgoingEventTypes||(this._outgoingEventTypes=Object.keys(this._outgoing)),this._outgoingEventTypes}get hasSideEffects(){return this._hasSideEffects}get hasPendingInputs(){return !1}onInstall(e){this._manager?n$m.error("This InputHandler has already been registered with an InputManager"):(e.setEventCallback((e=>this._handleEvent(e))),e.setUninstallCallback((()=>this._onUninstall())),this._manager=e);}onUninstall(){}registerIncoming(e,n,i){let a;"function"==typeof n?(i=n,a=[]):a=n||[];const o="string"==typeof e?new e$8(e,a):e,h=()=>{this._incomingEventTypes=null,this._incomingEventMatches=null;},r=e=>{const t=this._incoming[e.match.eventType];if(t){const n=t.indexOf(e);t.splice(n,1),h(),this._manager&&this._manager.updateDependencies();}},g=new s$h(o,i,{onPause:r,onRemove:r,onResume:e=>{const t=this._incoming[e.match.eventType];t&&-1===t.indexOf(e)&&(t.push(e),h(),this._manager&&this._manager.updateDependencies());}});let c=this._incoming[o.eventType];return c||(c=[],this._incoming[o.eventType]=c),c.push(g),h(),this._manager&&this._manager.updateDependencies(),g}registerOutgoing(e){if(this._outgoing[e])throw Error("There is already a callback registered for this outgoing InputEvent: "+e);const t=new a$e(e,{onEmit:(e,t,n,i)=>{this._manager.emit(e.eventType,t,n,i);},onRemove:e=>{delete this._outgoing[e.eventType],this._manager.updateDependencies();}});return this._outgoing[e]=t,this._outgoingEventTypes=null,this._manager&&this._manager.updateDependencies(),t}startCapturingPointer(e){this._manager.setPointerCapture(e,!0);}stopCapturingPointer(e){this._manager.setPointerCapture(e,!1);}refreshHasPendingInputs(){this._manager.refreshHasPendingInputs();}_onUninstall(){this._manager?(this.onUninstall(),this._manager=null):n$m.error("This InputHandler is not registered with an InputManager");}_handleEvent(e){const t=this._incoming[e.type];if(t)for(const n of t)if(n.match.matches(e)&&(n.callback(e),e.shouldStopPropagation()))break}}class s$h{constructor(e,t,n){this.match=e,this._callback=t,this._handler=n;}pause(){this._handler.onPause(this);}resume(){this._handler.onResume(this);}remove(){this._handler.onRemove(this);}get callback(){return this._callback}}class a$e{constructor(e,t){this.eventType=e,this._removed=!1,this._handler=t;}emit(e,t,n){this._removed||this._handler.onEmit(this,e,t,n);}remove(){this._removed=!0,this._handler.onRemove(this);}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
class t$c extends i$g{constructor(e){super(!0),this._onChange=e,this._value="mouse",this.registerIncoming("pointer-down",(e=>{const t="touch"===e.data.native.pointerType;this._setValue(t?"touch":"mouse");})),this._moveHandler=this.registerIncoming("pointer-move",(e=>{const t="touch"===e.data.native.pointerType;this._setValue(t?"touch":"mouse");})),this._moveHandler.pause();}_setValue(e){e!==this._value&&("touch"===e?this._moveHandler.resume():this._moveHandler.pause(),this._value=e,this._onChange(e));}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const h$9=n$v.getLogger("esri.views.input.InputManager");let l$d=class extends u$k{constructor(e){super(e),this._pointerCaptures=new Map,this._nameToGroup={},this._handlers=[],this._currentPropagation=null,this._sourceEvents=new Set,this._keyModifiers=new Set,this._activeKeyModifiers=new Set,this._stoppedPropagationEventIds=new Set,this.primaryKey=t$d,this.latestPointerType="mouse",this.test={timestamp:void 0,hasCurrentPropagation:()=>!!this._currentPropagation};}initialize(){this.eventSource.onEventReceived=this._onEventReceived.bind(this),this._installRecognizers();}destroy(){const e=Object.keys(this._nameToGroup);for(const t of e)this.uninstallHandlers(t);this.eventSource=null,this._currentPropagation=null;}get hasPendingInputs(){return this._handlers.some((e=>e.handler.hasPendingInputs))}installHandlers(e,t,r=u$d.INTERNAL){if(this._nameToGroup[e])return void h$9.error("There is already an InputHandler group registered under the name `"+e+"`");if(0===t.length)return void h$9.error("Can't register a group of zero handlers");const i={name:e,handlers:t.map((e=>({handler:e,active:!0,removed:!1,priorityIndex:0,groupPriority:r,eventCallback:null,uninstallCallback:null})))};this._nameToGroup[e]=i;for(let n=i.handlers.length-1;n>=0;n--){const e=i.handlers[n];this._handlers.push(e),e.handler.onInstall({updateDependencies:()=>{this.updateDependencies();},emit:(t,r,i,n,s)=>{this._emitInputEvent(e.priorityIndex+1,t,r,i,s,n);},setPointerCapture:(t,r)=>{this._setPointerCapture(i,e,t,r);},setEventCallback:t=>{e.eventCallback=t;},setUninstallCallback:t=>{e.uninstallCallback=t;},refreshHasPendingInputs:()=>{this.notifyChange("hasPendingInputs");}});}this.updateDependencies();}uninstallHandlers(e){const t=this._nameToGroup[e];t?(t.handlers.forEach((e=>{e.removed=!0,e.uninstallCallback();})),delete this._nameToGroup[e],this._currentPropagation?this._currentPropagation.needsHandlerGarbageCollect=!0:this._garbageCollectRemovedHandlers()):h$9.error("There is no InputHandler group registered under the name `"+e+"`");}hasHandlers(e){return void 0!==this._nameToGroup[e]}updateDependencies(){const e=new Set,t=new Set;this._handlersPriority=[];for(let r=this._handlers.length-1;r>=0;r--){const e=this._handlers[r];e.priorityIndex=r,this._handlersPriority.push(e);}this._handlersPriority=this._sortHandlersPriority(this._handlersPriority);for(let r=this._handlersPriority.length-1;r>=0;r--){const i=this._handlersPriority[r];i.priorityIndex=r;let n=i.handler.hasSideEffects;if(!n)for(const t of i.handler.outgoingEventTypes)if(e.has(t)){n=!0;break}if(n)for(const r of i.handler.incomingEventMatches){e.add(r.eventType);for(const e of r.keyModifiers)n$n(e)||t.add(e);}i.active=n;}this._sourceEvents=e,this._keyModifiers=t,this._pointerCaptures.size>0&&this._sourceEvents.add("pointer-capture-lost"),this._keyModifiers.size>0&&(this._sourceEvents.add("key-down"),this._sourceEvents.add("key-up")),this.eventSource&&(this.eventSource.activeEvents=this._sourceEvents);}_setLatestPointerType(e){this._set("latestPointerType",e);}_onEventReceived(e,t){if("pointer-capture-lost"===e){const e=t;this._pointerCaptures.delete(e.native.pointerId);}this._updateKeyModifiers(e,t);const r=null!=this.test.timestamp?this.test.timestamp:t.native?t.native.timestamp:void 0,i=t.native?t.native.cancelable:void 0;this._emitInputEventFromSource(e,t,r,i);}_updateKeyModifiers(e,t){if(!t)return;let r=!1;const i=()=>{if(!r){const e=new Set;this._activeKeyModifiers.forEach((t=>{e.add(t);})),this._activeKeyModifiers=e,r=!0;}},n=(e,t)=>{t&&!this._activeKeyModifiers.has(e)?(i(),this._activeKeyModifiers.add(e)):!t&&this._activeKeyModifiers.has(e)&&(i(),this._activeKeyModifiers.delete(e));};if("key-down"===e||"key-up"===e){const r=t.key;this._keyModifiers.has(r)&&n(r,"key-down"===e);}const s=t.native;n("Alt",!(!s||!s.altKey)),n("Ctrl",!(!s||!s.ctrlKey)),n("Shift",!(!s||!s.shiftKey)),n("Meta",!(!s||!s.metaKey)),n("Primary",this._activeKeyModifiers.has(this.primaryKey));}_installRecognizers(){this._latestPointerTypeHandler=new t$c((e=>this._setLatestPointerType(e))),this.recognizers.length>0&&this.installHandlers("default",this.recognizers,u$d.INTERNAL),this.installHandlers("input-manager-logic",[this._latestPointerTypeHandler],u$d.INTERNAL);}_setPointerCapture(e,t,r,i){const n=e.name+"-"+t.priorityIndex,s=this._pointerCaptures.get(r.pointerId)||new Set;this._pointerCaptures.set(r.pointerId,s),i?(s.add(n),1===s.size&&this.eventSource&&this.eventSource.setPointerCapture(r,!0)):s.has(n)&&(s.delete(n),0===s.size&&(this._pointerCaptures.delete(r.pointerId),this.eventSource&&this.eventSource.setPointerCapture(r,!1)));}_garbageCollectRemovedHandlers(){this._handlers=this._handlers.filter((e=>!e.removed)),this.updateDependencies();}_emitInputEventFromSource(e,t,r,i){this._emitInputEvent(0,e,t,r,i);}_emitInputEvent(e,t,r,i,n,s){const o=void 0!==i?i:this._currentPropagation?this._currentPropagation.timestamp:performance.now(),a=void 0!==n&&n,p={event:new d$9(t,r,o,s||this._activeKeyModifiers,a),priorityIndex:e};this._currentPropagation?this._currentPropagation.events.push(p):this._doNewPropagation(p);}_doNewPropagation(e){this._currentPropagation={events:new t$h,currentHandler:null,needsHandlerGarbageCollect:!1,timestamp:e.event.timestamp},this._currentPropagation.events.push(e),this._continuePropagation();}_continuePropagation(){const e=this._currentPropagation;if(e){for(;this._currentPropagation.events.length>0;){const{event:t,priorityIndex:r}=this._currentPropagation.events.pop(),i=t.data&&t.data.eventId;if(!(null!=i&&this._stoppedPropagationEventIds.has(i)))for(e.currentHandler=this._handlersPriority[r];e.currentHandler;){if(e.currentHandler.removed)e.needsHandlerGarbageCollect=!0;else {if(e.currentHandler.active&&!t.shouldStopPropagation()&&e.currentHandler.eventCallback(t),t.shouldStopPropagation()){null!=i&&this._stoppedPropagationEventIds.add(i);break}if(t.shouldPausePropagation((()=>this._continuePropagation())))return void this._pausePropagation({event:t,priorityIndex:e.currentHandler.priorityIndex+1})}e.currentHandler=this._handlersPriority[e.currentHandler.priorityIndex+1];}}e.needsHandlerGarbageCollect&&this._garbageCollectRemovedHandlers(),this.hasPendingInputs||this._stoppedPropagationEventIds.clear(),this._currentPropagation=null;}}_pausePropagation(e){const t=new t$h;for(t.push(e);this._currentPropagation.events.length;)t.push(this._currentPropagation.events.pop());this._currentPropagation.events=t,this._currentPropagation.currentHandler=null;}_compareHandlerPriority(e,t){if(e.handler.hasSideEffects!==t.handler.hasSideEffects)return e.handler.hasSideEffects?1:-1;if(e.groupPriority!==t.groupPriority)return e.groupPriority>t.groupPriority?-1:1;for(const r of e.handler.incomingEventMatches)for(const e of t.handler.incomingEventMatches){if(r.eventType!==e.eventType)continue;const t=r.keyModifiers.filter((t=>-1!==e.keyModifiers.indexOf(t)));if(t.length===r.keyModifiers.length!==(t.length===e.keyModifiers.length))return r.keyModifiers.length>e.keyModifiers.length?-1:1}return e.priorityIndex>t.priorityIndex?-1:1}_sortHandlersPriority(e){const t=[];for(const r of e){let e=0;for(;e<t.length&&this._compareHandlerPriority(r,t[e])>=0;)e++;t.splice(e,0,r);}return t}get debug(){const e=e=>{const t=this._setPointerCapture;this._setPointerCapture=()=>{},e(),this._setPointerCapture=t;};return {injectEvent:(t,r)=>{e((()=>{this._onEventReceived(t,r);}));},disablePointerCapture:e}}};e$e([y$e({readOnly:!0})],l$d.prototype,"hasPendingInputs",null),e$e([y$e()],l$d.prototype,"eventSource",void 0),e$e([y$e()],l$d.prototype,"recognizers",void 0),e$e([y$e({readOnly:!0})],l$d.prototype,"latestPointerType",void 0),l$d=e$e([i$o("esri.views.input.InputManager")],l$d);class d$9{constructor(e,t,r,i,n){this.type=e,this.data=t,this.timestamp=r,this.modifiers=i,this.cancelable=n,this._propagationState=0,this._resumeCallback=null;}stopPropagation(){this._propagationState|=1;}shouldStopPropagation(){return 0!=(1&this._propagationState)}async(e){this._propagationState|=2;const t=(e,t)=>{this._propagationState&=-3;const r=this._resumeCallback;if(this._resumeCallback=null,r&&r(),t)throw e;return e};return ("function"==typeof e?e():e).then((e=>t(e,!1)),(e=>t(e,!0)))}shouldPausePropagation(e){return !!(2&this._propagationState)&&(this._resumeCallback=e,!0)}preventDefault(){this.data.native.preventDefault();}}const u$d={DEFAULT:0,TOOL:-1,WIDGET:-2,INTERNAL:-3};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const s$g={iconZoom:"esri-icon-zoom-in-magnifying-glass",iconTrash:"esri-icon-trash",iconBrowseClusteredFeatures:"esri-icon-table"},o$a=new c$w({id:"zoom-to-feature",title:"{messages.zoom}",className:s$g.iconZoom}),t$b=new c$w({id:"remove-selected-feature",title:"{messages.remove}",className:s$g.iconTrash}),r$a=new c$w({id:"zoom-to-clustered-features",title:"{messages.zoom}",className:s$g.iconZoom}),i$f=new c$w({id:"browse-clustered-features",title:"{messages.browseClusteredFeatures}",className:s$g.iconBrowseClusteredFeatures});

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const a$d="esri.widgets.Popup.PopupViewModel",s$f=n$v.getLogger(a$d),c$i=function(e){const{event:a,view:s}=e,{action:c}=a,u=s&&s.popup;if(!c)return Promise.reject(new s$n("trigger-action:missing-arguments","Event has no action"));if(!u)return Promise.reject(new s$n("trigger-action:missing-arguments","view.popup is missing"));const{disabled:d,id:w}=c;if(!w)return Promise.reject(new s$n("trigger-action:invalid-action","action.id is missing"));if(d)return Promise.reject(new s$n("trigger-action:invalid-action","Action is disabled"));if(w===o$a.id)return g$9(u.viewModel);if(w===r$a.id)return l$c(u.viewModel);if(u.viewModel.browseClusterEnabled=!1,w===i$f.id&&(u.featureMenuOpen=!0,u.viewModel.browseClusterEnabled=!0),w===t$b.id){u.close();const{selectedFeature:e}=u;if(!e)return Promise.reject(new s$n(`trigger-action:${t$b.id}`,"selectedFeature is required",{selectedFeature:e}));const{sourceLayer:r}=e;return r?r.remove(e):s.graphics.remove(e),Promise.resolve()}return Promise.resolve()};function u$c(e){const{selectedFeature:t,location:r,view:i}=e;if(!i)return null;if("3d"===i.type)return t||r;return e.get("selectedFeature.geometry")||r}function d$8(e,r){if("3d"!==(null==r?void 0:r.type)||!e||"esri.Graphic"!==e.declaredClass)return !0;const i=r.getViewForGraphic(e);if(i&&"whenGraphicBounds"in i){let r=!1;return i.whenGraphicBounds(e,{useViewElevation:!0}).then((e=>{r=!e||!e.boundingBox||e.boundingBox[0]===e.boundingBox[3]&&e.boundingBox[1]===e.boundingBox[4]&&e.boundingBox[2]===e.boundingBox[5];})).catch((()=>{const r=new s$n("zoom-to:invalid-graphic","Could not zoom to the location of the graphic.",{graphic:e});s$f.error(r);})),r}return !0}async function g$9(e){const{location:i,selectedFeature:o,view:n,zoomFactor:a}=e,c=u$c(e);if(!c){const e=new s$n("zoom-to:invalid-target-or-view","Cannot zoom to location without a target and view.",{target:c,view:n});return s$f.error(e),Promise.reject(e)}const g=n.scale/a,l=e.get("selectedFeature.geometry")||i,w=l&&"point"===l.type&&d$8(o,n);o$a.active=!0,o$a.disabled=!0,await e.view.goTo({target:c,scale:w?g:void 0}),o$a.active=!1,o$a.disabled=!1,e.zoomToLocation=null,w&&(e.location=l);}async function l$c(e){const{selectedFeature:r,view:o}=e;if("2d"!==(null==o?void 0:o.type)){const e=new s$n("zoomToCluster:invalid-view","View must be 2d MapView.",{view:o});throw s$f.error(e),e}if(!r.isAggregate){const e=new s$n("zoomToCluster:invalid-selectedFeature","Selected feature must represent an aggregate/cluster graphic.",{selectedFeature:r});throw s$f.error(e),e}const n=r.sourceLayer,a=await o.whenLayerView(n),c=a.createQuery();c.aggregateIds=[r.getObjectId()],r$a.active=!0,r$a.disabled=!0;const{extent:u}=await a.queryExtent(c);await o.goTo({target:u}),r$a.active=!1,r$a.disabled=!1;}async function w(e){const{selectedFeature:r,view:i}=e;if("2d"!==(null==i?void 0:i.type)){const e=new s$n("displayClusterExtent:invalid-view","View must be 2d MapView.",{view:i});throw s$f.error(e),e}if(!r.isAggregate){const e=new s$n("zoomToCluster:invalid-selectedFeature","Selected feature must represent an aggregate/cluster graphic.",{selectedFeature:r});throw s$f.error(e),e}const o=r.sourceLayer,n=await i.whenLayerView(o),a=n.createQuery();a.aggregateIds=[r.getObjectId()];const{extent:c}=await n.queryExtent(a);e.selectedClusterBoundaryFeature.geometry=c,i.graphics.add(e.selectedClusterBoundaryFeature);}async function v$1(e){const{selectedFeature:r,view:i}=e;if("2d"!==(null==i?void 0:i.type)){const e=new s$n("browseAggregateFeatures:invalid-view","View must be 2d MapView.",{view:i});throw s$f.error(e),e}if(!r.isAggregate){const e=new s$n("browseAggregateFeatures:invalid-selectedFeature","Selected feature must represent an aggregate/cluster graphic.",{selectedFeature:r});throw s$f.error(e),e}const n=r.sourceLayer,a=await i.whenLayerView(n),c=a.createQuery();c.aggregateIds=[r.getObjectId()],i$f.active=!0,i$f.disabled=!0;const{features:u}=await a.queryFeatures(c);i$f.active=!1,i$f.disabled=!1,e.features=[r].concat(u);}function p$k(e){e.features=e.features.filter((e=>e.isAggregate));}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const S$4=L$5.ofType({key:"type",defaultKeyValue:"button",base:c$x,typeMap:{button:c$w,toggle:a$o}}),B$2=()=>[o$a.clone()],R$1=()=>[r$a.clone(),i$f.clone()],G$2="esri.widgets.Popup.PopupViewModel",z$1=n$v.getLogger(G$2);let U$2=class extends(e$j(l$e)){constructor(e){super(e),this._handles=new u$j,this._pendingPromises=new Set,this._fetchFeaturesController=null,this._selectedClusterFeature=null,this.featurePage=null,this.featuresPerPage=20,this.actions=new S$4,this.defaultPopupTemplateEnabled=!1,this.autoCloseEnabled=!1,this.autoOpenEnabled=!0,this.browseClusterEnabled=!1,this.content=null,this.featureViewModels=[],this.highlightEnabled=!0,this.includeDefaultActions=!0,this.selectedClusterBoundaryFeature=new n$x({symbol:new u$o({outline:{width:1.5,color:"cyan"},style:"none"})}),this.title=null,this.updateLocationEnabled=!1,this.view=null,this.visible=!1,this.zoomFactor=4,this.zoomToLocation=null;}get isLoadingFeature(){return this.featureViewModels.some((e=>e.waitingForContent))}initialize(){this._handles.add([d$f(this,["autoOpenEnabled","view"],(()=>this._autoOpenEnabledChange())),this.on("view-change",(()=>this._autoClose())),h$g(this,["highlightEnabled","selectedFeature","visible","view"],(()=>this._highlightFeature())),h$g(this,"view.animation.state",(e=>this._animationStateChange(e))),h$g(this,"location",(e=>this._locationChange(e))),h$g(this,"selectedFeature",(e=>this._selectedFeatureChange(e))),h$g(this,["selectedFeatureIndex","featureCount","featuresPerPage"],(()=>this._selectedFeatureIndexChange())),h$g(this,["featurePage","selectedFeatureIndex","featureCount","featuresPerPage, featureViewModels"],(()=>this._setGraphicOnFeatureViewModels())),h$g(this,"featureViewModels",(()=>this._featureViewModelsChange())),this.on("trigger-action",(e=>c$i({event:e,view:this.view}))),O$5(this,"waitingForResult",(()=>this._waitingForResultChange())),h$g(this,["features","view","view.map","view.spatialReference"],(()=>this._updateFeatureVMs())),h$g(this,["view.scale"],this._viewScaleChange),O$5(this,"visible",(()=>this.browseClusterEnabled=!1)),h$g(this,"browseClusterEnabled",(e=>e?this.enableClusterBrowsing():this.disableClusterBrowsing()))]);}destroy(){this._cancelFetchingFeatures(),this._handles.destroy(),this._handles=null,this._pendingPromises.clear(),this.browseClusterEnabled=!1,this.view=null;}get active(){return !(!this.visible||this.waitingForResult)}get allActions(){const e=this._get("allActions")||new S$4;e.removeAll();const{actions:t,defaultActions:s,defaultPopupTemplateEnabled:i,includeDefaultActions:r,selectedFeature:o}=this,n=r?s.concat(t):t,a=o&&("function"==typeof o.getEffectivePopupTemplate&&o.getEffectivePopupTemplate(i)||o.popupTemplate),l=a&&a.actions,u=a&&a.overwriteActions?l:l?l.concat(n):n;return u&&u.filter(Boolean).forEach((t=>e.add(t))),e}get defaultActions(){var e;const t=this._get("defaultActions")||new S$4;return t.removeAll(),t.addMany(null!=(e=this.selectedFeature)&&e.isAggregate?R$1():B$2()),t}get featureCount(){return this.features.length}get features(){return this._get("features")||[]}set features(e){const t=e||[];this._set("features",t);const{pendingPromisesCount:s,promiseCount:i,selectedFeatureIndex:r}=this,o=i&&t.length;o&&s&&-1===r?this.selectedFeatureIndex=0:o&&-1!==r||(this.selectedFeatureIndex=t.length?0:-1);}get location(){return this._get("location")||null}set location(e){const t=this.get("view.spatialReference.isWebMercator");e&&e.get("spatialReference.isWGS84")&&t&&(e=d$j(e)),this._set("location",e);}get pendingPromisesCount(){return this._pendingPromises.size}get waitingForResult(){return !(!(!!this._fetchFeaturesController||this.pendingPromisesCount>0)||0!==this.featureCount)}get promiseCount(){return this.promises.length}get promises(){return this._get("promises")||[]}set promises(e){if(this._pendingPromises.clear(),this.features=[],!Array.isArray(e)||!e.length)return this._set("promises",[]),void this.notifyChange("pendingPromisesCount");this._set("promises",e),(e=e.slice(0)).forEach((e=>{this._pendingPromises.add(e);const t=t=>{this._pendingPromises.has(e)&&this._updateFeatures(t),this._updatePendingPromises(e);},s=()=>this._updatePendingPromises(e);e.then(t,s);})),this.notifyChange("pendingPromisesCount");}get selectedFeature(){const{features:e,selectedFeatureIndex:t}=this;if(-1===t)return null;return e[t]||null}get selectedFeatureIndex(){const e=this._get("selectedFeatureIndex");return "number"==typeof e?e:-1}set selectedFeatureIndex(e){const{featureCount:t}=this;e=isNaN(e)||e<-1||!t?-1:(e+t)%t,this._set("selectedFeatureIndex",e);}get selectedFeatureViewModel(){return this.featureViewModels[this.selectedFeatureIndex]||null}get state(){return this.get("view.ready")?"ready":"disabled"}centerAtLocation(){const{view:e}=this,t=u$c(this);if(!t){const s=new s$n("center-at-location:invalid-target-or-view","Cannot center at a location without a target and view.",{target:t,view:e});return z$1.error(s),Promise.reject(s)}return this.callGoTo({target:{target:t,scale:e.scale}})}clear(){this.set({promises:[],features:[],content:null,title:null,location:null});}fetchFeatures(e,t){const{view:s}=this;if(!s||!e){const t=new s$n("fetch-features:invalid-screenpoint-or-view","Cannot fetch features without a screenPoint and view.",{screenPoint:e,view:s});return z$1.error(t),Promise.reject(t)}return s.fetchPopupFeatures(e,{event:t&&t.event,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,signal:t&&t.signal})}open(e){const t={updateLocationEnabled:!1,promises:[],fetchFeatures:!1,...e,visible:!0},{fetchFeatures:s}=t;delete t.fetchFeatures,s&&this._setFetchFeaturesPromises(t.location),this.set(t);}triggerAction(e){const t=this.allActions.getItemAt(e);t&&!t.disabled&&this.emit("trigger-action",{action:t});}next(){return this.selectedFeatureIndex=this.selectedFeatureIndex+1,this}previous(){return this.selectedFeatureIndex=this.selectedFeatureIndex-1,this}disableClusterBrowsing(){p$k(this),this._clearBrowsedClusterGraphics();}async enableClusterBrowsing(){await w(this),await v$1(this);}_animationStateChange(e){this.zoomToLocation||(o$a.disabled="waiting-for-target"===e);}_clearBrowsedClusterGraphics(){var e;const t=null==(e=this.view)?void 0:e.graphics;t&&(t.remove(this.selectedClusterBoundaryFeature),t.remove(this._selectedClusterFeature)),this._selectedClusterFeature=null,this.selectedClusterBoundaryFeature.geometry=null;}_viewScaleChange(){var e;(null!=(e=this.selectedFeature)&&e.isAggregate||this.browseClusterEnabled)&&(this.browseClusterEnabled=!1,this.visible=!1);}_locationChange(e){const{selectedFeature:t,updateLocationEnabled:s}=this;s&&e&&(!t||t.geometry)&&this.centerAtLocation();}_selectedFeatureIndexChange(){this.featurePage=this.featureCount>1?Math.floor(this.selectedFeatureIndex/this.featuresPerPage)+1:null;}_featureViewModelsChange(){this.featurePage=this.featureCount>1?1:null;}_setGraphicOnFeatureViewModels(){const{features:e,featureCount:t,featurePage:s,featuresPerPage:i,featureViewModels:r}=this;if(null===s)return;const o=((s-1)*i+t)%t,n=o+i;r.slice(o,n).forEach(((t,s)=>{t&&!t.graphic&&(t.graphic=e[o+s]);}));}async _selectedFeatureChange(e){if(!e)return;const{location:s,updateLocationEnabled:i,view:r}=this;if(this.browseClusterEnabled){if(this._selectedClusterFeature&&(r.graphics.remove(this._selectedClusterFeature),this._selectedClusterFeature=null),e.isAggregate)return;return e.symbol=await f$5(e),this._selectedClusterFeature=e,void r.graphics.add(this._selectedClusterFeature)}!i&&s||!e.geometry?i&&!e.geometry&&this.centerAtLocation().then((()=>{this.location=r.center.clone();})):this.location=e$i(this._getPointFromGeometry(e.geometry));}_waitingForResultChange(){!this.featureCount&&this.promises&&(this.visible=!1);}_setFetchFeaturesPromises(e){return this._fetchFeaturesWithController(this._getScreenPoint(e||this.location)).then((e=>{const{clientOnlyGraphics:t,promisesPerLayerView:s}=e,i=Promise.resolve(t),r=s.map((e=>e.promise));this.promises=[i,...r];}))}_destroyFeatureVMs(){this.featureViewModels.forEach((e=>e&&!e.destroyed&&e.destroy())),this._set("featureViewModels",[]);}_updateFeatureVMs(){const{selectedFeature:e,features:t,featureViewModels:s}=this;if(null!=e&&e.isAggregate||(this.browseClusterEnabled=!1),this._destroyFeatureVMs(),!t||!t.length)return;const i=s.slice(0),r=[];t.forEach(((t,s)=>{if(!t)return;let o=null;if(i.some(((e,s)=>(e&&e.graphic===t&&(o=e,i.splice(s,1)),!!o))),o)r[s]=o;else {var n,a;const i=new k$2({defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,spatialReference:null==(n=this.view)?void 0:n.spatialReference,graphic:t===e?t:null,map:null==(a=this.view)?void 0:a.map,view:this.view});r[s]=i;}})),i.forEach((e=>e&&!e.destroyed&&e.destroy())),this._set("featureViewModels",r);}_getScreenPoint(e){const{view:t}=this;return t&&e&&"function"==typeof t.toScreen?t.toScreen(e):null}_autoOpenEnabledChange(){const e="auto-fetch-features",{_handles:t,autoOpenEnabled:s}=this;if(t.remove(e),s&&this.view){const s=this.view.on("click",(e=>{"mouse"===e.pointerType&&0!==e.button||this._fetchFeaturesAndOpen(e);}),u$d.WIDGET);t.add(s,e);}}_cancelFetchingFeatures(){const e=this._fetchFeaturesController;e&&e.abort(),this._fetchFeaturesController=null,this.notifyChange("waitingForResult");}_fetchFeaturesWithController(e,t){this._cancelFetchingFeatures();const s=a$m(),{signal:i}=s;this._fetchFeaturesController=s,this.notifyChange("waitingForResult");const r=this.fetchFeatures(e,{signal:i,event:t});return r.catch((()=>{})).then((()=>{this._fetchFeaturesController=null,this.notifyChange("waitingForResult");})),r}_fetchFeaturesAndOpen(e){const{screenPoint:t,mapPoint:s}=e,{view:i}=this;this._fetchFeaturesWithController(t,e).then((e=>{const{clientOnlyGraphics:t,promisesPerLayerView:r,location:o}=e,n=[Promise.resolve(t),...r.map((e=>e.promise))];return i.popup.open({location:o||s,promises:n}),e}));}_updatePendingPromises(e){e&&this._pendingPromises.has(e)&&(this._pendingPromises.delete(e),this.notifyChange("pendingPromisesCount"));}_autoClose(){this.autoCloseEnabled&&(this.visible=!1);}_getPointFromGeometry(e){return t$f(e)?null:"point"===e.type?e:"extent"===e.type?e.center:"polygon"===e.type?e.centroid:"multipoint"===e.type||"polyline"===e.type?e.extent.center:null}async _getLayerView(e,t){return await e.when(),e.whenLayerView(t)}async _highlightFeature(){const e="highlight";this._handles.remove(e);const{selectedFeature:t,highlightEnabled:s,view:i,visible:r}=this;if(!(t&&i&&s&&r))return;let{layer:o,sourceLayer:n}=t;if(!(o&&o instanceof b$8))return;"map-notes"===(null==n?void 0:n.type)&&(o=n);const a=this._getLayerView(i,o);this._highlightPromise=a;const l=await a;if(!(l&&e$k(l)&&this._highlightPromise===a&&this.selectedFeature&&this.highlightEnabled&&this.visible))return;const u="objectIdField"in o&&o.objectIdField,h=t.attributes,c=h&&u&&h[u],p=l.highlight(c||t);this._handles.add(p,e);}_updateFeatures(e){const{features:t}=this;if(!e||!e.length)return;if(!t.length)return void(this.features=e);const s=e.filter((e=>-1===t.indexOf(e)));this.features=t.concat(s);}};e$e([y$e()],U$2.prototype,"featurePage",void 0),e$e([y$e()],U$2.prototype,"featuresPerPage",void 0),e$e([y$e()],U$2.prototype,"isLoadingFeature",null),e$e([y$e({type:S$4})],U$2.prototype,"actions",void 0),e$e([y$e({readOnly:!0})],U$2.prototype,"active",null),e$e([y$e({readOnly:!0})],U$2.prototype,"allActions",null),e$e([y$e({type:Boolean})],U$2.prototype,"defaultPopupTemplateEnabled",void 0),e$e([y$e()],U$2.prototype,"autoCloseEnabled",void 0),e$e([y$e()],U$2.prototype,"autoOpenEnabled",void 0),e$e([y$e()],U$2.prototype,"browseClusterEnabled",void 0),e$e([y$e()],U$2.prototype,"content",void 0),e$e([y$e({type:S$4,readOnly:!0})],U$2.prototype,"defaultActions",null),e$e([y$e({readOnly:!0})],U$2.prototype,"featureCount",null),e$e([y$e()],U$2.prototype,"features",null),e$e([y$e({readOnly:!0})],U$2.prototype,"featureViewModels",void 0),e$e([y$e()],U$2.prototype,"highlightEnabled",void 0),e$e([y$e()],U$2.prototype,"includeDefaultActions",void 0),e$e([y$e({type:j$5})],U$2.prototype,"location",null),e$e([y$e({readOnly:!0})],U$2.prototype,"pendingPromisesCount",null),e$e([y$e({readOnly:!0})],U$2.prototype,"selectedClusterBoundaryFeature",void 0),e$e([y$e({readOnly:!0})],U$2.prototype,"waitingForResult",null),e$e([y$e({readOnly:!0})],U$2.prototype,"promiseCount",null),e$e([y$e()],U$2.prototype,"promises",null),e$e([y$e({value:null,readOnly:!0})],U$2.prototype,"selectedFeature",null),e$e([y$e({value:-1})],U$2.prototype,"selectedFeatureIndex",null),e$e([y$e({readOnly:!0})],U$2.prototype,"selectedFeatureViewModel",null),e$e([y$e({readOnly:!0})],U$2.prototype,"state",null),e$e([y$e()],U$2.prototype,"title",void 0),e$e([y$e()],U$2.prototype,"updateLocationEnabled",void 0),e$e([y$e()],U$2.prototype,"view",void 0),e$e([y$e()],U$2.prototype,"visible",void 0),e$e([y$e()],U$2.prototype,"zoomFactor",void 0),e$e([y$e()],U$2.prototype,"zoomToLocation",void 0),e$e([y$e()],U$2.prototype,"centerAtLocation",null),U$2=e$e([i$o(G$2)],U$2);var W$3=U$2;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const O$2="selected-index",N$2=0,E$3="popup-spinner",B$1={iconLeftTriangleArrow:"esri-icon-left-triangle-arrow",iconRightTriangleArrow:"esri-icon-right-triangle-arrow",iconDockToTop:"esri-icon-maximize",iconDockToBottom:"esri-icon-dock-bottom",iconDockToLeft:"esri-icon-dock-left",iconDockToRight:"esri-icon-dock-right",iconClose:"esri-icon-close",iconUndock:"esri-icon-minimize",iconCheckMark:"esri-icon-check-mark",iconLoading:"esri-icon-loading-indicator",iconDefaultAction:"esri-icon-default-action",iconActionsMenu:"esri-icon-handle-horizontal",rotating:"esri-rotating",base:"esri-popup",widget:"esri-widget",main:"esri-popup__main-container",loadingContainer:"esri-popup__loading-container",isCollapsible:"esri-popup--is-collapsible",isCollapsed:"esri-popup--is-collapsed",shadow:"esri-popup--shadow",isDocked:"esri-popup--is-docked",isDockedTopLeft:"esri-popup--is-docked-top-left",isDockedTopCenter:"esri-popup--is-docked-top-center",isDockedTopRight:"esri-popup--is-docked-top-right",isDockedBottomLeft:"esri-popup--is-docked-bottom-left",isDockedBottomCenter:"esri-popup--is-docked-bottom-center",isDockedBottomRight:"esri-popup--is-docked-bottom-right",alignTopCenter:"esri-popup--aligned-top-center",alignBottomCenter:"esri-popup--aligned-bottom-center",alignTopLeft:"esri-popup--aligned-top-left",alignBottomLeft:"esri-popup--aligned-bottom-left",alignTopRight:"esri-popup--aligned-top-right",alignBottomRight:"esri-popup--aligned-bottom-right",isFeatureMenuOpen:"esri-popup--feature-menu-open",isActionsMenuOpen:"esri-popup--actions-menu-open",hasFeatureUpdated:"esri-popup--feature-updated",header:"esri-popup__header",headerButtons:"esri-popup__header-buttons",headerContainer:"esri-popup__header-container",headerContainerButton:"esri-popup__header-container--button",headerTitle:"esri-popup__header-title",content:"esri-popup__content",footer:"esri-popup__footer",footerHasPagination:"esri-popup__footer--has-pagination",footerHasActions:"esri-popup__footer--has-actions",footerHasActionsMenu:"esri-popup__footer--has-actions-menu",button:"esri-popup__button",buttonDisabled:"esri-popup__button--disabled",buttonDock:"esri-popup__button--dock",icon:"esri-popup__icon",iconDock:"esri-popup__icon--dock-icon",inlineActionsContainer:"esri-popup__inline-actions-container",actionsMenuButton:"esri-popup__actions-menu-button",actions:"esri-popup__actions",action:"esri-popup__action",actionImage:"esri-popup__action-image",actionText:"esri-popup__action-text",actionToggle:"esri-popup__action-toggle",actionToggleOn:"esri-popup__action-toggle--on",pointer:"esri-popup__pointer",pointerDirection:"esri-popup__pointer-direction",navigation:"esri-popup__navigation",paginationPrevious:"esri-popup__pagination-previous",paginationNext:"esri-popup__pagination-next",paginationPreviousIconLTR:"esri-popup__pagination-previous-icon",paginationPreviousIconRTL:"esri-popup__pagination-previous-icon--rtl",paginationNextIconLTR:"esri-popup__pagination-next-icon",paginationNextIconRTL:"esri-popup__pagination-next-icon--rtl",featureMenu:"esri-popup__feature-menu",featureMenuList:"esri-popup__feature-menu-list",featureMenuItem:"esri-popup__feature-menu-item",featureMenuViewport:"esri-popup__feature-menu-viewport",featureMenuHeader:"esri-popup__feature-menu-header",featureMenuNote:"esri-popup__feature-menu-note",featureMenuSelected:"esri-popup__feature-menu-item--selected",featureMenuButton:"esri-popup__feature-menu-button",featureMenuTitle:"esri-popup__feature-menu-title",featureMenuObserver:"esri-popup__feature-menu-observer",featureMenuLoader:"esri-popup__feature-menu-loader",collapseButton:"esri-popup__collapse-button"},T$1={buttonEnabled:!0,position:"auto",breakpoint:{width:544}},D$1="esri-popup";function P$2(e,t){return void 0===t?`${D$1}__${e}`:`${D$1}__${e}-${t}`}const L$3="esri.widgets.Popup",S$3=n$v.getLogger(L$3),V$1={closeButton:!0,featureNavigation:!0};let R=class extends(i$l(L$7)){constructor(e,t){super(e,t),this._blurClose=!1,this._blurContainer=!1,this._containerNode=null,this._mainContainerNode=null,this._featureMenuNode=null,this._actionsMenuNode=null,this._focusClose=!1,this._focusContainer=!1,this._focusDockButton=!1,this._focusFeatureMenuButton=!1,this._focusActionsMenuButton=!1,this._focusFirstFeature=!1,this._focusFirstAction=!1,this._handles=new u$j,this._pointerOffsetInPx=16,this._spinner=null,this._feature=null,this._featureMenuIntersectionObserverCallback=([e])=>{null!=e&&e.isIntersecting&&this.viewModel.featurePage++;},this._featureMenuIntersectionObserver=new IntersectionObserver(this._featureMenuIntersectionObserverCallback),this._displaySpinnerThrottled=e$c((()=>this._displaySpinner()),N$2),this.actions=null,this.alignment="auto",this.autoCloseEnabled=null,this.autoOpenEnabled=null,this.defaultPopupTemplateEnabled=null,this.content=null,this.collapsed=!1,this.collapseEnabled=!0,this.dockEnabled=!1,this.featureCount=null,this.featureMenuOpen=!1,this.features=null,this.goToOverride=null,this.highlightEnabled=null,this.location=null,this.label=void 0,this.maxInlineActions=3,this.messages=null,this.messagesCommon=null,this.promises=null,this.selectedFeature=null,this.selectedFeatureIndex=null,this.spinnerEnabled=!0,this.title=null,this.updateLocationEnabled=null,this.view=null,this.viewModel=new W$3,this.visible=null,this.visibleElements={...V$1},this._addSelectedFeatureIndexHandle(),this.own([h$g(this,"viewModel.screenLocation",(()=>this._positionContainer())),h$g(this,["viewModel.active","dockEnabled"],(()=>this._toggleScreenLocationEnabled())),h$g(this,"viewModel.screenLocation",((e,t)=>{!!e!=!!t&&this.reposition();})),h$g(this,["viewModel.view.padding","viewModel.view.size","viewModel.active","viewModel.location","alignment"],(()=>this.reposition())),h$g(this,"spinnerEnabled",(e=>this._spinnerEnabledChange(e))),h$g(this,"viewModel.view.size",((e,t)=>this._updateDockEnabledForViewSize(e,t))),h$g(this,"viewModel.view",((e,t)=>this._viewChange(e,t))),h$g(this,"viewModel.view.ready",((e,t)=>this._viewReadyChange(e,t))),h$g(this,["viewModel.waitingForResult","viewModel.location"],(()=>{this._hideSpinner(),this._displaySpinnerThrottled();})),h$g(this,"selectedFeatureWidget.viewModel.title",(e=>this._setTitleFromFeatureWidget(e))),h$g(this,["selectedFeatureWidget.viewModel.content","selectedFeatureWidget.viewModel.waitingForContent"],(()=>this._setContentFromFeatureWidget())),O$5(this,"collapsed",(()=>{var e,t;"xsmall"===(null==(e=this.viewModel)||null==(t=e.view)?void 0:t.widthBreakpoint)&&this.viewModel.active&&this.collapseEnabled&&this.viewModel.centerAtLocation();})),C$7(this,"viewModel.allActions","change",(()=>this._watchActions())),d$f(this,"viewModel.allActions",(()=>this._watchActions())),h$g(this,"viewModel.featureViewModels",(()=>this._featureMenuViewportScrollTop()))]);}destroy(){var e,t;this._destroySelectedFeatureWidget(),this._destroySpinner(),null==(e=this._handles)||e.destroy(),this._unobserveFeatureMenuObserver(),null==(t=this._featureMenuIntersectionObserver)||t.disconnect(),this._handles=null;}get actionsMenuId(){return `${this.id}-actions-menu`}get actionsMenuButtonId(){return `${this.id}-actions-menu-button`}get featureMenuId(){return `${this.id}-feature-menu`}get titleId(){return `${this.id}-popup-title`}get contentId(){return `${this.id}-popup-content`}get hasContent(){var e,t,i,o,n;return !!(this.selectedFeatureWidget?(null==(e=this.selectedFeatureWidget)||null==(t=e.viewModel)?void 0:t.waitingForContent)||(null==(i=this.selectedFeatureWidget)||null==(o=i.viewModel)?void 0:o.content):null==(n=this.viewModel)?void 0:n.content)}get featureNavigationVisible(){return this.viewModel.active&&this.viewModel.featureCount>1&&this.visibleElements.featureNavigation}get collapsible(){return !!(this.collapseEnabled&&this.viewModel.title&&this.hasContent)}get featureMenuVisible(){return this.featureNavigationVisible&&this.featureMenuOpen}get contentCollapsed(){return this.collapsible&&!this.featureMenuVisible&&this.collapsed}get dividedActions(){return this._divideActions()}set actionsMenuOpen(e){this._set("actionsMenuOpen",!!e);}get actionsMenuOpen(){return !!this.viewModel.active&&this._get("actionsMenuOpen")}get currentAlignment(){return this._getCurrentAlignment()}get currentDockPosition(){return this._getCurrentDockPosition()}get dockOptions(){return this._get("dockOptions")||T$1}set dockOptions(e){const t={...T$1},i=this.get("viewModel.view.breakpoints"),o={};i&&(o.width=i.xsmall,o.height=i.xsmall);const n={...t,...e},s={...t.breakpoint,...o},{breakpoint:r}=n;!0===r?n.breakpoint=s:"object"==typeof r&&(n.breakpoint={...s,...r}),this._set("dockOptions",n),this._setCurrentDockPosition(),this.reposition();}set featureNavigationEnabled(e){r$g(S$3,"featureNavigationEnabled",{replacement:"visibleElements.featureNavigation",version:"4.15"}),this.visibleElements={...this.visibleElements,featureNavigation:e};}get selectedFeatureWidget(){const{_feature:e,visibleElements:t}=this,{selectedFeatureViewModel:i}=this.viewModel,o={...t,title:!1};return i?(e?(e.viewModel=i,e.visibleElements=o):this._feature=new _$4({viewModel:i,visibleElements:o}),this._feature):null}castVisibleElements(e){return {...V$1,...e}}blur(){const{active:e}=this.viewModel;e||S$3.warn("Popup can only be blurred when currently active."),this.visibleElements.closeButton?this._blurClose=!0:this._blurContainer=!0,this.scheduleRender();}clear(){this.viewModel.clear();}close(){this.visible=!1;}fetchFeatures(e,t){return this.viewModel.fetchFeatures(e,t)}focus(){const{active:e}=this.viewModel;e||S$3.warn("Popup can only be focused when currently active."),this.visibleElements.closeButton?this._focusClose=!0:this._focusContainer=!0,this.scheduleRender();}next(){return this.viewModel.next()}open(e){var t,i;this._handles.remove(O$2);const o=!!e&&!!e.featureMenuOpen,n=!!e&&!!e.actionsMenuOpen,s={collapsed:!!e&&!!e.collapsed,actionsMenuOpen:n,featureMenuOpen:o};"xsmall"===(null==(t=this.viewModel)||null==(i=t.view)?void 0:i.widthBreakpoint)&&(s.collapsed=!0),this.set(s),this.viewModel.open(e),this._addSelectedFeatureIndexHandle();}previous(){return this.viewModel.previous()}reposition(){this.renderNow(),this._positionContainer(),this._setCurrentAlignment();}triggerAction(e){this.viewModel.triggerAction(e);}render(){var e,t,i,o;const{actionsMenuOpen:n,dockEnabled:s,featureMenuVisible:r,dividedActions:a,currentAlignment:l,currentDockPosition:u}=this,{active:c}=this.viewModel,{menuActions:d}=a,p=c&&d.length>1&&n,h=c&&s,g=c&&!s,_=null==(e=this.selectedFeature)||null==(t=e.layer)?void 0:t.title,f=null==(i=this.selectedFeature)||null==(o=i.layer)?void 0:o.id,v={[B$1.alignTopCenter]:"top-center"===l,[B$1.alignBottomCenter]:"bottom-center"===l,[B$1.alignTopLeft]:"top-left"===l,[B$1.alignBottomLeft]:"bottom-left"===l,[B$1.alignTopRight]:"top-right"===l,[B$1.alignBottomRight]:"bottom-right"===l,[B$1.isDocked]:h,[B$1.shadow]:g,[B$1.isDockedTopLeft]:"top-left"===u,[B$1.isDockedTopCenter]:"top-center"===u,[B$1.isDockedTopRight]:"top-right"===u,[B$1.isDockedBottomLeft]:"bottom-left"===u,[B$1.isDockedBottomCenter]:"bottom-center"===u,[B$1.isDockedBottomRight]:"bottom-right"===u,[B$1.isFeatureMenuOpen]:r,[B$1.isActionsMenuOpen]:p};return o$i("div",{class:this.classes(B$1.base,v),role:"presentation","data-layer-title":_,"data-layer-id":f,bind:this,afterCreate:this._positionContainer,afterUpdate:this._positionContainer},c?[this.renderMainContainer(),this.renderPointer()]:null)}renderLoadingIcon(){return o$i("span",{"aria-hidden":"true",class:this.classes(B$1.icon,B$1.iconLoading,B$1.rotating)})}renderNavigationLoading(){const{messagesCommon:e}=this;return this.viewModel.pendingPromisesCount?o$i("div",{key:P$2("loading-container"),role:"presentation",class:B$1.loadingContainer,"aria-label":e.loading,title:e.loading},this.renderLoadingIcon()):null}renderPreviousIcon(){const e=d$i(),t={[B$1.iconRightTriangleArrow]:e,[B$1.paginationPreviousIconRTL]:e,[B$1.iconLeftTriangleArrow]:!e,[B$1.paginationPreviousIconLTR]:!e};return o$i("span",{"aria-hidden":"true",class:this.classes(B$1.icon,t)})}renderPreviousButton(){const{messages:e}=this;return o$i("div",{role:"button",tabIndex:0,bind:this,onclick:this._previous,onkeydown:this._previous,class:this.classes(B$1.button,B$1.paginationPrevious),"aria-label":e.previous,title:e.previous},this.renderPreviousIcon())}renderNextIcon(){const e=d$i(),t={[B$1.iconLeftTriangleArrow]:e,[B$1.paginationNextIconRTL]:e,[B$1.iconRightTriangleArrow]:!e,[B$1.paginationNextIconLTR]:!e};return o$i("span",{"aria-hidden":"true",class:this.classes(B$1.icon,t)})}renderNextButton(){const{messages:e}=this;return o$i("div",{role:"button",tabIndex:0,bind:this,onclick:this._next,onkeydown:this._next,class:this.classes(B$1.button,B$1.paginationNext),"aria-label":e.next,title:e.next},this.renderNextIcon())}renderFeatureMenuButton(){const{featureMenuOpen:e,featureMenuId:t,messagesCommon:i}=this,{featureCount:o,selectedFeatureIndex:n}=this.viewModel;return o$i("div",{role:"button",tabIndex:0,bind:this,onclick:this._toggleFeatureMenu,onkeydown:this._toggleFeatureMenu,afterCreate:this._focusFeatureMenuButtonNode,afterUpdate:this._focusFeatureMenuButtonNode,class:this.classes(B$1.button,B$1.featureMenuButton),"aria-haspopup":"true","aria-controls":t,"aria-expanded":e.toString(),"aria-label":i.menu,title:i.menu},this._getPageText(o,n))}renderNavigationButtons(){return this.featureNavigationVisible?[this.renderPreviousButton(),this.renderNavigationLoading()||this.renderFeatureMenuButton(),this.renderNextButton()]:null}renderDockIcon(){const{dockEnabled:e}=this,t=this._wouldDockTo(),i={[B$1.iconUndock]:e,[B$1.iconDock]:!e,[B$1.iconDockToRight]:!e&&("top-right"===t||"bottom-right"===t),[B$1.iconDockToLeft]:!e&&("top-left"===t||"bottom-left"===t),[B$1.iconDockToTop]:!e&&"top-center"===t,[B$1.iconDockToBottom]:!e&&"bottom-center"===t};return o$i("span",{"aria-hidden":"true",class:this.classes(i,B$1.icon)})}renderDockButton(){var e,t,i;const{dockEnabled:o,messages:n}=this,s=null==(e=this.viewModel)||null==(t=e.view)?void 0:t.widthBreakpoint,r=o?n.undock:n.dock;return "xsmall"!==s&&null!=(i=this.dockOptions)&&i.buttonEnabled?o$i("div",{role:"button","aria-label":r,title:r,tabIndex:0,bind:this,onclick:this._toggleDockEnabled,onkeydown:this._toggleDockEnabled,afterCreate:this._focusDockButtonNode,afterUpdate:this._focusDockButtonNode,class:this.classes(B$1.button,B$1.buttonDock)},this.renderDockIcon()):null}renderTitle(){const{title:e}=this.viewModel,{titleId:t,collapsible:i,contentCollapsed:o,messagesCommon:n}=this,s={[B$1.headerContainerButton]:i},r=o$i("h2",{class:B$1.headerTitle,innerHTML:e}),a=i?o$i("button",{key:`${e}--collapsible`,id:t,title:o?n.expand:n.collapse,bind:this,enterAnimation:this._createFeatureUpdatedAnimation(),class:this.classes(B$1.headerContainer,s),"aria-expanded":o?"false":"true",onclick:this._toggleCollapsed},r):o$i("div",{key:e,id:t,bind:this,enterAnimation:this._createFeatureUpdatedAnimation(),class:this.classes(B$1.headerContainer,s)},r);return e?a:null}renderCloseIcon(){return o$i("span",{"aria-hidden":"true",class:this.classes(B$1.icon,B$1.iconClose)})}renderCloseButton(){const{visibleElements:e,messagesCommon:t}=this;return e.closeButton?o$i("div",{role:"button",tabIndex:0,bind:this,onclick:this._close,onkeydown:this._close,class:B$1.button,"aria-label":t.close,title:t.close,afterCreate:this._closeButtonNodeUpdated,afterUpdate:this._closeButtonNodeUpdated},this.renderCloseIcon()):null}renderHeader(){return o$i("header",{class:B$1.header},this.renderTitle(),o$i("div",{class:B$1.headerButtons},this.renderDockButton(),this.renderCloseButton()))}renderContentContainer(){const{contentId:e,hasContent:t,contentCollapsed:i}=this,{content:o}=this.viewModel;return t&&!i?o$i("article",{key:o,enterAnimation:this._createFeatureUpdatedAnimation(),id:e,class:B$1.content},this.renderContent()):null}renderActionsMenuButton(){const{actionsMenuId:e,actionsMenuButtonId:t,actionsMenuOpen:i,dividedActions:o,messagesCommon:n}=this,s=i?n.close:n.open,{menuActions:r}=o;return r.length?o$i("div",{key:P$2("actions-menu-button"),class:this.classes(B$1.button,B$1.actionsMenuButton),role:"button",id:t,"aria-haspopup":"true","aria-controls":i?e:null,tabIndex:0,bind:this,onclick:this._toggleActionsMenu,onkeydown:this._toggleActionsMenu,afterCreate:this._focusActionsMenuButtonNode,afterUpdate:this._focusActionsMenuButtonNode,"aria-label":s,title:s},o$i("span",{"aria-hidden":"true",class:B$1.iconActionsMenu})):null}renderMenuActions(){const{actionsMenuId:e,actionsMenuButtonId:t,actionsMenuOpen:i,dividedActions:o}=this,{menuActions:n,inlineActions:s}=o;return n.length&&i?o$i("ul",{id:e,role:"menu","aria-labelledby":t,key:P$2("actions"),class:B$1.actions,bind:this,onkeyup:this._handleActionMenuKeyup,afterCreate:this._actionsMenuNodeUpdated,afterUpdate:this._actionsMenuNodeUpdated},n.toArray().map(((e,t)=>this.renderAction({action:e,index:t+s.length,type:"menu-item"})))):null}renderInlineActions(){const{inlineActions:e}=this.dividedActions;return !!e.length&&e.toArray().map(((e,t)=>this.renderAction({action:e,index:t,type:"inline"})))}renderInlineActionsContainer(){const{inlineActions:e,menuActions:t}=this.dividedActions,i=!!e.length,o=!!t.length;return i||o?o$i("div",{key:"inline-actions-container","data-inline-actions":i.toString(),"data-menu-actions":o.toString(),class:B$1.inlineActionsContainer},this.renderInlineActions(),this.renderActionsMenuButton(),this.renderMenuActions()):null}renderNavigation(){return this.featureNavigationVisible?o$i("section",{key:P$2("navigation"),class:this.classes(B$1.navigation)},this.renderNavigationButtons()):null}renderFooter(){const{featureNavigationVisible:e,dividedActions:t}=this,{inlineActions:i,menuActions:o}=t,n=!!i.length,s=!!o.length,r={[B$1.footerHasPagination]:e,[B$1.footerHasActions]:n,[B$1.footerHasActionsMenu]:s};return e||n?o$i("div",{key:P$2("feature-buttons"),class:this.classes(B$1.footer,r)},this.renderInlineActionsContainer(),this.renderNavigation()):null}renderFeatureMenuContainer(){const{messages:e}=this,{featureViewModels:t,isLoadingFeature:i}=this.viewModel,o=s$o(e.selectedFeatures,{total:t.length});return o$i("section",{key:P$2("menu"),class:B$1.featureMenu},o$i("h2",{class:B$1.featureMenuHeader},o),o$i("nav",{bind:this,class:B$1.featureMenuViewport,"data-node-ref":"_featureMenuViewportNode",afterCreate:p$y},this.renderFeatureMenu(),o$i("div",{class:B$1.featureMenuObserver,bind:this,afterCreate:this._featureMenuIntersectionObserverCreated}),i?o$i("div",{class:B$1.featureMenuLoader},this.renderLoadingIcon()):null))}renderPointer(){return this.dockEnabled?null:o$i("div",{key:P$2("pointer"),class:B$1.pointer,role:"presentation"},o$i("div",{class:this.classes(B$1.pointerDirection,B$1.shadow)}))}renderMainContainer(){const{dockEnabled:e,currentAlignment:t,currentDockPosition:i,titleId:o,contentId:n,collapsible:s,hasContent:r,contentCollapsed:a,visibleElements:l}=this,{title:u}=this.viewModel,c="bottom-left"===t||"bottom-center"===t||"bottom-right"===t||"top-left"===i||"top-center"===i||"top-right"===i,d="top-left"===t||"top-center"===t||"top-right"===t||"bottom-left"===i||"bottom-center"===i||"bottom-right"===i,p={[B$1.shadow]:e,[B$1.isCollapsible]:s,[B$1.isCollapsed]:a};return o$i("div",{class:this.classes(B$1.main,B$1.widget,p),tabIndex:l.closeButton?null:-1,role:"dialog","aria-labelledby":u?o:"","aria-describedby":r&&!a?n:"",bind:this,onkeyup:this._handleMainKeyup,afterCreate:this._mainContainerNodeUpdated,afterUpdate:this._mainContainerNodeUpdated},c?this.renderFooter():null,c?this.renderFeatureMenuContainer():null,this.renderHeader(),this.renderContentContainer(),d?this.renderFooter():null,d?this.renderFeatureMenuContainer():null)}renderContent(){var e;const t=null==(e=this.viewModel)?void 0:e.content;return t?"string"==typeof t?o$i("div",{key:t,innerHTML:t}):this.renderNodeContent(t):null}renderActionText(e){return o$i("span",{key:"text",class:B$1.actionText},e)}renderActionIcon(e){const t=this._getActionClass(e),i=this._getActionImage(e),o={[B$1.iconLoading]:e.active,[B$1.rotating]:e.active,[B$1.icon]:!!t,[B$1.actionImage]:!e.active&&!!i};return t&&(o[t]=!e.active),o$i("span",{key:"icon","aria-hidden":"true",class:this.classes(B$1.icon,o),styles:this._getIconStyles(i)})}renderAction(e){const{action:t,index:i,type:o}=e,n=this._getActionTitle(t),s={[B$1.action]:"toggle"!==t.type,[B$1.actionToggle]:"toggle"===t.type,[B$1.actionToggleOn]:"toggle"===t.type&&t.value,[B$1.buttonDisabled]:t.disabled},r=[this.renderActionIcon(t),this.renderActionText(n)],a="menu-item"===o?o$i("li",{key:t.uid,role:"menuitem",tabIndex:0,title:n,"aria-label":n,class:this.classes(B$1.button,s),onkeyup:this._handleActionMenuItemKeyup,bind:this,"data-action-index":i,onclick:this._triggerAction,onkeydown:this._triggerAction},r):o$i("div",{key:t.uid,role:"button",tabIndex:0,title:n,"aria-label":n,class:this.classes(B$1.button,s),onkeyup:this._handleActionMenuItemKeyup,bind:this,"data-action-index":i,onclick:this._triggerAction,onkeydown:this._triggerAction},r);return t.visible?a:null}renderFeatureMenuItem(e,t){const{messages:i,messagesCommon:o}=this,{selectedFeatureIndex:n,selectedFeatureViewModel:s}=this.viewModel,r=e===s,a={[B$1.featureMenuSelected]:r},l=r?o$i("span",{key:P$2(`feature-menu-selected-feature-${n}`),title:i.selectedFeature,"aria-label":i.selectedFeature,class:B$1.iconCheckMark}):null,u=o$i("span",{innerHTML:e.title||o.untitled});return o$i("li",{role:"menuitem",tabIndex:-1,key:P$2(`feature-menu-feature-${n}`),class:this.classes(a,B$1.featureMenuItem),bind:this,"data-feature-index":t,onkeyup:this._handleFeatureMenuItemKeyup,onclick:this._selectFeature,onkeydown:this._selectFeature},o$i("span",{class:B$1.featureMenuTitle},u,l))}renderFeatureMenu(){const{featureMenuId:e}=this,{featureViewModels:t}=this.viewModel;return t.length>1?o$i("ol",{class:B$1.featureMenuList,id:e,bind:this,afterCreate:this._featureMenuNodeUpdated,afterUpdate:this._featureMenuNodeUpdated,onkeyup:this._handleFeatureMenuKeyup,role:"menu"},t.filter((e=>!!e.graphic)).map(((e,t)=>this.renderFeatureMenuItem(e,t)))):null}_getActionTitle(e){const{messages:t,selectedFeature:i,messagesCommon:o}=this,{id:n}=e,s=null==i?void 0:i.attributes,r="zoom-to-feature"===n?s$o(e.title,{messages:t}):"remove-selected-feature"===n?s$o(e.title,{messages:o}):"zoom-to-clustered-features"===n||"browse-clustered-features"===n?s$o(e.title,{messages:t}):e.title;return r&&s?s$o(r,s):r}_getActionClass(e){const{selectedFeature:t}=this,i=null==t?void 0:t.attributes,{className:o,image:n}=e,s=n||o?o:B$1.iconDefaultAction;return s&&i?s$o(s,i):s}_getActionImage(e){const{selectedFeature:t}=this,i=null==t?void 0:t.attributes,{image:o}=e;return o&&i?s$o(o,i):o}_createFeatureUpdatedAnimation(){return g$f("enter",B$1.hasFeatureUpdated)}_getInlineActionCount(){const{maxInlineActions:e,featureNavigationVisible:t}=this;if("number"!=typeof e)return null;const i=Math.round(e);return Math.max(t?i-1:i,0)}_watchActions(){const{allActions:e}=this.viewModel;this.notifyChange("dividedActions");const t="actions";this._handles.remove(t),e&&e.forEach((e=>{this._handles.add(h$g(e,["active","className","disabled","id","title","image","visible"],(()=>this.scheduleRender())),t);}));}_divideActions(){const{allActions:e}=this.viewModel,t=this._getInlineActionCount(),i=null===t,o=0===t;return {inlineActions:i?e.slice(0):o?new L$5:e.slice(0,t),menuActions:i?new L$5:o?e.slice(0):e.slice(t)}}_featureMenuOpenChanged(e){e?this._focusFirstFeature=!0:this._focusFeatureMenuButton=!0;}_actionsMenuOpenChanged(e){e?this._focusFirstAction=!0:this._focusActionsMenuButton=!0;}_setTitleFromFeatureWidget(e){const{selectedFeatureWidget:t}=this;t&&(this.viewModel.title=e||"");}_setContentFromFeatureWidget(){const{selectedFeatureWidget:e}=this;e&&(this.viewModel.content=e);}_unobserveFeatureMenuObserver(){this._featureMenuIntersectionObserverNode&&this._featureMenuIntersectionObserver.unobserve(this._featureMenuIntersectionObserverNode);}_featureMenuIntersectionObserverCreated(e){this._unobserveFeatureMenuObserver(),this._featureMenuIntersectionObserver.observe(e),this._featureMenuIntersectionObserverNode=e;}_handleFeatureMenuKeyup(e){"Escape"===i$r(e)&&(e.stopPropagation(),this._focusFeatureMenuButton=!0,this.featureMenuOpen=!1,this.scheduleRender());}_handleActionMenuKeyup(e){"Escape"===i$r(e)&&(e.stopPropagation(),this._focusActionsMenuButton=!0,this.actionsMenuOpen=!1,this.scheduleRender());}_handleFeatureMenuItemKeyup(e){const t=i$r(e),{_featureMenuNode:i}=this,o=e.currentTarget["data-feature-index"];if(!i)return;const n=i.querySelectorAll("li"),s=n.length;if("ArrowUp"!==t)if("ArrowDown"!==t)if("Home"!==t)if("End"!==t);else {e.stopPropagation();n[n.length-1].focus();}else {e.stopPropagation();n[0].focus();}else {e.stopPropagation();n[(o+1+s)%s].focus();}else {e.stopPropagation();n[(o-1+s)%s].focus();}}_handleActionMenuItemKeyup(e){const t=i$r(e),{_actionsMenuNode:i}=this,o=e.currentTarget["data-action-index"];if(!i)return;const n=i.querySelectorAll("li"),s=n.length;if("ArrowUp"!==t)if("ArrowDown"!==t)if("Home"!==t)if("End"!==t);else {e.stopPropagation();n[n.length-1].focus();}else {e.stopPropagation();n[0].focus();}else {e.stopPropagation();n[(o+1+s)%s].focus();}else {e.stopPropagation();n[(o-1+s)%s].focus();}}_handleMainKeyup(e){const t=i$r(e);"ArrowLeft"===t&&(e.stopPropagation(),this.previous()),"ArrowRight"===t&&(e.stopPropagation(),this.next());}_spinnerEnabledChange(e){if(this._destroySpinner(),!e)return;const t=this.get("viewModel.view");this._createSpinner(t);}_hideSpinner(){const{_spinner:e}=this;e&&(e.location=null,e.hide());}_displaySpinner(){const{_spinner:e}=this;if(!e)return;const{location:t,waitingForResult:i}=this.viewModel;i?e.show({location:t}):e.hide();}_getIconStyles(e){return {"background-image":e?`url(${e})`:""}}_addSelectedFeatureIndexHandle(){const e=h$g(this,"viewModel.selectedFeatureIndex",((e,t)=>this._selectedFeatureIndexUpdated(e,t)));this._handles.add(e,O$2);}_selectedFeatureIndexUpdated(e,t){const{featureCount:i}=this;i&&e!==t&&-1!==e&&(this.actionsMenuOpen=!1,this.featureMenuOpen=!1);}_destroySelectedFeatureWidget(){const{_feature:e}=this;e&&(e.viewModel=null,e&&!e.destroyed&&e.destroy()),this._feature=null;}_isScreenLocationWithinView(e,t){return e.x>-1&&e.y>-1&&e.x<=t.width&&e.y<=t.height}_isOutsideView(e){const{popupHeight:t,popupWidth:i,screenLocation:o,side:n,view:s}=e;if(isNaN(i)||isNaN(t)||!s||!o)return !1;const r=s.padding;return "right"===n&&o.x+i/2>s.width-r.right||("left"===n&&o.x-i/2<r.left||("top"===n&&o.y-t<r.top||"bottom"===n&&o.y+t>s.height-r.bottom))}_calculateAutoAlignment(e){if("auto"!==e)return e;const{_pointerOffsetInPx:i,_containerNode:o,_mainContainerNode:n,viewModel:s}=this,{screenLocation:r,view:a}=s;if(t$f(r)||!a||!o)return "top-center";if(!this._isScreenLocationWithinView(r,a))return this._get("currentAlignment")||"top-center";function l(e){return parseInt(e.replace(/[^-\d\.]/g,""),10)}const u=n?window.getComputedStyle(n,null):null,c=u?l(u.getPropertyValue("max-height")):0,d=u?l(u.getPropertyValue("height")):0,{height:p,width:h}=o.getBoundingClientRect(),g=h+i,_=Math.max(p,c,d)+i,f=this._isOutsideView({popupHeight:_,popupWidth:g,screenLocation:r,side:"right",view:a}),v=this._isOutsideView({popupHeight:_,popupWidth:g,screenLocation:r,side:"left",view:a}),m=this._isOutsideView({popupHeight:_,popupWidth:g,screenLocation:r,side:"top",view:a}),b=this._isOutsideView({popupHeight:_,popupWidth:g,screenLocation:r,side:"bottom",view:a});return v?m?"bottom-right":"top-right":f?m?"bottom-left":"top-left":m?b?"top-center":"bottom-center":"top-center"}_callCurrentAlignment(e){return "function"==typeof e?e.call(this):e}_getCurrentAlignment(){const{alignment:e,dockEnabled:t}=this;return t||!this.viewModel.active?null:this._calculatePositionResult(this._calculateAutoAlignment(this._callCurrentAlignment(e)))}_setCurrentAlignment(){this._set("currentAlignment",this._getCurrentAlignment());}_setCurrentDockPosition(){this._set("currentDockPosition",this._getCurrentDockPosition());}_calculatePositionResult(e){const t=["left","right"];return d$i()&&t.reverse(),e.replace(/leading/gi,t[0]).replace(/trailing/gi,t[1])}_callDockPosition(e){return "function"==typeof e?e.call(this):e}_getDockPosition(){var e;return this._calculatePositionResult(this._calculateAutoDockPosition(this._callDockPosition(null==(e=this.dockOptions)?void 0:e.position)))}_getCurrentDockPosition(){return this.dockEnabled&&this.viewModel.active?this._getDockPosition():null}_wouldDockTo(){return this.dockEnabled?null:this._getDockPosition()}_calculateAutoDockPosition(e){var t;if("auto"!==e)return e;const i=null==(t=this.viewModel)?void 0:t.view,o=d$i()?"top-left":"top-right";if(!i)return o;const n=i.padding||{left:0,right:0,top:0,bottom:0},s=i.width-n.left-n.right,{breakpoints:r}=i;return r&&s<=r.xsmall?"bottom-center":o}_positionContainer(e=this._containerNode){if(e&&(this._containerNode=e),!e)return;const{screenLocation:t}=this.viewModel,{width:i}=e.getBoundingClientRect(),o=this._calculatePositionStyle(t,i);o&&(e.style.top=o.top,e.style.left=o.left,e.style.bottom=o.bottom,e.style.right=o.right);}_calculateFullWidth(e){const{currentAlignment:t,_pointerOffsetInPx:i}=this;return "top-left"===t||"bottom-left"===t||"top-right"===t||"bottom-right"===t?e+i:e}_calculateAlignmentPosition(e,t,i,o){const{currentAlignment:n,_pointerOffsetInPx:s}=this,r=o/2,a=i.height-t,l=i.width-e,{padding:u}=this.view;return "bottom-center"===n?{top:t+s-u.top,left:e-r-u.left}:"top-left"===n?{bottom:a+s-u.bottom,right:l+s-u.right}:"bottom-left"===n?{top:t+s-u.top,right:l+s-u.right}:"top-right"===n?{bottom:a+s-u.bottom,left:e+s-u.left}:"bottom-right"===n?{top:t+s-u.top,left:e+s-u.left}:"top-center"===n?{bottom:a+s-u.bottom,left:e-r-u.left}:void 0}_calculatePositionStyle(e,i){const{dockEnabled:o,view:n}=this;if(!n)return;if(o)return {left:"",top:"",right:"",bottom:""};if(t$f(e)||!i)return;const s=this._calculateFullWidth(i),r=this._calculateAlignmentPosition(e.x,e.y,n,s);return r?{top:void 0!==r.top?`${r.top}px`:"auto",left:void 0!==r.left?`${r.left}px`:"auto",bottom:void 0!==r.bottom?`${r.bottom}px`:"auto",right:void 0!==r.right?`${r.right}px`:"auto"}:void 0}_viewChange(e,t){e&&t&&(this.close(),this.clear());}_viewReadyChange(e,t){if(e){const e=this.get("viewModel.view");this._wireUpView(e);}else t&&(this.close(),this.clear());}_wireUpView(e){if(this._destroySpinner(),!e)return;const{spinnerEnabled:t}=this;t&&this._createSpinner(e),this._setDockEnabledForViewSize(this.dockOptions);}_dockingThresholdCrossed(e,t,i){const[o,n]=e,[s,r]=t,{width:a,height:l}=i;return o<=a&&s>a||o>a&&s<=a||n<=l&&r>l||n>l&&r<=l}_updateDockEnabledForViewSize(e,t){if(!e||!t)return;const i=this.get("viewModel.view.padding")||{left:0,right:0,top:0,bottom:0},o=i.left+i.right,n=i.top+i.bottom,s=[],r=[];s[0]=e[0]-o,s[1]=e[1]-n,r[0]=t[0]-o,r[1]=t[1]-n;const{dockOptions:a}=this,l=a.breakpoint;this._dockingThresholdCrossed(s,r,l)&&this._setDockEnabledForViewSize(a),this._setCurrentDockPosition();}_focusDockButtonNode(e){this._focusDockButton&&(this._focusDockButton=!1,e.focus());}_closeButtonNodeUpdated(e){return this._focusClose?(this._focusClose=!1,void e.focus()):this._blurClose?(this._blurClose=!1,void e.blur()):void 0}_mainContainerNodeUpdated(e){return this._mainContainerNode=e,this._focusContainer?(this._focusContainer=!1,void e.focus()):this._blurContainer?(this._blurContainer=!1,void e.blur()):void 0}_featureMenuNodeUpdated(e){if(this._featureMenuNode=e,!e||!this._focusFirstFeature)return;this._focusFirstFeature=!1;const t=e.querySelectorAll("li");if(t.length){t[0].focus();}}_actionsMenuNodeUpdated(e){if(this._actionsMenuNode=e,!e||!this._focusFirstAction)return;this._focusFirstAction=!1;const t=e.querySelectorAll("li");if(t.length){t[0].focus();}}_focusFeatureMenuButtonNode(e){this._focusFeatureMenuButton&&(this._focusFeatureMenuButton=!1,e.focus());}_focusActionsMenuButtonNode(e){this._focusActionsMenuButton&&(this._focusActionsMenuButton=!1,e.focus());}_featureMenuViewportScrollTop(){this._featureMenuViewportNode&&(this._featureMenuViewportNode.scrollTop=0);}_toggleScreenLocationEnabled(){const{dockEnabled:e,viewModel:t}=this;if(!t)return;const i=t.active&&!e;t.screenLocationEnabled=i;}_shouldDockAtCurrentViewSize(e){var t,i;const o=e.breakpoint,n=null==(t=this.viewModel)||null==(i=t.view)?void 0:i.ui;if(!n)return !1;const{width:s,height:r}=n;if(isNaN(s)||isNaN(r))return !1;const a=o.hasOwnProperty("width")&&s<=o.width,l=o.hasOwnProperty("height")&&r<=o.height;return a||l}_setDockEnabledForViewSize(e){e.breakpoint&&(this.dockEnabled=this._shouldDockAtCurrentViewSize(e));}_getPageText(e,t){return this.featureNavigationVisible?s$o(this.messages.pageText,{index:t+1,total:e}):null}_destroySpinner(){const{_spinner:e,view:t}=this;e&&(t&&t.ui&&t.ui.remove(this._spinner,E$3),e.destroy(),this._spinner=null);}_createSpinner(e){e&&(this._spinner=new h$a({view:e}),e.ui.add(this._spinner,{key:E$3,position:"manual"}));}_toggleCollapsed(){this.collapsed=!this.collapsed;}_close(){this.close(),this.view&&this.view.focus();}_toggleDockEnabled(){this.dockEnabled=!this.dockEnabled,this._focusDockButton=!0,this.scheduleRender();}_toggleFeatureMenu(){const e=!this.featureMenuOpen;this._featureMenuOpenChanged(e),this.actionsMenuOpen=!1,this.featureMenuOpen=e;}_toggleActionsMenu(){const e=!this.actionsMenuOpen;this._actionsMenuOpenChanged(e),this.featureMenuOpen=!1,this.actionsMenuOpen=e;}_triggerAction(e){const t=e.currentTarget["data-action-index"],i=this.viewModel.allActions.getItemAt(t);i&&"toggle"===i.type&&(i.value=!i.value),this.actionsMenuOpen=!1,this.viewModel.triggerAction(t);}_selectFeature(e){const t=e.currentTarget["data-feature-index"];isNaN(t)||(this.viewModel.selectedFeatureIndex=t),this.featureMenuOpen=!1,this._focusFeatureMenuButton=!0,this.scheduleRender();}_next(){this.next();}_previous(){this.previous();}};e$e([y$e({readOnly:!0})],R.prototype,"actionsMenuId",null),e$e([y$e({readOnly:!0})],R.prototype,"actionsMenuButtonId",null),e$e([y$e({readOnly:!0})],R.prototype,"featureMenuId",null),e$e([y$e({readOnly:!0})],R.prototype,"titleId",null),e$e([y$e({readOnly:!0})],R.prototype,"contentId",null),e$e([y$e({readOnly:!0})],R.prototype,"hasContent",null),e$e([y$e({readOnly:!0})],R.prototype,"featureNavigationVisible",null),e$e([y$e({readOnly:!0})],R.prototype,"collapsible",null),e$e([y$e({readOnly:!0})],R.prototype,"featureMenuVisible",null),e$e([y$e({readOnly:!0})],R.prototype,"contentCollapsed",null),e$e([y$e({readOnly:!0})],R.prototype,"dividedActions",null),e$e([o$j("viewModel.actions")],R.prototype,"actions",void 0),e$e([y$e()],R.prototype,"actionsMenuOpen",null),e$e([y$e()],R.prototype,"alignment",void 0),e$e([o$j("viewModel.autoCloseEnabled")],R.prototype,"autoCloseEnabled",void 0),e$e([o$j("viewModel.autoOpenEnabled")],R.prototype,"autoOpenEnabled",void 0),e$e([o$j("viewModel.defaultPopupTemplateEnabled")],R.prototype,"defaultPopupTemplateEnabled",void 0),e$e([o$j("viewModel.content")],R.prototype,"content",void 0),e$e([y$e()],R.prototype,"collapsed",void 0),e$e([y$e()],R.prototype,"collapseEnabled",void 0),e$e([y$e({readOnly:!0})],R.prototype,"currentAlignment",null),e$e([y$e({readOnly:!0})],R.prototype,"currentDockPosition",null),e$e([y$e()],R.prototype,"dockOptions",null),e$e([y$e()],R.prototype,"dockEnabled",void 0),e$e([o$j("viewModel.featureCount")],R.prototype,"featureCount",void 0),e$e([y$e()],R.prototype,"featureMenuOpen",void 0),e$e([o$j("viewModel.features")],R.prototype,"features",void 0),e$e([y$e()],R.prototype,"featureNavigationEnabled",null),e$e([o$j("viewModel.goToOverride")],R.prototype,"goToOverride",void 0),e$e([o$j("viewModel.highlightEnabled")],R.prototype,"highlightEnabled",void 0),e$e([o$j("viewModel.location")],R.prototype,"location",void 0),e$e([y$e({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],R.prototype,"label",void 0),e$e([y$e()],R.prototype,"maxInlineActions",void 0),e$e([y$e(),e$h("esri/widgets/Popup/t9n/Popup")],R.prototype,"messages",void 0),e$e([y$e(),e$h("esri/t9n/common")],R.prototype,"messagesCommon",void 0),e$e([o$j("viewModel.promises")],R.prototype,"promises",void 0),e$e([o$j("viewModel.selectedFeature")],R.prototype,"selectedFeature",void 0),e$e([o$j("viewModel.selectedFeatureIndex")],R.prototype,"selectedFeatureIndex",void 0),e$e([y$e({readOnly:!0})],R.prototype,"selectedFeatureWidget",null),e$e([y$e()],R.prototype,"spinnerEnabled",void 0),e$e([o$j("viewModel.title")],R.prototype,"title",void 0),e$e([o$j("viewModel.updateLocationEnabled")],R.prototype,"updateLocationEnabled",void 0),e$e([o$j("viewModel.view")],R.prototype,"view",void 0),e$e([y$e({type:W$3}),t$i(["triggerAction","trigger-action"])],R.prototype,"viewModel",void 0),e$e([o$j("viewModel.visible")],R.prototype,"visible",void 0),e$e([y$e()],R.prototype,"visibleElements",void 0),e$e([c$r("visibleElements")],R.prototype,"castVisibleElements",null),e$e([n$z()],R.prototype,"_close",null),e$e([n$z()],R.prototype,"_toggleDockEnabled",null),e$e([n$z()],R.prototype,"_toggleFeatureMenu",null),e$e([n$z()],R.prototype,"_toggleActionsMenu",null),e$e([n$z()],R.prototype,"_triggerAction",null),e$e([n$z()],R.prototype,"_selectFeature",null),e$e([n$z()],R.prototype,"_next",null),e$e([n$z()],R.prototype,"_previous",null),R=e$e([i$o(L$3)],R);var U$1=R;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const u$b=[0,0];function l$b(e){const t=(e.ownerDocument||window.document).defaultView,s=e.getBoundingClientRect();return u$b[0]=s.left+t.pageXOffset,u$b[1]=s.top+t.pageYOffset,u$b}function p$j(e){e&&(t$j(e),e.parentNode&&e.parentNode.removeChild(e));}function c$h(e){const t=document.createElement("div");return e.appendChild(t),t}const m$c=16,f$4=750,y$6=512,v=2,_$3=h=>{let u=class extends h{constructor(...e){super(...e),this._freqInfo={freq:m$c,time:f$4},this._overlayRenderTaskHandle=null,this.height=0,this.position=null,this.resizing=!1,this.root=null,this.surface=null,this.suspended=!0,this.ui=null,this.userContent=null,this.width=0,this.widthBreakpoint=null,this.handles.add([this.watch("cursor",(e=>{const t=this.surface;t&&t.setAttribute("data-cursor",e);})),this.watch("interacting",(e=>{const t=this.surface;t&&t.setAttribute("data-interacting",e.toString());}))]);}initialize(){this.handles.add(this.watch("ui",((e,t)=>this._handleUIChange(e,t)))),this._wireUI(this.ui),this.handles.add([this.on("focus",(()=>this.notifyChange("focused"))),this.on("blur",(()=>this.notifyChange("focused")))]);}destroy(){this.destroyed||(this.ui&&(this.ui.destroy(),this.ui=null),this.popup&&!this.popup.destroyed&&this.popup.destroy(),this.container=null);}set container(e){const t=this._get("container");if(t===e)return;const s="dom-size";if(this.handles.remove(s),this._stopMeasuring(),t&&(t.classList.remove("esri-view"),this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null),this.overlay.destroy(),this._set("overlay",null),p$j(this.root),this._set("root",null),r$h(this.userContent,t),p$j(this.userContent),this._set("userContent",null)),e){e.classList.add("esri-view");const t=document.createElement("div");t.className="esri-view-user-storage",r$h(e,t),e.appendChild(t),this._set("userContent",t);const r=document.createElement("div");r.className="esri-view-root",e.insertBefore(r,e.firstChild),this._set("root",r);const h=document.createElement("div");h.className="esri-view-surface",h.setAttribute("role","application"),h.tabIndex=0,r.appendChild(h),this._set("surface",h);const d=new n$s;r.appendChild(d.surface),this._set("overlay",d),d.watch("needsRender",(e=>{e&&!this._overlayRenderTaskHandle?this._overlayRenderTaskHandle=v$8({render:()=>{this.overlay.render();}}):this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null);})),this.forceDOMReadyCycle(),this.handles.add(d$f(this,"size",(e=>{const[t,s]=e,i="esri-view-surface--inset-outline";t>=document.body.clientWidth||s>=document.body.clientHeight?h.classList.add(i):h.classList.remove(i);})),s),this._set("container",e),this._startMeasuring();}else this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),this._set("container",null);}get focused(){const e=document.activeElement===this.surface;return document.hasFocus()&&e}get popup(){return this._get("popup")||new U$1({view:this})}set popup(e){const t=this._get("popup");t&&t!==e&&t.destroy(),this._set("popup",e);}get size(){return [this.width,this.height]}blur(){this.surface&&this.surface.blur();}focus(){this.surface&&this.surface.focus();}pageToContainer(e,t,s){const i=this.position;return e-=i[0],t-=i[1],s?(s[0]=e,s[1]=t):s=[e,t],s}containerToPage(e,t,s){const i=this.position;return e+=i[0],t+=i[1],s?(s[0]=e,s[1]=t):s=[e,t],s}_handleUIChange(e,t){t&&(this.handles.remove("ui"),t.destroy()),e&&this._wireUI(e),this._set("ui",e);}_wireUI(e){this.handles.remove("ui"),e&&(e.view=this,this.handles.add([d$f(this,"root",(t=>{e.container=t?c$h(t):null;})),d$f(this,"popup",((t,s)=>{const i="popup",o="manual";s&&e.remove(s,i),t&&(t.view=e.view,e.add(t,{key:i,position:o}));}))],"ui"));}_stopMeasuring(){this.handles.remove("measuring"),this._get("resizing")&&this._set("resizing",!1);}_startMeasuring(){const e=this._freqInfo;e.freq=m$c,e.time=f$4,this.handles.add([(()=>{const t=()=>{e.freq=m$c,e.time=f$4;};return window.addEventListener("resize",t),{remove(){window.removeEventListener("resize",t);}}})(),v$8({prepare:e=>{const t=this._measure(),s=this._freqInfo;if(s.time+=e.deltaTime,t&&(s.freq=m$c,this._get("resizing")||this._set("resizing",!0)),s.time<s.freq)return;s.time=0;const i=this._position();s.freq=i||t?m$c:Math.min(f$4,s.freq*v),!t&&s.freq>=y$6&&this._get("resizing")&&this._set("resizing",!1);}})],"measuring"),this._measure(),this._position();}_measure(){const e=this.container,t=e?e.clientWidth:0,s=e?e.clientHeight:0;if(0===t||0===s)return this.suspended||this._set("suspended",!0),!1;const i=this.width,o=this.height;return t===i&&s===o?(this.suspended&&this._set("suspended",!1),!1):(this._set("width",t),this._set("height",s),this.suspended&&this._set("suspended",!1),this.emit("resize",{oldWidth:i,oldHeight:o,width:t,height:s}),!0)}_position(){const e=this.container,t=this.position,s=l$b(e);return (!t||s[0]!==t[0]||s[1]!==t[1])&&(this._set("position",[s[0],s[1]]),!0)}forceDOMReadyCycle(){}};return e$e([y$e({value:null,cast:e=>e$l(e)})],u.prototype,"container",null),e$e([y$e({readOnly:!0})],u.prototype,"focused",null),e$e([y$e({readOnly:!0})],u.prototype,"height",void 0),e$e([y$e({type:U$1})],u.prototype,"popup",null),e$e([y$e({type:n$s})],u.prototype,"overlay",void 0),e$e([y$e({readOnly:!0})],u.prototype,"position",void 0),e$e([y$e({readOnly:!0})],u.prototype,"resizing",void 0),e$e([y$e({readOnly:!0})],u.prototype,"root",void 0),e$e([y$e({value:null,readOnly:!0})],u.prototype,"size",null),e$e([y$e({readOnly:!0})],u.prototype,"surface",void 0),e$e([y$e({readOnly:!0})],u.prototype,"suspended",void 0),e$e([y$e()],u.prototype,"ui",void 0),e$e([y$e({readOnly:!0})],u.prototype,"userContent",void 0),e$e([y$e({readOnly:!0})],u.prototype,"width",void 0),e$e([y$e()],u.prototype,"widthBreakpoint",void 0),u=e$e([i$o("esri.views.DOMContainer")],u),u};function g$8(e){return e&&"focus"in e}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
function c$g(c){return c$y(c.x,c.y)}function t$a(c,t){const n=(c instanceof HTMLElement?c:c.surface).getBoundingClientRect();return c$y(t.clientX-n.left,t.clientY-n.top)}function n$l(e,n){return n instanceof Event?t$a(e,n):c$g(n)}function i$e(e){if(e instanceof Event)return !0;if("object"==typeof e&&"type"in e){switch(e.type){case"click":case"double-click":case"pointer-down":case"pointer-drag":case"pointer-enter":case"pointer-leave":case"pointer-up":case"pointer-move":case"immediate-click":case"immediate-double-click":case"hold":case"drag":case"mouse-wheel":return !0;case"key-down":case"key-up":case"gamepad":case"focus":case"blur":default:return !1}}return !1}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
var u$a;let m$b=u$a=class extends a$j{constructor(...o){super(...o),this.position=new j$5([0,0,0]),this.heading=0,this.tilt=0,this.fov=55;}normalizeCtorArgs(o,r,t,e){if(o&&"object"==typeof o&&("x"in o||Array.isArray(o))){const i={position:o};return null!=r&&(i.heading=r),null!=t&&(i.tilt=t),null!=e&&(i.fov=e),i}return o}writePosition(o,t,e,i){const s=o.clone();s.x=u$p(o.x||0),s.y=u$p(o.y||0),s.z=o.hasZ?u$p(o.z||0):o.z,t[e]=s.write(null,i);}readPosition(o,t){const e=new j$5;return e.read(o,t),e.x=u$p(e.x||0),e.y=u$p(e.y||0),e.z=e.hasZ?u$p(e.z||0):e.z,e}equals(o){return !!o&&(this.tilt===o.tilt&&this.heading===o.heading&&this.fov===o.fov&&this.position.equals(o.position))}clone(){return new u$a({position:this.position.clone(),heading:this.heading,tilt:this.tilt,fov:this.fov})}};e$e([y$e({type:j$5,json:{write:{isRequired:!0}}})],m$b.prototype,"position",void 0),e$e([o$k("position")],m$b.prototype,"writePosition",null),e$e([e$m("position")],m$b.prototype,"readPosition",null),e$e([y$e({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),c$r((o=>C$9.normalize(u$p(o))))],m$b.prototype,"heading",void 0),e$e([y$e({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),c$r((o=>e$f(u$p(o),-180,180)))],m$b.prototype,"tilt",void 0),e$e([y$e({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],m$b.prototype,"fov",void 0),m$b=u$a=e$e([i$o("esri.Camera")],m$b);var d$7=m$b;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
var m$a;let n$k=m$a=class extends a$j{constructor(r){super(r),this.rotation=0,this.scale=0,this.targetGeometry=null,this.camera=null;}castRotation(r){return (r%=360)<0&&(r+=360),r}clone(){return new m$a({rotation:this.rotation,scale:this.scale,targetGeometry:r$f(this.targetGeometry)?this.targetGeometry.clone():null,camera:r$f(this.camera)?this.camera.clone():null})}};function l$a(){return {enabled:!this.camera}}e$e([y$e({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:l$a}}}}})],n$k.prototype,"rotation",void 0),e$e([c$r("rotation")],n$k.prototype,"castRotation",null),e$e([y$e({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:l$a}}}}})],n$k.prototype,"scale",void 0),e$e([y$e({types:i$s,json:{read:p$z,write:!0,origins:{"web-scene":{read:p$z,write:{overridePolicy:l$a}}}}})],n$k.prototype,"targetGeometry",void 0),e$e([y$e({type:d$7,json:{write:!0}})],n$k.prototype,"camera",void 0),n$k=m$a=e$e([i$o("esri.Viewpoint")],n$k);var u$9=n$k;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const t$9=t=>{let a=class extends t{async fetchPopupFeatures(e,r){await this.when();const{location:s,queryArea:t,layerViewsAndGraphics:a,clientOnlyGraphics:o}=await this._prepareFetchPopupFeatures(e,r),c=Promise.resolve(o),n=this._queryLayerPopupFeatures({queryArea:t,layerViewsAndGraphics:a,options:r}),u=n.map((e=>e.promise));return {location:s,clientOnlyGraphics:o,allGraphicsPromise:k$5([c,...u]).then(M$6),promisesPerLayerView:n}}_queryLayerPopupFeatures({queryArea:e,layerViewsAndGraphics:s,options:i}){return s.map((({layerView:s,graphics:p})=>{const t={clientGraphics:p,event:r$f(i)?i.event:null,signal:r$f(i)?i.signal:null,defaultPopupTemplateEnabled:!!r$f(i)&&!!i.defaultPopupTemplateEnabled},a=s.fetchPopupFeatures(e,t);return {layerView:s,promise:a}}))}_isValidPopupGraphic(e,s){return e&&!!e.getEffectivePopupTemplate(r$f(s)&&s.defaultPopupTemplateEnabled)}async _prepareFetchPopupFeatures(e,r){const{clientGraphics:s,queryArea:i,location:p}=await this._popupHitTestGraphics(e,r),t=this._getFetchPopupLayerViews(),{layerViewsAndGraphics:a,clientOnlyGraphics:o}=this._graphicsPerFetchPopupLayerView(s,t);return {clientOnlyGraphics:o,layerViewsAndGraphics:a,queryArea:i,location:p}}async _popupHitTestGraphics(e,r){const{results:s,mapPoint:i}=await this.popupHitTest(e),p=s.filter((e=>this._isValidPopupGraphic(e.graphic,r))),t=p.length?p[0].mapPoint:null;return {clientGraphics:p.map((e=>e.graphic)),queryArea:i,location:i||t}}_getFetchPopupLayerViews(){const e=[];return this.allLayerViews.forEach((r=>{this._isValidPopupLayerView(r)&&e.push(r);})),r$f(this.graphicsView)&&this._isValidPopupLayerView(this.graphicsView)&&e.push(this.graphicsView),e.reverse()}_isValidPopupLayerView(e){return r$f(e)&&(!("layer"in e)||!e.suspended)&&"fetchPopupFeatures"in e}_graphicsPerFetchPopupLayerView(e,r){const s=[],i=new Map,p=r.map((e=>{const r=[];return "layer"in e?i.set(e.layer,r):i.set(e.graphics,r),{layerView:e,graphics:r}}));for(const t of e){const e=i.get(t.layer)||null;e?e.push(t):s.push(t);}return {layerViewsAndGraphics:p,clientOnlyGraphics:s}}};return a=e$e([i$o("esri.views.PopupView")],a),a};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
let p$i=class extends u$k{constructor(e){super(e),this.view=null,this.baseLayerViews=new L$5,this.referenceLayerViews=new L$5,this._loadingHandle=d$f(this,"view.map.basemap",(e=>{e&&e.load().catch((()=>{}));}));}destroy(){this._set("view",null),this._loadingHandle&&(this._loadingHandle.remove(),this._loadingHandle=null);}get suspended(){return !this.view||this.view.suspended}get updating(){return (!this.view||!this.view.suspended)&&!(!(this.view&&this.view.map&&this.view.map.basemap)||this.view.map.basemap.loaded)}};e$e([y$e({constructOnly:!0})],p$i.prototype,"view",void 0),e$e([y$e({readOnly:!0})],p$i.prototype,"baseLayerViews",void 0),e$e([y$e({readOnly:!0})],p$i.prototype,"referenceLayerViews",void 0),e$e([y$e({readOnly:!0})],p$i.prototype,"suspended",null),e$e([y$e({type:Boolean,readOnly:!0})],p$i.prototype,"updating",null),p$i=e$e([i$o("esri.views.BasemapView")],p$i);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
function n$j(n,r){for(const[o,t]of n)if(r(t,o))return !0;return !1}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const V=n$v.getLogger("esri.views.LayerViewManager");class g$7{constructor(e,r,i){this.layer=e,this.view=r,this.layerViewImporter=i,this._controller=a$m(),this._deferred=A$4(),this._started=!1,this.done=!1,v$9(this._controller.signal,(()=>{const r=new s$n("cancelled:layerview-create","layerview creation cancelled",{layer:e});this._deferred.reject(r);}));}get promise(){return this._deferred.promise}destroy(){this._controller.abort();const{layerView:e}=this;if(!e)return;const{layer:r,view:i}=this;r.emit("layerview-destroy",{view:i,layerView:e}),i.emit("layerview-destroy",{layer:r,layerView:e}),this.done=!0,this.layer=null,this.layerView=null,this.view=null,this.layerViewImporter=null;}async start(){if(this._started)return;this._started=!0;const{_controller:{signal:e},layer:r,view:i}=this;this._map=i.map;try{var a,s;let n,h;if(await r.load({signal:e}),"prefetchResources"in r&&await r.prefetchResources({signal:e}),r.createLayerView)n=await r.createLayerView(i,{signal:e});else {if(!this.layerViewImporter.hasLayerViewModule(r))throw new s$n("layer:view-not-supported","No layerview implementation was found");const t=await this.layerViewImporter.importLayerView(r);h$h(e),n="default"in t?new t.default({layer:r,view:i}):new t({layer:r,view:i});}const y=()=>{h=s$p(h),n.destroy(),n.layer=null,n.parent=null,n.view=null,this.done=!0;};h=v$9(e,y),h$h(e);try{await n.when();}catch(o){throw y(),o}if(!(null==(a=this._map)||null==(s=a.allLayers)?void 0:s.includes(r)))return y(),void this._deferred.reject(new s$n("view:no-layerview-for-layer","The layer has been removed from the map",{layer:r}));this.layerView=n,r.emit("layerview-create",{view:i,layerView:n}),i.emit("layerview-create",{layer:r,layerView:n}),this.done=!0,this._deferred.resolve(n);}catch(o){r.emit("layerview-create-error",{view:i,error:o}),i.emit("layerview-create-error",{layer:r,error:o}),this.done=!0,this._deferred.reject(new s$n("layerview:create-error","layerview creation failed",{layer:r,error:o}));}}}let L$2=class extends d$h{constructor(e){super(e),this._layerLayerViewInfoMap=new Map,this._watchUpdatingTracking=new l$l,this.supportsGround=!0,this._preloadLayerViewModules=()=>{var e;const r=null==(e=this.view.map)?void 0:e.allLayers;if(r)for(const i of r)this.layerViewImporter.hasLayerViewModule(i)&&this.layerViewImporter.importLayerView(i);},this._reschedule=()=>(t$f(this._workPromise)&&(this._workPromise=A$4()),this.handles.remove("reschedule"),this.handles.add(k$6(this._doWork),"reschedule"),this._workPromise.promise),this._doWork=()=>{var e,i,t;const a=this.view.map;if(this._map!==a&&(this.clear(),this._map=a),t$f(this._workPromise))return void this.notifyChange("updating");this.handles.remove("reschedule"),this.handles.remove("collection-change");const s=new l$n({root:this,rootCollectionNames:this._rootCollectionNames,getChildrenFunction:e=>e.layers});if(!s)return this._workPromise.resolve(),void(this._workPromise=null);for(const r of s)this._createLayerView(r);this._refreshCollections();for(const[r,n]of this._layerLayerViewInfoMap)s.includes(r)||(this._layerLayerViewInfoMap.delete(n.layer),n.destroy());const o=s.filter((e=>"group"===e.type)).map((e=>e.layers)),l=[null==a||null==(e=a.ground)?void 0:e.layers,null==a||null==(i=a.basemap)?void 0:i.baseLayers,null==a||null==(t=a.basemap)?void 0:t.referenceLayers,null==a?void 0:a.layers,...o].filter((e=>!!e));this.handles.add(l.map((e=>this._watchUpdatingTracking.addOnCollectionChange(e,this._reschedule))),"collection-change"),this._workPromise.resolve(),this._workPromise=null;};}initialize(){this.handles.add([C$7(this,"view.map.allLayers","change",this._preloadLayerViewModules,this._preloadLayerViewModules),d$f(this.view,["map.basemap","map.ground","map.layers","ready"],this._reschedule,!0)]),this._preloadLayerViewModules(),this._reschedule();}destroy(){this.clear(),this._watchUpdatingTracking.destroy(),this._map=null;}get _layersToLayerViews(){const e=[["view.map.basemap.baseLayers","view.basemapView.baseLayerViews"],["view.map.layers","view.layerViews"],["view.map.basemap.referenceLayers","view.basemapView.referenceLayerViews"]];return this.supportsGround&&e.push(["view.map.ground.layers","view.groundView.layerViews"]),new Map(e)}get _rootCollectionNames(){return Array.from(this._layersToLayerViews.keys())}get updating(){return !(!r$f(this._workPromise)&&!this._watchUpdatingTracking.updating)||n$j(this._layerLayerViewInfoMap,(e=>!e.done))}clear(){if(!this.destroyed){for(const e of this._layerLayerViewInfoMap.values())e.destroy();this._layerLayerViewInfoMap.clear(),this._refreshCollections();}}async whenLayerView(e){if(await this._reschedule(),!this._layerLayerViewInfoMap.has(e))throw new s$n("view:no-layerview-for-layer","No layerview has been found for the layer",{layer:e});return this._layerLayerViewInfoMap.get(e).promise}_refreshCollections(){for(const[e,r]of this._layersToLayerViews)this._populateLayerViewsOwners(this.get(e),this.get(r),this.view);this.notifyChange("updating");}_populateLayerViewsOwners(e,r,i){if(!e||!r)return void(r&&r.removeAll());let t=0;for(const a of e){const e=this._layerLayerViewInfoMap.get(a);if(!e||!e.layerView)continue;const s=e.layerView;s.layer=a,s.parent=i,r.getItemAt(t)!==s&&r.splice(t,0,s),a.layers&&this._populateLayerViewsOwners(a.layers,s.layerViews,s),t+=1;}t<r.length&&r.splice(t,r.length);}_createLayerView(e){if(this._layerLayerViewInfoMap.has(e))return this.view.ready&&this._layerLayerViewInfoMap.get(e).start(),void this.notifyChange("updating");e.load().catch((()=>{})),this.layerViewImporter.hasLayerViewModule(e)&&this.layerViewImporter.importLayerView(e);const r=new g$7(e,this.view,this.layerViewImporter);r.promise.then((()=>this._refreshCollections()),(r=>{var i,t;r&&(g$g(r)||"cancelled:layerview-create"===r.name)||V.error(`Failed to create layerview for layer title:'${null!=(i=e.title)?i:"no title"}', id:'${null!=(t=e.id)?t:"no id"}' of type '${e.type}'.`,{layer:e,error:r});this._refreshCollections();})),this._layerLayerViewInfoMap.set(e,r),this.view.ready&&r.start(),this.notifyChange("updating");}};e$e([y$e()],L$2.prototype,"_workPromise",void 0),e$e([y$e({readOnly:!0})],L$2.prototype,"_watchUpdatingTracking",void 0),e$e([y$e({readOnly:!0})],L$2.prototype,"_layersToLayerViews",null),e$e([y$e({readOnly:!0})],L$2.prototype,"_rootCollectionNames",null),e$e([y$e()],L$2.prototype,"layerViewImporter",void 0),e$e([y$e()],L$2.prototype,"supportsGround",void 0),e$e([y$e({readOnly:!0})],L$2.prototype,"updating",null),e$e([y$e({constructOnly:!0})],L$2.prototype,"view",void 0),L$2=e$e([i$o("esri.views.LayerViewManager")],L$2);var M$1=L$2;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
let i$d=class extends u$k{constructor(o){super(o),this.factor=1.5,this.offset=c$y(0,0),this.position=null,this.size=120,this.maskUrl=null,this.maskEnabled=!0,this.overlayUrl=null,this.overlayEnabled=!0,this.visible=!0;}get version(){return this.commitProperty("factor"),this.commitProperty("offset"),this.commitProperty("position"),this.commitProperty("visible"),this.commitProperty("size"),this.commitProperty("maskUrl"),this.commitProperty("maskEnabled"),this.commitProperty("overlayUrl"),this.commitProperty("overlayEnabled"),(this._get("version")||0)+1}};e$e([y$e({type:Number})],i$d.prototype,"factor",void 0),e$e([y$e({nonNullable:!0})],i$d.prototype,"offset",void 0),e$e([y$e()],i$d.prototype,"position",void 0),e$e([y$e({type:Number,range:{min:0}})],i$d.prototype,"size",void 0),e$e([y$e()],i$d.prototype,"maskUrl",void 0),e$e([y$e()],i$d.prototype,"maskEnabled",void 0),e$e([y$e()],i$d.prototype,"overlayUrl",void 0),e$e([y$e()],i$d.prototype,"overlayEnabled",void 0),e$e([y$e({readOnly:!0})],i$d.prototype,"version",null),e$e([y$e({type:Boolean})],i$d.prototype,"visible",void 0),i$d=e$e([i$o("esri.views.Magnifier")],i$d);var p$h=i$d;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const i$c=i=>{let p=class extends i{constructor(){super(...arguments),this.refreshTimestamp=null,this.refreshDebounced=q$4((async(r,e)=>{let s;"number"==typeof r?s=r:(s=Date.now(),e=r),this._set("refreshTimestamp",s),this.doRefresh&&await this.doRefresh(e);}),2e3);}refresh(r=Date.now()){this._set("refreshTimestamp",r),this.doRefresh&&this.doRefresh();}};return e$e([y$e()],p.prototype,"layer",void 0),e$e([o$j("layer.refreshInterval")],p.prototype,"refreshInterval",void 0),e$e([y$e({readOnly:!0})],p.prototype,"refreshTimestamp",void 0),p=e$e([i$o("esri.layers.mixins.RefreshableLayerView")],p),p};function p$g(r){return "refresh"in r}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const n$i=6e3;let o$9=class extends n$y.EventedAccessor{constructor(){super(...arguments),this._handles=new u$j,this._currentTick=0;}initialize(){this._handles.add([this.view.allLayerViews.on("after-changes",(()=>{this.notifyChange("tickInterval"),this._handles.remove("layerViewsUpdating"),this._handles.add(this._getLayerViewHandles(),"layerViewsUpdating");})),this.watch("tickInterval",(()=>this._restartTicking())),this.watch("view.ready",(()=>this._restartTicking()))]),this._restartTicking();}destroy(){this._handles&&(this._handles.destroy(),this._handles=null,this._intervalID&&clearInterval(this._intervalID),this._currentTick=0);}get tickInterval(){const e=this.view.allLayerViews.filter((e=>p$g(e)));return this._getCommonInterval(e)}_restartTicking(){this._currentTick=0,this._intervalID&&clearInterval(this._intervalID),this.get("view.ready")&&this.tickInterval&&(this._intervalID=setInterval((()=>{const e=Date.now();this._currentTick+=this.tickInterval,this.view.allLayerViews.forEach((r=>{if(p$g(r)){const t=Math.round(6e4*r.refreshInterval),s=this._currentTick%t==0,i=e-r.refreshTimestamp<.9*n$i;t&&s&&!i&&(r.refresh(e),this.emit("refresh",{layerView:r,timestamp:e,trigger:"interval"}));}}));}),this.tickInterval));}_getLayerViewHandles(){const e=[],r=()=>this.notifyChange("tickInterval");return this.view.allLayerViews.forEach((t=>{p$g(t)&&t.layer&&e.push(t.watch("refreshInterval",r),t.layer.on("refresh",(()=>{const e=Date.now();t.refresh(e),this.emit("refresh",{layerView:t,timestamp:e,trigger:"layer-refresh"});})));})),e}_getCommonInterval(e){const r=(e,t)=>isNaN(e)||isNaN(t)?0:t<=0?e:r(t,e%t);return e.toArray().reduce(((e,t)=>r(Math.round(6e4*t.refreshInterval),e)),0)}};e$e([y$e()],o$9.prototype,"view",void 0),e$e([y$e({readOnly:!0})],o$9.prototype,"tickInterval",null),o$9=e$e([i$o("esri.views.RefreshManager")],o$9);var h$8=o$9;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const r$9=["click","double-click","immediate-click","immediate-double-click","hold","drag","key-down","key-up","pointer-down","pointer-move","pointer-up","pointer-drag","mouse-wheel","pointer-enter","pointer-leave","gamepad","focus","blur"],i$b={};function o$8(t){return !!i$b[t]}function s$e(t){for(const e of t)if(!o$8(e))return !1;return !0}r$9.forEach((t=>{i$b[t]=!0;}));class p$f{constructor(t){this.handlers=new Map,this.counter=0,this.handlerCounts=new Map,this.view=t,this.inputManager=null;}connect(t){t&&this.disconnect(),this.inputManager=t,this.handlers.forEach((({handler:t,priority:e},a)=>this.inputManager.installHandlers(a,[t],e)));}disconnect(){this.inputManager&&this.handlers.forEach(((t,e)=>this.inputManager.uninstallHandlers(e))),this.inputManager=null;}destroy(){this.disconnect(),this.handlers.clear(),this.view=null;}on(t,e,a,r){const i=Array.isArray(t)?t:t.split(",");if(!s$e(i))return i.some(o$8)&&console.error("Error: registering input events and other events on the view at the same time is not supported."),null;let p,l;Array.isArray(e)?l=e:(p=e,l=[]),"function"==typeof a?p=a:r=a,r=null!=r?r:u$d.DEFAULT;const u=this.createUniqueGroupName(),m=new c$f(this.view,i,l,p);this.handlers.set(u,{handler:m,priority:r});for(const n of i){const t=this.handlerCounts.get(n)||0;this.handlerCounts.set(n,t+1);}return this.inputManager&&this.inputManager.installHandlers(u,[m],r),{remove:()=>this.removeHandler(u,i)}}hasHandler(t){return !!this.handlerCounts.get(t)}removeHandler(t,e){if(this.handlers.has(t)){this.handlers.delete(t);for(const t of e){const e=this.handlerCounts.get(t);void 0===e?console.error("Trying to remove handler for event that has no handlers registered: ",t):1===e?this.handlerCounts.delete(t):this.handlerCounts.set(t,e-1);}}this.inputManager&&this.inputManager.uninstallHandlers(t);}createUniqueGroupName(){return this.counter+=1,`viewEvents_${this.counter}`}}class c$f extends i$g{constructor(t,e,a,n){super(!0),this.view=t;for(const r of e)switch(r){case"click":this.registerIncoming("click",a,(t=>n(this.wrapClick(t))));break;case"double-click":this.registerIncoming("double-click",a,(t=>n(this.wrapDoubleClick(t))));break;case"immediate-click":this.registerIncoming("immediate-click",a,(t=>n(this.wrapImmediateClick(t))));break;case"immediate-double-click":this.registerIncoming("immediate-double-click",a,(t=>n(this.wrapImmediateDoubleClick(t))));break;case"hold":this.registerIncoming("hold",a,(t=>n(this.wrapHold(t))));break;case"drag":this.registerIncoming("drag",a,(t=>{const e=this.wrapDrag(t);e&&n(e);}));break;case"key-down":this.registerIncoming("key-down",a,(t=>n(this.wrapKeyDown(t))));break;case"key-up":this.registerIncoming("key-up",a,(t=>n(this.wrapKeyUp(t))));break;case"pointer-down":this.registerIncoming("pointer-down",a,(t=>n(this.wrapPointer(t,"pointer-down"))));break;case"pointer-move":this.registerIncoming("pointer-move",a,(t=>n(this.wrapPointer(t,"pointer-move"))));break;case"pointer-up":this.registerIncoming("pointer-up",a,(t=>n(this.wrapPointer(t,"pointer-up"))));break;case"pointer-drag":this.registerIncoming("pointer-drag",a,(t=>n(this.wrapPointerDrag(t))));break;case"mouse-wheel":this.registerIncoming("mouse-wheel",a,(t=>n(this.wrapMouseWheel(t))));break;case"pointer-enter":this.registerIncoming("pointer-enter",a,(t=>n(this.wrapPointer(t,"pointer-enter"))));break;case"pointer-leave":this.registerIncoming("pointer-leave",a,(t=>n(this.wrapPointer(t,"pointer-leave"))));break;case"gamepad":this.registerIncoming("gamepad",a,(t=>{n(this.wrapGamepad(t));}));break;case"focus":this.registerIncoming("focus",a,(t=>{n(this.wrapFocus(t));}));break;case"blur":this.registerIncoming("blur",a,(t=>{n(this.wrapBlur(t));}));}}wrapFocus(t){return {type:"focus",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapBlur(t){return {type:"blur",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapClick(t){const{pointerType:a,button:n,buttons:r,x:i,y:o,native:s,eventId:p}=t.data,{cancelable:c,timestamp:l}=t;return {type:"click",pointerType:a,button:n,buttons:r,x:i,y:o,native:s,timestamp:l,screenPoint:c$y(i,o),mapPoint:this.getMapPoint(i,o),eventId:p,cancelable:c,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapDoubleClick(t){const{pointerType:e,button:a,buttons:n,x:r,y:i,native:o,eventId:s}=t.data,{cancelable:p,timestamp:c}=t;return {type:"double-click",pointerType:e,button:a,buttons:n,x:r,y:i,native:o,timestamp:c,mapPoint:this.getMapPoint(r,i),eventId:s,cancelable:p,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapImmediateClick(t){const{pointerType:e,button:a,buttons:n,x:r,y:i,native:o,eventId:s}=t.data,p=o.pointerId,{cancelable:c,timestamp:l}=t;return {type:"immediate-click",pointerId:p,pointerType:e,button:a,buttons:n,x:r,y:i,native:o,timestamp:l,mapPoint:this.getMapPoint(r,i),eventId:s,cancelable:c,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapImmediateDoubleClick(t){const{pointerType:e,button:a,buttons:n,x:r,y:i,native:o,eventId:s}=t.data,p=o.pointerId,{cancelable:c,timestamp:l}=t;return {type:"immediate-double-click",pointerId:p,pointerType:e,button:a,buttons:n,x:r,y:i,native:o,timestamp:l,mapPoint:this.getMapPoint(r,i),eventId:s,cancelable:c,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapHold(t){const{pointerType:e,button:a,buttons:n,x:r,y:i,native:o}=t.data,{cancelable:s,timestamp:p}=t;return {type:"hold",pointerType:e,button:a,buttons:n,x:r,y:i,native:o,timestamp:p,mapPoint:this.getMapPoint(r,i),cancelable:s,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}getMapPoint(t,a){return this.view.toMap(c$y(t,a),{exclude:[]})}wrapDrag(e){const a=e.data,{x:n,y:r}=a.center,{action:i,pointerType:o,button:s}=a;if("start"===i&&(this.latestDragStart=a),!this.latestDragStart)return;const p=a.pointer.native,c=a.buttons,{cancelable:l,timestamp:u}=e,m={x:this.latestDragStart.center.x,y:this.latestDragStart.center.y};return "end"===i&&(this.latestDragStart=void 0),{type:"drag",action:i,x:n,y:r,origin:m,pointerType:o,button:s,buttons:c,radius:a.radius,angle:b$9(a.angle),native:p,timestamp:u,cancelable:l,stopPropagation:()=>e.stopPropagation(),async:t=>e.async(t),preventDefault:()=>e.preventDefault()}}wrapKeyDown(t){const{key:e,repeat:a,native:n}=t.data,{cancelable:r,timestamp:i}=t;return {type:"key-down",key:e,repeat:a,native:n,timestamp:i,cancelable:r,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapKeyUp(t){const{key:e,native:a}=t.data,{cancelable:n,timestamp:r}=t;return {type:"key-up",key:e,native:a,timestamp:r,cancelable:n,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapPointer(t,e){const{x:a,y:n,button:r,buttons:i,native:o,eventId:s}=t.data,p=o.pointerId,c=o.pointerType,{cancelable:l,timestamp:u}=t;return {type:e,x:a,y:n,pointerId:p,pointerType:c,button:r,buttons:i,native:o,timestamp:u,eventId:s,cancelable:l,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapPointerDrag(t){const{x:e,y:a,buttons:n,native:r,eventId:i}=t.data.currentEvent,{button:o}=t.data.startEvent,s=t.data.startEvent.native.pointerId,p=t.data.startEvent.native.pointerType,c=t.data.action,l={x:t.data.startEvent.x,y:t.data.startEvent.y},{cancelable:u,timestamp:m}=t;return {type:"pointer-drag",x:e,y:a,pointerId:s,pointerType:p,button:o,buttons:n,action:c,origin:l,native:r,timestamp:m,eventId:i,cancelable:u,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapMouseWheel(t){const{cancelable:e,data:a,timestamp:n}=t,{x:r,y:i,deltaY:o,native:s}=a;return {type:"mouse-wheel",x:r,y:i,deltaY:o,native:s,timestamp:n,cancelable:e,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapGamepad(t){const{action:e,state:a,device:n}=t.data,{cancelable:r,timestamp:i}=t,{buttons:o,axes:s}=a;return {type:"gamepad",device:n,timestamp:i,action:e,buttons:o,axes:s,cancelable:r,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
function i$a(t,e){const o=t.view;o&&(e&&o.ready&&o.activeTool!==t?(o.activeTool=t,g$8(o)&&o.focus()):e||o.activeTool!==t||(o.activeTool=null));}function n$h(e,o,a){const i=e.activeTool;o!==i&&(r$f(i)&&i.deactivate&&i.deactivate(),a(o),r$f(o)&&o.activate&&o.activate());}function c$e(){const t=new L$5;return t.on("after-add",(t=>{const e=t.item;e.view&&e.view.ready&&e.attach();})),t.on("after-remove",(t=>{const e=t.item;i$a(e,!1),e.destroyed||e.detach();})),t}function r$8(t){return !1!==t.visible&&!1!==t.editable&&(null==t.hasEditableFlag||t.hasEditableFlag(1))}function l$9(t){return t$f(t)?{}:"function"==typeof t?t():t}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
class p$e{constructor(){this._pointerLocations=new Map,this._hoveredManipulators=new Map,this._grabbedManipulators=new Map,this._draggedManipulators=new Map,this._stopDrag=!1,this._revertToActiveTool=null,this._cursor=null;}get cursor(){return this._cursor}handleInputEvent(n,a){const s=()=>n.stopPropagation();switch(n.type){case"pointer-move":c$d(n.pointerType)&&this._pointerLocations.set(n.pointerId,{x:n.x,y:n.y,pointerType:n.pointerType});break;case"drag":this._grabbedManipulators.size>0&&(this._stopDrag=!0),this._stopDrag&&(s(),"end"===n.action&&(this._stopDrag=!1));break;case"pointer-down":{if(!u$8(n)||d$6(n))break;const o=c$g(n),r=this._intersect(o,n.pointerType,a.forEachTool);if(t$f(r))break;const p=this._findToolAndManipulatorByKey(r,a.forEachTool,h$7),c=o$l(p,(t=>t.manipulator)),g=o$l(p,(t=>t.tool));!(r$f(c)&&r$f(g)&&c.interactive)||c.grabbable&&c.grabbableForEvent(n)||!c.grabbing||c.dragging||this._ungrabManipulatorBeforeDragging(c,g,n),r$f(c)&&c.interactive&&c.grabbable&&c.grabbableForEvent(n)&&!c.grabbing&&(this._grabbedManipulators.set(n.pointerId,{key:r,start:o}),1===this._grabbedManipulators.size&&(this._revertToActiveTool=a.activeTool,a.setActiveTool(r.tool)),c.grabbing=!0,c.events.emit("grab-changed",{action:"start",screenPoint:o}),s());break}case"pointer-up":this._handlePointerEnd(n,a);break;case"pointer-drag":{if(!u$8(n))break;const e=this._grabbedManipulators.get(n.pointerId),p=this._draggedManipulators.get(n.pointerId),c=o$l(e||p,(({key:t})=>t)),d=this._findManipulatorByKey(c,a.forEachTool);if(t$f(d))break;const h=c$g(n);h.x=e$f(h.x,0,a.view.width),h.y=e$f(h.y,0,a.view.height);const g=e$i(e||p).start;switch(n.action){case"start":case"update":"update"!==n.action&&1!==this._grabbedManipulators.size||(d.dragging=!0,p?d.events.emit("drag",{action:"update",start:g,screenPoint:h}):d.events.emit("drag",{action:"start",start:g,screenPoint:h,pointerType:n.pointerType}),this._draggedManipulators.set(n.pointerId,{key:e$i(c),start:g}));break;case"end":d.dragging=!1,p&&d.events.emit("drag",{action:"end",start:g,screenPoint:h}),this._draggedManipulators.delete(n.pointerId),this._handlePointerEnd(n,a);}s();break}case"immediate-click":{const i=c$g(n),o=this._intersect(i,n.pointerType,a.forEachTool),r=this._findToolAndManipulatorByKey(o,a.forEachTool,h$7);if(d$6(n)||a.forEachTool((t=>{if((!r$f(r)||r.tool!==t||!t.selectionManagementDisabled)&&t.manipulators){let e=!1;t.manipulators.forEach((({manipulator:t})=>{t.selected&&(t.selected=!1,e=!0);})),e&&t.manipulatorSelectionChanged&&t.manipulatorSelectionChanged();}})),t$f(r))break;const{manipulator:p,tool:c}=r;if(!p.interactive)break;p.selectable&&!c.selectionManagementDisabled&&(p.selected=!p.selected,c.manipulatorSelectionChanged&&c.manipulatorSelectionChanged());const u=n.native.shiftKey;p.events.emit("immediate-click",{screenPoint:i,button:n.button,pointerType:n.pointerType,shiftKey:u,stopPropagation:s});break}case"click":{const e=c$g(n),i=this._intersect(e,n.pointerType,a.forEachTool),o=this._findManipulatorByKey(i,a.forEachTool);if(t$f(o)||!o.interactive)break;const r=n.native.shiftKey;o.events.emit(n.type,{screenPoint:e,button:n.button,pointerType:n.pointerType,shiftKey:r}),s();break}case"double-click":{const e=c$g(n),i=this._intersect(e,n.pointerType,a.forEachTool),o=this._findManipulatorByKey(i,a.forEachTool);if(t$f(o)||!o.interactive)break;const r=n.native.shiftKey;o.events.emit("double-click",{screenPoint:e,button:n.button,pointerType:n.pointerType,shiftKey:r,stopPropagation:s});break}case"immediate-double-click":{const e=c$g(n),i=this._intersect(e,n.pointerType,a.forEachTool),o=this._findManipulatorByKey(i,a.forEachTool);if(t$f(o)||!o.interactive)break;const r=n.native.shiftKey;o.events.emit("immediate-double-click",{screenPoint:e,button:n.button,pointerType:n.pointerType,shiftKey:r,stopPropagation:s});break}}this._updateCursor(a.forEachTool);}_ungrabManipulatorBeforeDragging(t,e,i){t.grabbing=!1,t.events.emit("grab-changed",{action:"end",screenPoint:c$g(i)}),this._grabbedManipulators.forEach((({key:i},o)=>{i.tool===e&&e.manipulators.findById(i.manipulatorId)===t&&this._grabbedManipulators.delete(o);}));}_handlePointerEnd(t,r){const n=o$l(this._grabbedManipulators.get(t.pointerId),(({key:t})=>t)),a=this._findManipulatorByKey(n,r.forEachTool);if(r$f(a)&&!a.dragging){const i=r$f(r.creatingTool)&&r.creatingTool===e$i(n).tool;1!==this._grabbedManipulators.size||0!==this._draggedManipulators.size||i||(r.setActiveTool(this._revertToActiveTool),this._revertToActiveTool=null),a.grabbing&&(a.grabbing=!1,a.events.emit("grab-changed",{action:"end",screenPoint:c$g(t)})),this._grabbedManipulators.delete(t.pointerId);}}_cursorFromMap(t,i){let o=null;return n$j(t,(({key:t})=>{const r=this._findManipulatorByKey(t,i);return !!(r$f(r)&&r.interactive&&"cursor"in r&&r.cursor)&&(o=r.cursor,!0)})),o}_updateCursor(t){this._grabbedManipulators.size>0?this._cursor=this._cursorFromMap(this._grabbedManipulators,t)||"grabbing":this._hoveredManipulators.size>0?this._cursor=this._cursorFromMap(this._hoveredManipulators,t)||"pointer":this._cursor=null;}clearPointers(i,o,r=!0,n){const a=e=>e.tool===i&&(t$f(n)||e.manipulatorId===n);this._grabbedManipulators.forEach((({key:t},i)=>{if(a(t)){this._grabbedManipulators.delete(i);const r=this._findManipulatorByKey(t,o);r$f(r)&&(r.grabbing=!1,r.events.emit("grab-changed",{action:"end",screenPoint:null}));}})),this._draggedManipulators.forEach((({key:t},i)=>{if(a(t)){this._draggedManipulators.delete(i);const r=this._findManipulatorByKey(t,o);r$f(r)&&(r.dragging=!1,r.events.emit("drag",{action:"cancel"}));}})),r&&this._hoveredManipulators.forEach((({key:t},i)=>{if(a(t)){this._hoveredManipulators.delete(i);const r=this._findManipulatorByKey(t,o);r$f(r)&&(r.hovering=!1);}})),this._updateCursor(o);}_intersect(e,i,o){let r=null;return o((o=>{if(null==o.manipulators||!r$8(o))return !1;const n=o.manipulators.intersect(e,i);return !t$f(n)&&(r={manipulatorId:n.id,tool:o},!0)})),r}updateHoveredStateFromKnownPointers(t){this._pointerLocations.forEach(((e,i)=>{this._updateHoveredStateForPointerAtScreenPosition(c$y(e.x,e.y),i,e.pointerType,t);}));}handleHoverEvent(t,e){"pointer-up"!==t.type&&"immediate-click"!==t.type&&"pointer-move"!==t.type||!c$d(t.pointerType)||this._updateHoveredStateForPointerAtScreenPosition(c$g(t),t.pointerId,t.pointerType,e);}_updateHoveredStateForPointerAtScreenPosition(t,r,n,a){const s=this._intersect(t,n,a);let l=this._findManipulatorByKey(s,a);const p=o$l(this._hoveredManipulators.get(r),(({key:t})=>t)),c=this._findManipulatorByKey(p,a);r$f(l)&&!l.interactive&&(l=null),c!==l&&(r$f(c)&&(c.hovering=!1),r$f(l)?(l.hovering=!0,this._hoveredManipulators.set(r,{key:e$i(s)})):this._hoveredManipulators.delete(r),this._updateCursor(a));}_findManipulatorByKey(t,e){return this._findToolAndManipulatorByKey(t,e,h$7)?h$7.manipulator:null}_findToolAndManipulatorByKey(i,o,r){return t$f(i)?null:(r.tool=null,r.manipulator=null,o((t=>{if(t!==i.tool||null==t.manipulators||!r$8(t))return !1;const o=t.manipulators.findById(i.manipulatorId);return !!r$f(o)&&(r.manipulator=o,r.tool=t,!0)})),r.manipulator?r:null)}}function c$d(t){return "mouse"===t}function u$8(t){return "mouse"!==t.pointerType||0===t.button}function d$6(t){return !!t.native.shiftKey}const h$7={manipulator:null,tool:null};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const y$5=n$v.getLogger("esri.views.ToolViewManager"),j$1="manipulators",C$4="tools";let b$2=class extends u$k{constructor(t){super(t),this._handles=new u$j,this._creatingTool=null,this._manipulatorState=new p$e,this.tools=c$e(),this.cursor=null,this._forEachTool=t=>{if(!r$f(this._creatingTool)||!t(this._creatingTool))for(const o of this.tools.items)if(t(o))return};}initialize(){this._handles.add([this.view.on(r$9,(t=>{this._handleInputEvent(t);}),u$d.TOOL),this.tools.on("before-add",(t=>{const o=t.item;null==o||this.tools.includes(o)?t.preventDefault():null==o.created||o.created||(y$5.error("tools","Tool can not be added to view before it has been created"),t.preventDefault());})),this.tools.on("before-remove",(({item:t})=>{this._manipulatorState.clearPointers(t,this._forEachTool);})),this.tools.on("change",(()=>{this._refreshToolWatchers();}))]);}destroy(){this._forEachTool((t=>t.destroy())),this._handles.destroy(),this._handles=null;}set activeTool(t){!r$f(t)||this.view.ready?(n$h(this,t,(o=>{this._set("activeTool",o),this._removeIncompleteTools(t),this._forEachTool((t=>{const o=t$f(this.activeTool)||t===this.activeTool;t.setEditableFlag&&t.setEditableFlag(1,o);const i=r$8(t);!t$f(this.activeTool)&&i||this._manipulatorState.clearPointers(t,this._forEachTool,!i);})),this._updateCursor();})),this._creatingTool!==t&&this._rejectCreatingTool()):y$5.error("#activeTool=","cannot set active tool while view is not ready");}async createTool(t,e,i){await this.view.whenReady();const r="Tool creation was interrupted by another tool being created";if(b$a(i))throw m$n(r);const a=new t({...l$9(e),view:this.view}),c=v$9(i,(()=>this.activeTool=null));return this._rejectCreatingTool(r),this._creatingTool=a,a.attach(),this._refreshToolWatchers(),i$a(a,!0),await a.when(),r$f(c)&&c.remove(),this._creatingTool=null,this.tools.add(a),a instanceof u$k&&null!=a.completed&&j$6(a,"completed").then((()=>{i$a(a,!1);})),a}attach(){this._forEachTool((t=>t.attach())),"3d"===this.view.type?this._handles.add([this.view.state.watch("camera",(()=>{this.forEachManipulator((t=>{null!=t.onViewChange&&t.onViewChange();}));})),this.view.elevationProvider.on("elevation-change",(t=>{this.forEachManipulator((o=>{null!=o.onElevationChange&&o.onElevationChange(t);}));}))],j$1):this._handles.add(this.view.watch("extent",(()=>{this.forEachManipulator((t=>{null!=t.onViewChange&&t.onViewChange();}));})));}detach(){this.activeTool=null,this._forEachTool((t=>{t.detach(),t.destroy();})),this.tools.removeAll(),this._handles.remove(j$1);}forEachManipulator(t){this._forEachTool((o=>{o.manipulators&&o.manipulators.forEach((({manipulator:e})=>t(e,o)));}));}_handleInputEvent(t){let e=!1;const i={...t,stopPropagation:()=>{e=!0,t.stopPropagation();}};r$f(this.activeTool)?this.activeTool.handleInputEvent&&this.activeTool.handleInputEvent(i):this._forEachTool((t=>{!e&&!1!==t.visible&&t.handleInputEvent&&t.handleInputEvent(i);})),!e&&"key-down"===t.type&&"Escape"===t.key&&this.activeTool&&(t.stopPropagation(),this.activeTool=null),this._manipulatorState.handleInputEvent(i,{forEachTool:this._forEachTool,activeTool:this.activeTool,setActiveTool:t=>{this.activeTool=t;},creatingTool:this._creatingTool,view:this.view}),!e&&r$f(this.activeTool)&&this.activeTool.handleInputEventAfter&&this.activeTool.handleInputEventAfter(i),this._manipulatorState.handleHoverEvent(i,this._forEachTool),this._updateCursor();}_refreshToolWatchers(){this._handles.remove(C$4),this._forEachTool((t=>{if(t instanceof u$k){const o=h$g(t,["cursor","visible","editable"],(()=>{r$8(t)||this._manipulatorState.clearPointers(t,this._forEachTool),this._updateCursor();}));this._handles.add(o,C$4);}t.manipulators&&this._handles.add(t.manipulators.on("change",(o=>{o.removed.forEach((({id:o})=>{this._manipulatorState.clearPointers(t,this._forEachTool,!0,o);})),this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor();})),C$4);})),this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor();}_updateCursor(){let t=null;this._forEachTool((o=>null!=o.cursor&&!1!==o.visible&&(t=o.cursor,!0))),t||(t=this._manipulatorState.cursor),this._get("cursor")!==t&&this._set("cursor",t);}_rejectCreatingTool(t){const o=this._creatingTool;t$f(o)||(this._manipulatorState.clearPointers(o,this._forEachTool),o.rejectCreation&&o.rejectCreation(m$n(t)),o.destroy(),this._creatingTool=null,this._refreshToolWatchers());}_removeIncompleteTools(t){this.tools.filter((o=>(t$f(t)||o!==t)&&null!=o.completed&&!o.completed)).forEach((t=>{this.tools.remove(t);}));}};e$e([y$e({constructOnly:!0,nonNullable:!0})],b$2.prototype,"view",void 0),e$e([y$e({value:null})],b$2.prototype,"activeTool",null),e$e([y$e({readOnly:!0,type:L$5})],b$2.prototype,"tools",void 0),e$e([y$e({readOnly:!0})],b$2.prototype,"cursor",void 0),b$2=e$e([i$o("esri.views.ToolViewManager")],b$2);var S$2=b$2;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
class o$7{constructor(s,i,o){this.analysis=s,this.viewFactory=i,this.controllerFactory=o,this._promise=A$4(),this.analysisView=null,this.analysisController=null,this._load();}destroy(){r$f(this.analysisView)&&this.analysisView.destroy(),r$f(this.analysisController)&&this.analysisController.destroy();}get promise(){return this._promise.promise}async _load(){let t=!1;r$f(this.viewFactory)?this.analysisView=await this.viewFactory(this.analysis):t=!0,r$f(this.controllerFactory)?this.analysisController=await this.controllerFactory(this.analysis):t=!0,t?this._promise.reject("no view/controller factories available for analysis"):this._promise.resolve(e$i(this.analysisView));}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
let m$9=class extends u$k{constructor(e){super(e),this._items=new Map,this.analyses=new L$5;}initialize(){this.analyses.on("after-add",(e=>{const s=e.item;this._items.set(s,this._createItem(s));})),this.analyses.on("after-remove",(e=>{const t=e.item,r=this._getItem(t);r$f(r)&&(r.destroy(),this._items.delete(t));}));}async whenAnalysisView(e){return this._items.has(e)?this._items.get(e).promise:L$8(new s$n("view:no-analysisview-for-analysis","No analysis view has been found for the analysis"))}getAnalysisView(e){const s=this._items.get(e);return s?s.analysisView:null}_createItem(e){return new o$7(e,this.viewFactory,this.controllerFactory)}_getItem(e){return this._items.get(e)}};e$e([y$e({type:L$5})],m$9.prototype,"analyses",void 0),e$e([y$e()],m$9.prototype,"viewFactory",void 0),e$e([y$e()],m$9.prototype,"controllerFactory",void 0),m$9=e$e([i$o("esri.views.3d.interactive.graphics.AnalysisManager")],m$9);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
let s$d=class extends u$k{constructor(e){super(),this.nativeIndex=null,this._detectedDeviceType="unknown","standard"===e.mapping?this._detectedDeviceType="standard":p$d.test(e.id)?this._detectedDeviceType="spacemouse":this._detectedDeviceType="unknown",this.nativeIndex=e.index;}get native(){return (navigator.getGamepads?navigator.getGamepads():[])[this.nativeIndex]}get deviceType(){return this._detectedDeviceType}get axisThreshold(){return i$9[this.deviceType]}};e$e([y$e({nonNullable:!0,readOnly:!0})],s$d.prototype,"nativeIndex",void 0),e$e([y$e({type:String,readOnly:!0})],s$d.prototype,"deviceType",null),e$e([y$e({type:Number,readOnly:!0})],s$d.prototype,"axisThreshold",null),s$d=e$e([i$o("esri.views.input.gamepad.GamepadInputDevice")],s$d);const p$d=new RegExp("^(3dconnexion|space(mouse|navigator|pilot|explorer))","i"),i$9={standard:.15,spacemouse:.025,unknown:0};var n$g=s$d;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
let c$c=class extends u$k{constructor(...o){super(...o),this.devices=new L$5,this.enabledFocusMode="document";}};e$e([y$e({type:L$5.ofType(n$g),readOnly:!0})],c$c.prototype,"devices",void 0),e$e([y$e({type:["document","view","none"]})],c$c.prototype,"enabledFocusMode",void 0),c$c=e$e([i$o("esri.views.input.gamepad.GamepadSettings")],c$c);var i$8=c$c;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
let p$c=class extends u$k{constructor(){super(...arguments),this.gamepad=new i$8;}};e$e([y$e({readOnly:!0})],p$c.prototype,"gamepad",void 0),p$c=e$e([i$o("esri.views.input.Input")],p$c);var c$b=p$c;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
let s$c=class extends u$k{constructor(o){super(o),this.enabled=!0,this.device=null,this.mode="pan",this.tiltDirection="forward-down",this.velocityFactor=1;}};e$e([y$e({type:Boolean,nonNullable:!0})],s$c.prototype,"enabled",void 0),e$e([y$e({type:n$g})],s$c.prototype,"device",void 0),e$e([y$e({type:["pan","zoom"],nonNullable:!0})],s$c.prototype,"mode",void 0),e$e([y$e({type:["forward-down","forward-up"],nonNullable:!0})],s$c.prototype,"tiltDirection",void 0),e$e([y$e({type:Number,nonNullable:!0})],s$c.prototype,"velocityFactor",void 0),s$c=e$e([i$o("esri.views.navigation.gamepad.GamepadSettings")],s$c);var i$7=s$c;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
let p$b=class extends u$k{constructor(o){super(o),this.browserTouchPanEnabled=!0,this.gamepad=new i$7,this.momentumEnabled=!0,this.mouseWheelZoomEnabled=!0;}};e$e([y$e({type:Boolean})],p$b.prototype,"browserTouchPanEnabled",void 0),e$e([y$e({type:i$7,nonNullable:!0})],p$b.prototype,"gamepad",void 0),e$e([y$e({type:Boolean})],p$b.prototype,"momentumEnabled",void 0),e$e([y$e({type:Boolean})],p$b.prototype,"mouseWheelZoomEnabled",void 0),p$b=e$e([i$o("esri.views.navigation.Navigation")],p$b);var a$c=p$b;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
function l$8(t){const a=t.url&&d$k(t.url);return !(null==(t.spatialReference&&t.spatialReference.vcsWkid)&&r$f(a)&&"ImageServer"===a.serverType)&&h$6(t)&&t.heightModelInfo?t.heightModelInfo:m$8(t)?v$a.deriveUnitFromSR(d$5,t.spatialReference):null}function h$6(e){return "heightModelInfo"in e}function u$7(e){if("unknown"===e.type||!("capabilities"in e))return !1;switch(e.type){case"csv":case"feature":case"geojson":case"ogc-feature":return !0;case"imagery":case"map-image":case"map-notes":case"tile":case"vector-tile":case"scene":case null:default:return !1}}function m$8(e){return u$7(e)?!!(e.capabilities&&e.capabilities.data&&e.capabilities.data.supportsZ):g$6(e)}function f$3(e){return null!=e.layers||g$6(e)||u$7(e)||h$6(e)}function g$6(e){switch(e.type){case"building-scene":case"elevation":case"integrated-mesh":case"point-cloud":case"scene":return !0;case"base-dynamic":case"base-elevation":case"base-tile":case"bing-maps":case"csv":case"geojson":case"feature":case"geo-rss":case"graphics":case"group":case"imagery":case"imagery-tile":case"kml":case"map-image":case"map-notes":case"ogc-feature":case"open-street-map":case"route":case"stream":case"tile":case"unknown":case"unsupported":case"vector-tile":case"wcs":case"web-tile":case"wms":case"wmts":case null:return !1}return !1}const d$5=new v$a({heightModel:"gravity-related-height"});

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
var f$2;const g$5=n$v.getLogger("esri.views.support.DefaultsFromMap"),_$2=10;let m$7=f$2=class extends u$k{constructor(){super(...arguments),this._handles=new u$j,this._waitTask=null,this._extentProjectController=null,this._spatialReferenceCandidates=null,this._extentCandidates=null,this.logDebugInformation=!1,this.isSpatialReferenceDone=!1,this.isTileInfoDone=!1,this.isHeightModelInfoSearching=!1,this.spatialReference=null,this.extent=null,this.heightModelInfo=null,this.vcsWkid=null,this.latestVcsWkid=null,this.mapCollectionPaths=f$2.DefaultMapCollectionPaths.slice(),this.tileInfo=null;}initialize(){this.watch("mapCollectionPaths",(()=>{this._running&&(this.reset(),this.start());}));}destroy(){this._set("view",null),this._handles&&(this._handles.destroy(),this._handles=null),this._cancelLoading();}get _running(){return !!(this._handles&&this._handles.size>0)}reset(){this._handles.removeAll(),this._set("isSpatialReferenceDone",!1),this._set("isTileInfoDone",!1),this._set("isHeightModelInfoSearching",!1),this._set("spatialReference",null),this._set("extent",null),this._set("heightModelInfo",null),this._set("vcsWkid",null),this._set("latestVcsWkid",null),this._set("tileInfo",null),this._spatialReferenceCandidates=null,this._extentCandidates=null;}start(){this._handles.removeAll();const e=this._updateLayerChange.bind(this);for(const t of this.mapCollectionPaths)this._handles.add(C$7(this.view,`map.${t}`,"change",e,e,e,!0));this._handles.add(y$h(this,"isSpatialReferenceDone",(()=>this._updateTileInfo()),!0));}_ownerNameFromCollectionName(e){const t=e.lastIndexOf(".");return -1===t?"view":"view."+e.slice(0,t)}_ensureLoadedOwnersFromCollectionName(e){const t=this._ownerNameFromCollectionName(e).split(".");let i;for(let s=0;s<t.length&&(i=this.get(t.slice(0,s+1).join(".")),i);s++)if(i.load&&!i.isFulfilled())return {collectionName:e,owner:null,loading:i.load().catch((()=>{}))};return {collectionName:e,owner:i}}_cancelLoading(){this._waitTask=null,this._extentProjectController&&(this._extentProjectController.abort(),this._extentProjectController=null);}_updateWhen(e){let t=!0,i=!1;const s=e.catch((()=>{})).then((()=>{t?i=!0:s===this._waitTask&&this._update();}));return t=!1,i||(this._waitTask=s),i}_updateLayerChange(){this.isSpatialReferenceDone&&!this.spatialReference&&this._set("isSpatialReferenceDone",!1),this._update();}_update(){if(this._cancelLoading(),this.view){if(!this.isSpatialReferenceDone){this._debugLog("Starting search for spatial reference...");const e=this._processMapCollections((e=>this._processSpatialReferenceSource(e)));if(this._debugLog(`Search ended with status '${y$4(e)}'`),0!==e){let e=null,t=this._spatialReferenceCandidates;if(!t||t.length<1?(e=this.defaultSpatialReference,this._debugLog(`No spatial reference found, locking to default (${S$1(e)})`)):(this.defaultSpatialReference&&t.length>1&&t.findIndex((e=>e.equals(this.defaultSpatialReference)))>-1&&(t=[this.defaultSpatialReference]),e=t[0],this._debugLog(`Locking to ${S$1(e)}`)),this._set("spatialReference",e),e)if(this.extent)this._set("isSpatialReferenceDone",!0);else {const t=this.logDebugInformation;this.logDebugInformation=!1,this._processMapCollections((t=>this._findExtent(t,e))),this.logDebugInformation=t,this._projectExtentCandidate().catch((()=>{})).then((()=>this._set("isSpatialReferenceDone",!0)));}else this._set("isSpatialReferenceDone",!0);}}if(null==this.heightModelInfo&&this.view.isHeightModelInfoRequired){this._debugLog("Starting search for height model info...");const e=this._processMapCollections((e=>this._processHeightModelInfoSource(e)),(e=>f$3(e)));this._debugLog(`Search ended with status ${y$4(e)}`),this._set("isHeightModelInfoSearching",0===e);}this._updateTileInfo();}}_processMapCollections(e,t){this._preloadMapCollections(t);let i=2;return this._forAllMapCollectionSources((e=>{if(2!==i)return !1;const{collectionName:t}=e;return this._debugLog(`Processing collection ${t}...`),!(e.loading&&!this._updateWhen(e.loading))||(this._debugLog(`Collection ${e.collectionName} owner is loading -> wait`),i=0,!1)}),(s=>{if(2!==i)return !1;return null!=t&&!t(s)?(this._debugLog(`Source ${s.id} is skipped due to predicate`),!1):!s.load||s.isFulfilled()||this._updateWhen(s.load())?!((!s.load||s.isResolved())&&e(s))||(i=1,!1):(this._debugLog(`Source ${s.id} is loading -> wait`),i=0,!1)})),i}_preloadMapCollections(e){let t=_$2;const i=this.logDebugInformation;this.logDebugInformation=!1,this._forAllMapCollectionSources((()=>!0),(s=>{if(0===t)return !1;return !(null!=e&&!e(s))&&(s.load&&!s.isFulfilled()&&(this.logDebugInformation=i,this._debugLog(`Pre-loading source ${s.id}`),this.logDebugInformation=!1,s.load().catch((()=>{})),t--),!0)})),this.logDebugInformation=i;}_forAllMapCollectionSources(e,t){for(const i of this.mapCollectionPaths){const s=`map.${i}`,o=this._ensureLoadedOwnersFromCollectionName(s);if(!1===e(o))continue;const n=o.owner;if(!n||n.isRejected&&n.isRejected()){this._debugLog(`Collection ${s} owner is invalid or rejected -> skip`);continue}const a=this.view.get(s);a?this._forEachSource(a,t):this._debugLog(`Collection ${s} does not exist -> skip`);}}_forEachSource(e,t){for(const i of e.items)!1!==t(i)&&"layers"in i&&i.layers&&this._forEachSource(i.layers,t);}_processSpatialReferenceSource(e){let t=this._getSupportedSpatialReferences(e);return 0!==t.length&&(this._spatialReferenceCandidates?(t=s$q(t,this._spatialReferenceCandidates,((e,t)=>e.equals(t))),t.length>0?this._spatialReferenceCandidates=t:this._debugLog(`Layer ${e.id} is ignored because its supported spatial\n          references are not compatible with the previous candidates`)):this._spatialReferenceCandidates=t,1===this._spatialReferenceCandidates.length)}_findExtent(e,t){const i="fullExtents"in e&&e.fullExtents||(e.fullExtent?[e.fullExtent]:[]),s=i.find((e=>e.spatialReference.equals(t)));if(s)return this._set("extent",s),!0;if(this._getSupportedSpatialReferences(e).length>0){const t=i.map((t=>({extent:t,layer:e}))),s=this._extentCandidates||[];this._extentCandidates=s.concat(t);}return !1}async _projectExtentCandidate(){if(!this._extentCandidates||!this._extentCandidates.length)return;const e=this.spatialReference,t=this._extentCandidates.find((t=>x$4(t.extent.spatialReference,e)));if(t)this._set("extent",g$h(t.extent,e));else {const t=this._extentCandidates[0];this._extentProjectController=a$m();const i=await import('./geometryServiceUtils-84553cc9.js');try{const s=await i.projectGeometry(t.extent,e,t.layer.portalItem,this._extentProjectController.signal);this._set("extent",s);}catch{}this._extentProjectController=null;}}_getSupportedSpatialReferences(e){const t="supportedSpatialReferences"in e&&e.supportedSpatialReferences||(e.spatialReference?[e.spatialReference]:[]);if(0===t.length)return this._debugLog(`Layer ${e.id} is ignored because it does not have any spatial references`),[];const i=t.filter((t=>this.view.isSpatialReferenceSupported(t,e,(e=>this._debugLog(e)))));return 0===i.length?this._debugLog(`Layer ${e.id} has spatial references but none of them are supported (or layer doesn't require locking)`):this._debugLog(`Layer ${e.id} has spatial references. Resulting candidate set: ${i.map(S$1).join(", ")}`),i}_processHeightModelInfoSource(e){const t=l$8(e);return !!t&&(this._set("heightModelInfo",t),this._set("isHeightModelInfoSearching",!1),e.spatialReference&&(this._set("vcsWkid",e.spatialReference.vcsWkid),this._set("latestVcsWkid",e.spatialReference.latestVcsWkid)),!0)}_updateTileInfo(){if(null!=this.tileInfo)return;if(!this.view.isTileInfoRequired())return void this._set("isTileInfoDone",!0);if(!this.isSpatialReferenceDone)return;const e=this.get("view.map");if(!e)return void this._debugLog("updateTileInfo: no map");const t=e.basemap,i=e.get("layers.0");let s=null;if(t&&"failed"!==t.loadStatus){if(!t.loaded)return this._updateWhen(t.load()),void this._debugLog("updateTileInfo: basemap still loading");const e=t&&t.get("baseLayers.0");if(e&&"failed"!==e.loadStatus){if(!e.loaded)return this._updateWhen(e.load()),void this._debugLog("updateTileInfo: first basemap layer still loading");s="tileInfo"in e&&e.tileInfo;}else {if(!i||"failed"===i.loadStatus)return this._debugLog("updateTileInfo: no tileInfo"),void this._set("isTileInfoDone",!0);if(!i.loaded)return this._updateWhen(i.load()),void this._debugLog("updateTileInfo: first operational layer still loading");s="tileInfo"in i&&i.tileInfo;}}else if(i&&"failed"!==i.loadStatus){if(!i.loaded)return this._updateWhen(i.load()),void this._debugLog("updateTileInfo: first operational layer still loading");s="tileInfo"in i&&i.tileInfo;}s&&!s.spatialReference.equals(this.spatialReference)&&(s=null),this._debugLog(`updateTileInfo: setting ${s}`),this._set("tileInfo",s),this._set("isTileInfoDone",!0);}_debugLog(e){this.logDebugInformation&&g$5.info(e);}};function S$1(e){return e?JSON.stringify(e.toJSON()):"undefined"}function y$4(e){switch(e){case 0:return "Waiting";case 1:return "Found";case 2:return "Exhausted"}}m$7.DefaultMapCollectionPaths=["basemap.baseLayers","layers","ground.layers","basemap.referenceLayers"],e$e([y$e()],m$7.prototype,"logDebugInformation",void 0),e$e([y$e({readOnly:!0})],m$7.prototype,"isSpatialReferenceDone",void 0),e$e([y$e({readOnly:!0})],m$7.prototype,"isTileInfoDone",void 0),e$e([y$e({readOnly:!0})],m$7.prototype,"isHeightModelInfoSearching",void 0),e$e([y$e({constructOnly:!0})],m$7.prototype,"view",void 0),e$e([y$e({readOnly:!0})],m$7.prototype,"spatialReference",void 0),e$e([y$e({readOnly:!0})],m$7.prototype,"extent",void 0),e$e([y$e({readOnly:!0})],m$7.prototype,"heightModelInfo",void 0),e$e([y$e({readOnly:!0})],m$7.prototype,"vcsWkid",void 0),e$e([y$e({readOnly:!0})],m$7.prototype,"latestVcsWkid",void 0),e$e([y$e()],m$7.prototype,"mapCollectionPaths",void 0),e$e([y$e()],m$7.prototype,"defaultSpatialReference",void 0),e$e([y$e({readOnly:!0})],m$7.prototype,"tileInfo",void 0),m$7=f$2=e$e([i$o("esri.views.support.DefaultsFromMap")],m$7);var I=m$7;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
var z;const H$1=n$v.getLogger("esri.views.View");let W$2=z=class extends(a$l(n$y.EventedMixin(n$A(u$k)))){constructor(e){super(e),this._userSpatialReference=null,this._cursor=null,this.allLayerViews=new l$n({root:this,rootCollectionNames:["basemapView.baseLayerViews","groundView?.layerViews","layerViews","basemapView.referenceLayerViews"],getChildrenFunction:e=>e.layerViews}),this.animation=null,this.basemapView=null,this.defaultsFromMap=new I({view:this}),this.fatalError=null,this.extent=null,this.graphics=new m$o,this.navigating=!1,this.layerViews=new L$5,this.magnifier=new p$h,this.padding={left:0,top:0,right:0,bottom:0},this.ready=!1,this.spatialReferenceWarningDelay=1e3,this.supportsGround=!0,this.timeExtent=null,this.type=null,this.scale=null,this.updating=!1,this.initialExtentRequired=!0,this.renderContext=null,this.input=new c$b,this.navigation=new a$c,this.layerViewManager=null,this.refreshManager=null,this.isHeightModelInfoRequired=!1,this.width=null,this.height=null,this.resizing=!1,this.suspended=!1,this.viewEvents=new p$f(this),this.persistableViewModels=new L$5,this._isValid=!1,this._readyCycleForced=!1,this.handles.add(this.watch("preconditionsReady",(e=>{e?(this._currentSpatialReference=this.spatialReference,z.views.add(this)):(this._currentSpatialReference=null,z.views.remove(this)),this.notifyChange("spatialReference"),!e&&this.ready?(this.layerViewManager.clear(),this.toolViewManager.detach(),this._teardown()):e&&!this.ready&&(this._startup(),this.toolViewManager.attach());}),!0));}initialize(){let e;this.addResolvingPromise(this.validate().then((()=>(this._isValid=!0,j$6(this,"ready"))))),this.basemapView=new p$i({view:this}),this.layerViewManager=new M$1({view:this,layerViewImporter:{importLayerView:e=>this.importLayerView(e),hasLayerViewModule:e=>this.hasLayerViewModule(e)},supportsGround:this.supportsGround}),this.refreshManager=new h$8({view:this}),this.toolViewManager=new S$2({view:this}),this.analysisManager=new m$9({viewFactory:e=>this.createAnalysisView(e),controllerFactory:e=>this.createAnalysisController(e)}),this._resetInitialViewPropertiesFromContent(),d$f(this.defaultsFromMap,"isSpatialReferenceDone",(t=>{const i=!!(this.map&&this.map.allLayers.length>0);if(t&&!this.spatialReference&&i||!e){if(t&&!this.spatialReference&&i&&!e){const t=e=C$8(this.spatialReferenceWarningDelay);e.then((()=>{t===e&&H$1.warn("#spatialReference","no spatial reference could be derived from the currently added map layers");})).catch((()=>{}));}}else e=null;}),!0);}destroy(){if(this.destroyed)return;this.viewEvents.destroy(),this.allLayerViews.destroy(),this.navigation&&(this.navigation.destroy(),this._set("navigation",null)),this.graphics.destroy(),this.graphics=null,this.handles.remove("defaultsFromMap"),this.defaultsFromMap.destroy(),this._set("defaultsFromMap",null),this.toolViewManager.destroy(),this.toolViewManager=null,this.refreshManager.destroy(),this.refreshManager=null,this.layerViewManager.destroy(),this.layerViewManager=null,this.basemapView.destroy(),this.basemapView=null,this.invalidate(),this._emitter.clear(),this.handles.removeAll();const e=this.map;this.map=null,null==e||e.destroy();}_startup(){this._set("ready",!0);}_teardown(){this._set("ready",!1);}whenReady(){return Promise.resolve(this)}toMap(){return H$1.error("#toMap()","Not implemented on this instance of View"),null}get heightModelInfo(){return this.getDefaultHeightModelInfo()}get interacting(){return this.navigating}get preconditionsReady(){return !!(!this.fatalError&&this._isValid&&!this._readyCycleForced&&this.map&&(!f$d.isLoadable(this.map)||this.map.loaded)&&0!==this.width&&0!==this.height&&this.spatialReference&&this.isSpatialReferenceSupported(this.spatialReference)&&(this._currentSpatialReference||!this.initialExtentRequired||this.initialExtent||this.defaultsFromMap&&this.defaultsFromMap.isSpatialReferenceDone)&&this.defaultsFromMap&&this.defaultsFromMap.isTileInfoDone)}set map(e){var t;e!==this._get("map")&&(null!=(t=e)&&t.destroyed&&(H$1.warn("#map","The provided map is already destroyed",{map:e}),e=null),f$d.isLoadable(e)&&e.load().catch((()=>{})),this.initialized&&(this.forceReadyCycle(),this._resetInitialViewPropertiesFromContent()),this._set("map",e));}get spatialReference(){let e=this._userSpatialReference||this._currentSpatialReference||this.getDefaultSpatialReference()||null;return e&&this.isHeightModelInfoRequired&&this.defaultsFromMap&&(e=e.clone(),e.vcsWkid=this.defaultsFromMap.vcsWkid,e.latestVcsWkid=this.defaultsFromMap.latestVcsWkid),e}set spatialReference(e){this._userSpatialReference=e,this._set("spatialReference",e);}get stationary(){return !this.animation&&!this.navigating&&!this.resizing}get initialExtent(){return this.defaultsFromMap&&this.defaultsFromMap.extent}get cursor(){const e=this.toolViewManager?this.toolViewManager.cursor:null;return r$f(e)?e:this._cursor||"default"}set cursor(e){this._cursor=e,this.notifyChange("cursor");}get size(){return [this.width,this.height]}whenLayerView(e){return this.layerViewManager.whenLayerView(e)}getAnalysisView(e){return this.analysisManager.getAnalysisView(e)}whenAnalysisView(e){return this.analysisManager.whenAnalysisView(e)}getDefaultSpatialReference(){return this.get("defaultsFromMap.spatialReference")}getDefaultHeightModelInfo(){return this.get("map.supportsHeightModelInfo")&&this.get("map.heightModelInfo")||this.get("defaultsFromMap.heightModelInfo")||null}importLayerView(e){throw new s$n("importLayerView() not implemented")}hasLayerViewModule(e){return !1}async createAnalysisView(e){throw new s$n("createAnalysisView() not implemented")}async createAnalysisController(e){throw new s$n("createAnalysisController() not implemented")}async validate(){}invalidate(){this._isValid=!1;}isSpatialReferenceSupported(e,t,i){return !0}isTileInfoRequired(){return !1}when(e,t){return this.isResolved()&&!this.ready&&H$1.warn("#when()",'Calling view.when() while the view is no longer ready but was already resolved once will resolve immediately. Use watchUtils.whenOnce(view, "ready").then(...) instead.'),super.when(e,t)}forceReadyCycle(){this.ready&&(this._readyCycleForced=!0,$$4(this,"preconditionsReady",(()=>this._readyCycleForced=!1)));}createTool(e,t,i){return this.toolViewManager.createTool(e,t,i)}tryFatalErrorRecovery(){this.fatalError=null;}_resetInitialViewPropertiesFromContent(){if(!this.defaultsFromMap)return;const e=()=>this.defaultsFromMap&&this.defaultsFromMap.start();this.defaultsFromMap.reset(),this._currentSpatialReference=null,this.notifyChange("spatialReference"),this.handles.remove("defaultsFromMap"),this.handles.add([h$g(this,"spatialReference",((t,i)=>{d$l(t,i)||e();})),h$g(this,"initialExtentRequired",e),k$6(e)],"defaultsFromMap");}};W$2.views=new L$5,e$e([o$j("toolViewManager.activeTool")],W$2.prototype,"activeTool",void 0),e$e([y$e({readOnly:!0})],W$2.prototype,"allLayerViews",void 0),e$e([y$e()],W$2.prototype,"animation",void 0),e$e([y$e()],W$2.prototype,"basemapView",void 0),e$e([y$e()],W$2.prototype,"defaultsFromMap",void 0),e$e([y$e()],W$2.prototype,"fatalError",void 0),e$e([y$e({type:M$7})],W$2.prototype,"extent",void 0),e$e([y$e(u$q())],W$2.prototype,"graphics",void 0),e$e([y$e({readOnly:!0,type:v$a,dependsOn:["map.heightModelInfo?","defaultsFromMap.heightModelInfo"]})],W$2.prototype,"heightModelInfo",null),e$e([y$e({readOnly:!0})],W$2.prototype,"interacting",null),e$e([y$e({readOnly:!0})],W$2.prototype,"navigating",void 0),e$e([y$e({readOnly:!0,dependsOn:["fatalError","_isValid","_readyCycleForced","map","map.loaded?","width","height","spatialReference","_currentSpatialReference","initialExtentRequired","initialExtent","defaultsFromMap.isSpatialReferenceDone","defaultsFromMap.isTileInfoDone"]})],W$2.prototype,"preconditionsReady",null),e$e([y$e({type:L$5,readOnly:!0})],W$2.prototype,"layerViews",void 0),e$e([y$e({type:p$h})],W$2.prototype,"magnifier",void 0),e$e([y$e({value:null,type:g$i})],W$2.prototype,"map",null),e$e([y$e()],W$2.prototype,"padding",void 0),e$e([y$e({readOnly:!0})],W$2.prototype,"ready",void 0),e$e([y$e({type:k$7})],W$2.prototype,"spatialReference",null),e$e([y$e()],W$2.prototype,"spatialReferenceWarningDelay",void 0),e$e([y$e()],W$2.prototype,"stationary",null),e$e([y$e({readOnly:!0})],W$2.prototype,"supportsGround",void 0),e$e([y$e({type:d$m})],W$2.prototype,"timeExtent",void 0),e$e([o$j("toolViewManager.tools")],W$2.prototype,"tools",void 0),e$e([y$e()],W$2.prototype,"toolViewManager",void 0),e$e([o$j("analysisManager.analyses")],W$2.prototype,"analyses",void 0),e$e([y$e()],W$2.prototype,"analysisManager",void 0),e$e([y$e({readOnly:!0})],W$2.prototype,"type",void 0),e$e([y$e({type:Number})],W$2.prototype,"scale",void 0),e$e([y$e({readOnly:!0})],W$2.prototype,"updating",void 0),e$e([y$e({readOnly:!0})],W$2.prototype,"initialExtentRequired",void 0),e$e([y$e({readOnly:!0,type:M$7})],W$2.prototype,"initialExtent",null),e$e([y$e()],W$2.prototype,"cursor",null),e$e([y$e()],W$2.prototype,"renderContext",void 0),e$e([y$e({readOnly:!0})],W$2.prototype,"input",void 0),e$e([y$e({type:a$c,nonNullable:!0})],W$2.prototype,"navigation",void 0),e$e([y$e()],W$2.prototype,"layerViewManager",void 0),e$e([y$e()],W$2.prototype,"width",void 0),e$e([y$e()],W$2.prototype,"height",void 0),e$e([y$e({readOnly:!0})],W$2.prototype,"resizing",void 0),e$e([y$e({value:null,readOnly:!0})],W$2.prototype,"size",null),e$e([y$e({readOnly:!0})],W$2.prototype,"suspended",void 0),e$e([y$e({readOnly:!0})],W$2.prototype,"viewEvents",void 0),e$e([y$e({readOnly:!0})],W$2.prototype,"persistableViewModels",void 0),e$e([y$e()],W$2.prototype,"_isValid",void 0),e$e([y$e()],W$2.prototype,"_readyCycleForced",void 0),e$e([y$e()],W$2.prototype,"_currentSpatialReference",void 0),W$2=z=e$e([i$o("esri.views.View")],W$2);var P$1=W$2;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
let p$a=class extends m$p{constructor(t){super(t),this.state="running",this.target=null;}initialize(){this.addResolvingPromise(new Promise(((t,e)=>this._dfd={resolve:t,reject:e})));}get done(){return "finished"===this.state||"stopped"===this.state}stop(){"stopped"!==this.state&&"finished"!==this.state&&(this._set("state","stopped"),this._dfd.reject(new s$n("ViewAnimation stopped")));}finish(){"stopped"!==this.state&&"finished"!==this.state&&(this._set("state","finished"),this._dfd.resolve());}update(t,e){e||(e=S$8(t)?"waiting-for-target":"running"),this._set("target",t),this._set("state",e);}};e$e([y$e({readOnly:!0})],p$a.prototype,"done",null),e$e([y$e({readOnly:!0,type:String})],p$a.prototype,"state",void 0),e$e([y$e()],p$a.prototype,"target",void 0),p$a=e$e([i$o("esri.views.ViewAnimation")],p$a),function(t){t.State={RUNNING:"running",STOPPED:"stopped",FINISHED:"finished",WAITING_FOR_TARGET:"waiting-for-target"};}(p$a||(p$a={}));var n$f=p$a;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
function e$7(){return [1,0,0,1,0,0]}function r$7(e){return [e[0],e[1],e[2],e[3],e[4],e[5]]}function n$e(e,r,n,t,a,o){return [e,r,n,t,a,o]}function t$8(e,r){return new Float64Array(e,r,6)}Object.freeze({__proto__:null,create:e$7,clone:r$7,fromValues:n$e,createView:t$8});

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const W$1=39.37,C$3=180/Math.PI;function U(t,e,n){const r=s$s(e[0]/s$r.radius);return r$i(t,n?r:r-360*Math.floor((r+180)/360),s$s(.5*Math.PI-2*Math.atan(Math.exp(-1*e[1]/s$r.radius))))}function Q(t,e){let n=e[1];return n>89.99999?n=89.99999:n<-89.99999&&(n=-89.99999),n=Math.sin(r$j(n)),r$i(t,r$j(e[0])*s$r.radius,.5*s$r.radius*Math.log((1+n)/(1-n)))}function B(t,e,n,r){return r&&n&&!r.equals(n)&&x$4(r,n)&&r.isWebMercator?r.isWebMercator?Q(t,e):U(t,e):a$p(t,e)}function D(t){return t.wkid?t:t.spatialReference||k$7.WGS84}function T(t,e){return e.type?r$i(t,e.x,e.y):a$p(t,e)}function H(t){return G$4(t)}function J(t,e){return Math.max(t.width/e[0],t.height/e[1])*ct(t.spatialReference)}async function K(r,o,a,s){let y,p;if(!r)return null;if(Array.isArray(r)&&!r.length)return null;if(L$5.isCollection(r)&&(r=r.toArray()),Array.isArray(r)&&r.length&&"object"==typeof r[0]){const e=r.every((t=>"attributes"in t)),n=r.some((t=>!t.geometry));let i=r;if(e&&n&&o&&o.allLayerViews){const e=new Map;for(const t of r){const n=t.layer,r=e.get(n)||[],o=t.attributes[n.objectIdField];null!=o&&r.push(o),e.set(n,r);}const n=[];e.forEach(((t,e)=>{const r=o.allLayerViews.find((t=>t.layer.id===e.id));if("queryFeatures"in r){const o=e.createQuery();o.objectIds=t,o.returnGeometry=!0,n.push(r.queryFeatures(o));}}));const a=await Promise.all(n),s=[];for(const r of a)if(r&&r.features&&r.features.length)for(const e of r.features)r$f(e.geometry)&&s.push(e.geometry);i=s;}for(const t of i)s=await K(t,o,a,s);return s}if(Array.isArray(r)&&2===r.length&&"number"==typeof r[0]&&"number"==typeof r[1])y=new j$5(r);else if(r instanceof c$A)y=r;else if("geometry"in r)if(r.geometry)y=r.geometry;else if(r.layer){const t=r.layer,n=o.allLayerViews.find((e=>e.layer.id===t.id));if("queryFeatures"in n){const o=t.createQuery();o.objectIds=[r.attributes[t.objectIdField]],o.returnGeometry=!0;const a=await n.queryFeatures(o);y=g$j(a,"features",0,"geometry");}}if(t$f(y))return null;if(p="point"===y.type?new M$7({xmin:y.x,ymin:y.y,xmax:y.x,ymax:y.y,spatialReference:y.spatialReference}):y.extent,!p)return null;const g=x$4(p,a);if(!p.spatialReference.equals(a)&&g)p=g$h(p,a);else if(!g)return null;return s=s?s.union(p):p.clone()}function X(t){if(t&&(!Array.isArray(t)||"number"!=typeof t[0])&&("object"==typeof t||Array.isArray(t)&&"object"==typeof t[0])){if("layer"in t&&t.layer&&t.layer.minScale&&t.layer.maxScale){const e=t.layer;return {min:e.minScale,max:e.maxScale}}if(Array.isArray(t)&&t.length&&t.every((t=>"layer"in t))){let e=0,n=0;for(const r of t){const t=r.layer;t&&t.minScale&&t.maxScale&&(e=t.minScale<e?t.minScale:e,n=t.maxScale>n?t.maxScale:n);}return e&&n?{min:e,max:n}:null}}}async function Y(e,n){if(!e||!n)return new u$9({targetGeometry:new j$5,scale:0,rotation:0});let r=n.spatialReference;const{constraints:o,padding:a,viewpoint:i,size:s}=n,m=[a?s[0]-a.left-a.right:s[0],a?s[1]-a.top-a.bottom:s[1]];let y=null;e instanceof u$9?y=e:e.viewpoint?y=e.viewpoint:e.target&&"esri.Viewpoint"===e.target.declaredClass&&(y=e.target);let p=null;y&&y.targetGeometry?p=y.targetGeometry:e instanceof M$7?p=e:(e||e&&("center"in e||"extent"in e||"target"in e))&&(p=await K(e.center,n,r)||await K(e.extent,n,r)||await K(e.target,n,r)||await K(e,n,r)),!p&&i&&i.targetGeometry?p=i.targetGeometry:!p&&n.extent&&(p=n.extent);const h=D(p);if(r||(r=D(n.spatialReference||n.extent||p)),!x$4(p,r)&&h&&!h.equals(r))return null;const b=T(n$B(),p.center?p.center:p),d=new j$5(B(b,b,h,r),r);let w=null;w=y&&r$f(y.targetGeometry)&&"point"===y.targetGeometry.type?y.scale:e.hasOwnProperty("scale")&&e.scale?e.scale:e.hasOwnProperty("zoom")&&-1!==e.zoom&&o&&o.effectiveLODs?o.zoomToScale(e.zoom):Array.isArray(p)||"point"===p.type||"extent"===p.type&&0===p.width&&0===p.height?n.extent&&x$4(n.extent,r)?J(g$h(n.extent,r),m):n.extent?J(n.extent,m):i.scale:x$4(p.extent,r)?J(g$h(p.extent,r),m):J(p.extent,m);const j=X(e);j&&(j.min&&j.min>w?w=j.min:j.max&&j.max<w&&(w=j.max));let G=0;y?G=y.rotation:e.hasOwnProperty("rotation")?G=e.rotation:i&&(G=i.rotation);let M=new u$9({targetGeometry:d,scale:w,rotation:G});return o&&(M=o.fit(M),o.constrainByGeometry(M),o.rotationEnabled||(M.rotation=G)),M}function Z(t,e){const n=t.targetGeometry,r=e.targetGeometry;return n.x=r.x,n.y=r.y,n.spatialReference=r.spatialReference,t.scale=e.scale,t.rotation=e.rotation,t}function $(t,e,n){return n?r$i(t,.5*(e[0]-n.right+n.left),.5*(e[1]-n.bottom+n.top)):l$o(t,e,.5)}const _$1=function(){const t=n$B();return function(e,n,r){const o=n.targetGeometry;T(t,o);const a=.5*at(n);return e.xmin=t[0]-a*r[0],e.ymin=t[1]-a*r[1],e.xmax=t[0]+a*r[0],e.ymax=t[1]+a*r[1],e.spatialReference=o.spatialReference,e}}();function tt(t,e,n,r,o){return wt(t,e,n.center),t.scale=J(n,r),o&&o.constraints&&o.constraints.constrain(t),t}function et(t,e,n,r){return mt(t,e,n,r),r$k(t,t)}const rt=function(){const t=n$B();return function(e,n,r){return C$a(e,ut(e,n),$(t,n,r))}}(),ot=function(){const t=e$7(),e=n$B();return function(n,r,o,a){const i=at(r),s=st(r);return r$i(e,i,i),M$8(t,e),c$z(t,t,s),i$t(t,t,rt(e,o,a)),i$t(t,t,[0,a.top-a.bottom]),r$i(n,t[4],t[5])}}();function at(t){return t.scale*it(t.targetGeometry)}function it(e){return r$f(e)&&s$t(e.spatialReference)?1/(H(e.spatialReference)*W$1*ft()):1}function st(t){return r$j(t.rotation)||0}function ct(t){return s$t(t)?H(t)*W$1*ft():1}function ut(t,e){return l$o(t,e,.5)}function ft(){return 96}const lt=function(){const t=n$B(),e=n$B(),n=n$B();return function(r,o,a,i,s,c){return p$A(t,o),l$o(e,a,.5*c),r$i(n,1/i*c,-1/i*c),n$C(r),i$t(r,r,e),s&&c$z(r,r,s),e$n(r,r,n),i$t(r,r,t),r}}(),mt=function(){const t=n$B();return function(e,n,r,o){const a=at(n),i=st(n);return T(t,n.targetGeometry),lt(e,t,r,a,i,o)}}(),yt=function(){const t=n$B();return function(e,n,r,o){const a=at(n);return T(t,n.targetGeometry),lt(e,t,r,a,0,o)}}();function pt(t){if(t.isWrappable){const e=S$9(t);return e.valid[1]-e.valid[0]}return 0}function gt(t,e){return Math.round(pt(t)/e)}function ht(t,e){return Y(t,e)}const xt=function(){const t=n$B(),e=n$B(),n=[0,0,0];return function(r,o,a){o$m(t,r,o),g$k(t,t),o$m(e,r,a),g$k(e,e),j$7(n,t,e);let i=Math.acos(_$7(t,e)/(b$b(t)*b$b(e)))*C$3;return n[2]<0&&(i=-i),isNaN(i)&&(i=0),i}}(),bt=function(){const t=n$B();return function(e,n,r,o){const a=e.targetGeometry;return Z(e,n),ot(t,n,r,o),a.x+=t[0],a.y+=t[1],e}}(),wt=function(){const t=n$B();return function(e,n,r){Z(e,n);const o=e.targetGeometry,a=D(r),i=D(o);return T(t,r),B(t,t,a,i),o.x=t[0],o.y=t[1],e}}();const Gt=function(){const t=n$B();return function(e,n,r,o,a){a||(a="center"),C$a(t,r,o),l$o(t,t,.5);const i=t[0],s=t[1];switch(a){case"center":r$i(t,0,0);break;case"left":r$i(t,-i,0);break;case"top":r$i(t,0,s);break;case"right":r$i(t,i,0);break;case"bottom":r$i(t,0,-s);break;case"top-left":r$i(t,-i,s);break;case"bottom-left":r$i(t,-i,-s);break;case"top-right":r$i(t,i,s);break;case"bottom-right":r$i(t,i,-s);}return Ft(e,n,t),e}}();function Mt(t,e,n){return Z(t,e),t.rotation+=n,t}function At(t,e,n){return Z(t,e),t.rotation=n,t}const Rt=function(){const t=n$B();return function(e,n,r,o,a){return Z(e,n),isNaN(r)||0===r||(qt(t,o,n,a),e.scale=n.scale*r,Pt(t,t,e,a),Ft(e,e,r$i(t,t[0]-o[0],o[1]-t[1]))),e}}();function kt(t,e,n){return Z(t,e),t.scale=n,t}const St=function(){const t=n$B();return function(e,n,r,o,a,i){return Z(e,n),isNaN(r)||0===r||(qt(t,a,n,i),e.scale=n.scale*r,e.rotation+=o,Pt(t,t,e,i),Ft(e,e,r$i(t,t[0]-a[0],a[1]-t[1]))),e}}(),vt=function(){const t=n$B(),e=n$B();return function(n,r,o,a,i,s,c){return rt(e,s,c),s$u(t,i,e),a?St(n,r,o,a,t,s):Rt(n,r,o,t,s)}}(),qt=function(){const t=e$7();return function(e,n,r,o){return D$4(e,n,et(t,r,o,1))}}(),Pt=function(){const t=e$7();return function(e,n,r,o){return D$4(e,n,mt(t,r,o,1))}}(),Ft=function(){const t=n$B(),e=e$7();return function(n,r,o){Z(n,r);const a=at(r),i=n.targetGeometry;return h$i(e,st(r)),e$n(e,e,t$k(a,a)),D$4(t,o,e),i.x+=t[0],i.y+=t[1],n}}();

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
class c$a{constructor(t,i,s,e){const o=t.targetGeometry,n=i.targetGeometry;e?"string"==typeof e&&(e=r$l(e)||t$l.ease):e=t$l.ease,this.easing=e,this.duration=s,this.sCenterX=o.x,this.sCenterY=o.y,this.sScale=t.scale,this.sRotation=t.rotation,this.tCenterX=n.x,this.tCenterY=n.y,this.tScale=i.scale,this.tRotation=i.rotation,this.dCenterX=this.tCenterX-this.sCenterX,this.dCenterY=this.tCenterY-this.sCenterY,this.dScale=this.tScale-this.sScale,this.dRotation=this.tRotation-this.sRotation,this.dRotation>180?this.dRotation-=360:this.dRotation<-180&&(this.dRotation+=360);}applyRatio(t,i){const s=this.easing(i);let e,o,n,a;i>=1?(e=this.tCenterX,o=this.tCenterY,n=this.tRotation,a=this.tScale):(e=this.sCenterX+s*this.dCenterX,o=this.sCenterY+s*this.dCenterY,n=this.sRotation+s*this.dRotation,a=this.sScale+s*this.dScale),t.targetGeometry.x=e,t.targetGeometry.y=o,t.scale=a,t.rotation=n;}}let m$6=class extends u$k{constructor(t){super(t),this.duration=200,this.transition=null,this.easing=t$l.ease,this.view=null,this.viewpoint=null,this.viewpoint=new u$9({targetGeometry:new j$5,scale:0,rotation:0}),this._updateTask=v$8({postRender:this._postRender.bind(this)}),this._updateTask.pause();}destroy(){this._updateTask.remove(),this._updateTask=null;}animate(t,i,s){this.stop();const e=this.viewpoint;Z(e,i),this.transition=new c$a(this.viewpoint,t.target,s&&s.duration||this.duration,s&&s.easing||this.easing);const o=()=>{this.animation===t&&this._updateTask&&("finished"===t.state&&(this.transition.applyRatio(this.viewpoint,1),this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())),this.animation=null,this.updateFunction=null);};return t.when(o,o),this._startTime=performance.now(),this._updateTask.resume(),this.animation=t,t}animateContinous(t,i){this.stop(),this.updateFunction=i,this.viewpoint=t;const s=new n$f({target:t.clone()}),e=()=>{this.animation===s&&this._updateTask&&(this.animation=null,this.updateFunction=null);};return s.when(e,e),this._startTime=performance.now(),this._updateTask.resume(),this.animation=s,s}stop(){this.animation&&(this.animation.stop(),this.animation=null,this.updateFunction=null);}_postRender(t){const i=this.animation;if(i&&i.state!==n$f.State.STOPPED){if(this.updateFunction)this.updateFunction(this.viewpoint,t.deltaTime);else {const t=(performance.now()-this._startTime)/this.transition.duration,i=t>=1;this.transition.applyRatio(this.viewpoint,t),i&&this.animation.finish();}this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone());}else this._updateTask.pause();}};e$e([y$e()],m$6.prototype,"animation",void 0),e$e([y$e()],m$6.prototype,"duration",void 0),e$e([y$e()],m$6.prototype,"transition",void 0),e$e([y$e()],m$6.prototype,"easing",void 0),e$e([y$e()],m$6.prototype,"view",void 0),e$e([y$e()],m$6.prototype,"viewpoint",void 0),m$6=e$e([i$o("esri.views.2d.AnimationManager")],m$6);var d$4=m$6;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
class a$b{constructor(t){this.view=t,this._frameTaskHandle=null,this._updateRequested=!1,this.stationary=!0,this.updateEnabled=!0,this.animationInProgress=!1,this.prepare=()=>{this._updateParameters.state=this.view.state,this._updateParameters.stationary=this.view.stationary,this._updateParameters.pixelRatio=window.devicePixelRatio,this._updateParameters.renderingOptions=this.view.renderingOptions;},this.update=()=>{if(this._updateRequested=!1,!this.updateEnabled)return;const{basemapView:t,graphicsView:a,labelManager:s,layerViews:i,state:{id:r}}=this.view;t.baseLayerViews.forEach(this._updateLayerView,this),i.forEach(this._updateLayerView,this),t.referenceLayerViews.forEach(this._updateLayerView,this),r$f(s)&&(s.lastUpdateId!==r&&(s.viewChange(),s.lastUpdateId=r),s.updateRequested&&s.processUpdate(this._updateParameters)),r$f(a)&&(a.lastUpdateId!==r&&(a.viewChange(),a.lastUpdateId=r),a.updateRequested&&a.processUpdate(this._updateParameters)),this.animationInProgress||this._updateRequested||this._frameTaskHandle.pause();};}destroy(){this.stop();}start(){this.stationary=this.view.stationary,this._updateParameters={state:this.view.state,pixelRatio:window.devicePixelRatio,stationary:this.stationary,renderingOptions:this.view.renderingOptions},this._stationaryHandle=this.view.watch("stationary",(e=>{this.stationary=e,this.requestFrame();})),this._frameTaskHandle=v$8(this);}stop(){this._frameTaskHandle&&(this._stationaryHandle.remove(),this._frameTaskHandle.remove(),this._updateParameters=this._stationaryHandle=this._frameTaskHandle=null,this.stationary=!0,this.animationInProgress=!1);}requestUpdate(){this._updateRequested||(this._updateRequested=!0,this.requestFrame());}requestFrame(){this._frameTaskHandle&&this._frameTaskHandle.resume();}_updateLayerView(e){const t=this.view.state,a=e.lastUpdateId;null!=a&&(this.stationary||e.moving)||(e.moving=!0,e.moveStart()),a!==t.id&&e.viewChange(),this.stationary&&e.moving&&(e.moving=!1,e.moveEnd()),e.lastUpdateId=t.id,e.updateRequested&&e.processUpdate(this._updateParameters),"layerViews"in e&&e.layerViews.forEach(this._updateLayerView,this);}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
function t$7(){return Promise.all([import('./webgl-02e5f62e.js'),import('./mapViewDeps-cba28061.js')])}const a$a=()=>t$7().then((()=>import('./TileLayerView2D-a32d65d9.js'))),s$b=()=>t$7().then((()=>import('./FeatureLayerView2D-0620f8fc.js'))),i$6={"base-dynamic":()=>t$7().then((()=>import('./BaseDynamicLayerView2D-022143ea.js'))),"base-tile":a$a,"bing-maps":a$a,csv:s$b,"geo-rss":()=>t$7().then((()=>import('./GeoRSSLayerView2D-0ea60715.js'))),feature:s$b,geojson:s$b,graphics:()=>t$7().then((()=>import('./GraphicsLayerView2D-4cd031f8.js'))),group:()=>t$7().then((()=>import('./GroupLayerView2D-d1553a87.js'))),imagery:()=>t$7().then((()=>import('./ImageryLayerView2D-07a818a3.js'))),"imagery-tile":()=>t$7().then((()=>import('./ImageryTileLayerView2D-df35c73e.js'))),kml:()=>t$7().then((()=>import('./KMLLayerView2D-c115bfb8.js'))),"map-image":()=>t$7().then((()=>import('./MapImageLayerView2D-8695f63e.js'))),"map-notes":()=>t$7().then((()=>import('./MapNotesLayerView2D-9c1e7e29.js'))),"ogc-feature":()=>t$7().then((()=>import('./OGCFeatureLayerView2D-18c21576.js'))),"open-street-map":a$a,route:()=>t$7().then((()=>import('./RouteLayerView2D-a6c7d5e6.js'))),stream:()=>t$7().then((()=>import('./StreamLayerView2D-b8e9480e.js'))),tile:a$a,"vector-tile":()=>t$7().then((()=>import('./VectorTileLayerView2D-fbe589ba.js'))),wcs:()=>t$7().then((()=>import('./ImageryTileLayerView2D-df35c73e.js'))),"web-tile":a$a,wms:()=>t$7().then((()=>import('./WMSLayerView2D-67cca2d4.js'))),wmts:()=>t$7().then((()=>import('./WMTSLayerView2D-551d7e28.js'))),"base-elevation":null,"building-scene":null,elevation:null,"integrated-mesh":null,"point-cloud":null,scene:null,unknown:null,unsupported:null};function o$6(e){const t=e.declaredClass?e.declaredClass.slice(e.declaredClass.lastIndexOf(".")+1):"Unknown",a=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();return new s$n(`${a}:view-not-supported`,`${t} is not supported in 2D`)}const n$d={hasLayerViewModule:r=>r$f(i$6[r.type]),importLayerView:r=>{const t=i$6[r.type];if(!r$f(t))throw o$6(r);return t(r)}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
function o$5(o,i){const{spatialReference:m}=i,r=[i.x,i.y];let s=Number.POSITIVE_INFINITY,x=0,c=0;const a=[0,0],f="extent"===o.type?[[[o.xmin,o.ymin],[o.xmin,o.ymax],[o.xmax,o.ymax],[o.xmax,o.ymin],[o.xmin,o.ymin]]]:o.rings;for(const t of f)for(let o=0;o<t.length-1;o++){o$n(a,r,t,o);const i=d$n(r,a);i<s&&(s=i,x=a[0],c=a[1]);}return {coordinate:new j$5({x,y:c,spatialReference:m}),distance:s}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
var y$3;const u$6=n$v.getLogger("esri.views.MapView");let g$4=y$3=class extends u$k{constructor(e){super(e),this.geometry=null,this.spatialReference=null;}get normalizedGeometry(){return this.geometry&&this.spatialReference?this.spatialReference.equals(this.geometry.spatialReference)?this.geometry:x$4(this.geometry,this.spatialReference)?g$h(this.geometry,this.spatialReference):V$3()?H$3(this.geometry,this.spatialReference):(u$6.error("#constraints.geometry","unsupported coordinate system. The source geometry cannot be projected to the view's coordinate system. The projection engine cannot be loaded.",{geometry:this.geometry}),null):null}constrain(e,r){if(!this.normalizedGeometry)return e;const t=e.targetGeometry;if("extent"===this.normalizedGeometry.type?t$m(this.normalizedGeometry,t):f$e(this.normalizedGeometry,t))return e;const{coordinate:o}=o$5(this.normalizedGeometry,t);return o?(e.targetGeometry=o,e):e}clone(){var e,r;return new y$3({geometry:null==(e=this.geometry)?void 0:e.clone(),spatialReference:null==(r=this.spatialReference)?void 0:r.clone()})}};e$e([y$e({constructOnly:!0})],g$4.prototype,"geometry",void 0),e$e([y$e({readOnly:!0})],g$4.prototype,"normalizedGeometry",null),e$e([y$e({constructOnly:!0})],g$4.prototype,"spatialReference",void 0),g$4=y$3=e$e([i$o("esri.views.2d.constraints.GeometryConstraint")],g$4);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
var s$a;let i$5=s$a=class extends u$k{constructor(){super(...arguments),this.enabled=!0,this.rotationEnabled=!0;}constrain(o,r){return this.enabled&&r?(this.rotationEnabled||(o.rotation=r.rotation),o):o}clone(){return new s$a({enabled:this.enabled,rotationEnabled:this.rotationEnabled})}};e$e([y$e()],i$5.prototype,"enabled",void 0),e$e([y$e()],i$5.prototype,"rotationEnabled",void 0),i$5=s$a=e$e([i$o("esri.views.2d.constraints.RotationConstraint")],i$5);var a$9=i$5;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
var a$8;let c$9=a$8=class extends u$k{constructor(e){super(e),this._lodByScale={},this._scales=[],this.effectiveLODs=null,this.effectiveMinZoom=-1,this.effectiveMaxZoom=-1,this.effectiveMinScale=0,this.effectiveMaxScale=0,this.lods=null,this.minZoom=-1,this.maxZoom=-1,this.minScale=0,this.maxScale=0,this.snapToZoom=!0;}initialize(){let e,{lods:t,minScale:o,maxScale:s,minZoom:i,maxZoom:a}=this,c=-1,r=-1,l=!1,n=!1;if(0!==o&&0!==s&&o<s&&([o,s]=[s,o]),!t||!t.length)return this._set("effectiveMinScale",o),void this._set("effectiveMaxScale",s);t=t.map((e=>e.clone())),t.sort(((e,t)=>t.scale-e.scale)),t.forEach(((e,t)=>e.level=t));for(const f of t)!l&&o>0&&o>=f.scale&&(c=f.level,l=!0),!n&&s>0&&s>=f.scale&&(r=e?e.level:-1,n=!0),e=f;-1===i&&(i=0===o?0:c),-1===a&&(a=0===s?t.length-1:r),i=Math.max(i,0),i=Math.min(i,t.length-1),a=Math.max(a,0),a=Math.min(a,t.length-1),i>a&&([i,a]=[a,i]),o=t[i].scale,s=t[a].scale,t.splice(0,i),t.splice(a-i+1,t.length),t.forEach(((e,t)=>{this._lodByScale[e.scale]=e,this._scales[t]=e.scale;})),this._set("effectiveLODs",t),this._set("effectiveMinZoom",i),this._set("effectiveMaxZoom",a),this._set("effectiveMinScale",o),this._set("effectiveMaxScale",s);}constrain(e,t){if(t&&e.scale===t.scale)return e;const o=this.effectiveMinScale,s=this.effectiveMaxScale,i=e.targetGeometry,a=t&&t.targetGeometry,c=0!==s&&e.scale<s,r=0!==o&&e.scale>o;if(c||r){const c=r?o:s;if(a){const o=(c-t.scale)/(e.scale-t.scale);i.x=a.x+(i.x-a.x)*o,i.y=a.y+(i.y-a.y)*o;}e.scale=c;}return this.snapToZoom&&this.effectiveLODs&&(e.scale=this._getClosestScale(e.scale)),e}fit(e){if(!this.effectiveLODs||!this.snapToZoom)return this.constrain(e,null);const t=this.scaleToZoom(e.scale),o=Math.abs(t-Math.floor(t));return e.scale=this.zoomToScale(o>.99?Math.round(t):Math.floor(t)),e}zoomToScale(e){if(!this.effectiveLODs)return 0;e-=this.effectiveMinZoom,e=Math.max(0,e);const t=this._scales;if(e<=0)return t[0];if(e>=t.length)return t[t.length-1];const o=Math.round(e-.5),s=Math.round(e);return t[s]+(s-e)*(t[o]-t[s])}scaleToZoom(e){if(!this.effectiveLODs)return -1;const t=this._scales;let o,s;if(e>=t[0])return this.effectiveMinZoom;if(e<=t[t.length-1])return this.effectiveMaxZoom;for(let i=0;i<t.length-1;i++){if(o=t[i],s=t[i+1],s===e){return i+this.effectiveMinZoom+1}if(o>e&&s<e){return i+this.effectiveMinZoom+1-(e-s)/(o-s)}}}snapToClosestScale(e){if(!this.effectiveLODs)return e;const t=this.scaleToZoom(e);return this.zoomToScale(Math.round(t))}snapToNextScale(e,t=.5){if(!this.effectiveLODs)return e*t;const o=Math.round(this.scaleToZoom(e));return this.zoomToScale(o+1)}snapToPreviousScale(e,t=2){if(!this.effectiveLODs)return e*t;const o=Math.round(this.scaleToZoom(e));return this.zoomToScale(o-1)}clone(){return new a$8({lods:this.lods,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale})}_getClosestScale(e){return this._lodByScale[e]||(e=this._scales.reduce(((t,o)=>Math.abs(o-e)<=Math.abs(t-e)?o:t),this._scales[0])),this._lodByScale[e].scale}};e$e([y$e({readOnly:!0})],c$9.prototype,"effectiveLODs",void 0),e$e([y$e({readOnly:!0})],c$9.prototype,"effectiveMinZoom",void 0),e$e([y$e({readOnly:!0})],c$9.prototype,"effectiveMaxZoom",void 0),e$e([y$e({readOnly:!0})],c$9.prototype,"effectiveMinScale",void 0),e$e([y$e({readOnly:!0})],c$9.prototype,"effectiveMaxScale",void 0),e$e([y$e({type:[i$u]})],c$9.prototype,"lods",void 0),e$e([y$e()],c$9.prototype,"minZoom",void 0),e$e([y$e()],c$9.prototype,"maxZoom",void 0),e$e([y$e()],c$9.prototype,"minScale",void 0),e$e([y$e()],c$9.prototype,"maxScale",void 0),e$e([y$e()],c$9.prototype,"snapToZoom",void 0),c$9=a$8=e$e([i$o("esri.views.2d.constraints.ZoomConstraint")],c$9);var r$6=c$9;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const l$7={base:null,key:"type",typeMap:{extent:M$7,polygon:x$5}};let c$8=class extends n$y.EventedAccessor{constructor(){super(...arguments),this.lods=null,this.minScale=0,this.maxScale=0,this.minZoom=-1,this.maxZoom=-1,this.rotationEnabled=!0,this.snapToZoom=!0;}initialize(){this.watch(["_zoom","_rotation"],this.emit.bind(this,"update"),!0);}destroy(){this.view=null,this._set("_zoom",null),this._set("_rotation",null);}set geometry(o){o?this._set("geometry",o):this._set("geometry",null);}get _defaultLODs(){const o=this.get("view.defaultsFromMap.tileInfo"),t=this.get("view.spatialReference");return o&&t&&o.spatialReference.equals(t)?o.lods:null}get _geometry(){return new g$4({geometry:this.geometry,spatialReference:this.view.spatialReference})}get _rotation(){return new a$9({rotationEnabled:this.rotationEnabled})}get _zoom(){return new r$6({lods:this.lods||this._defaultLODs,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale,snapToZoom:this.snapToZoom})}canZoomInTo(o){const t=this.effectiveMaxScale;return 0===t||o>=t}canZoomOutTo(o){const t=this.effectiveMinScale;return 0===t||o<=t}constrain(o,t){return this._zoom.constrain(o,t),this._rotation.constrain(o,t),this._geometry.constrain(o,t),o}constrainByGeometry(o){return this._geometry.constrain(o)}fit(o){return this._zoom.fit(o)}zoomToScale(o){return this._zoom.zoomToScale(o)}scaleToZoom(o){return this._zoom.scaleToZoom(o)}snapScale(o){return this._zoom.snapToClosestScale(o)}snapToNextScale(o){return this._zoom.snapToNextScale(o)}snapToPreviousScale(o){return this._zoom.snapToPreviousScale(o)}};e$e([y$e({readOnly:!0,aliasOf:"_zoom.effectiveLODs"})],c$8.prototype,"effectiveLODs",void 0),e$e([y$e({readOnly:!0,aliasOf:"_zoom.effectiveMinScale"})],c$8.prototype,"effectiveMinScale",void 0),e$e([y$e({readOnly:!0,aliasOf:"_zoom.effectiveMaxScale"})],c$8.prototype,"effectiveMaxScale",void 0),e$e([y$e({readOnly:!0,aliasOf:"_zoom.effectiveMinZoom"})],c$8.prototype,"effectiveMinZoom",void 0),e$e([y$e({readOnly:!0,aliasOf:"_zoom.effectiveMaxZoom"})],c$8.prototype,"effectiveMaxZoom",void 0),e$e([y$e({types:l$7,value:null})],c$8.prototype,"geometry",null),e$e([y$e({type:[i$u]})],c$8.prototype,"lods",void 0),e$e([y$e()],c$8.prototype,"minScale",void 0),e$e([y$e()],c$8.prototype,"maxScale",void 0),e$e([y$e()],c$8.prototype,"minZoom",void 0),e$e([y$e()],c$8.prototype,"maxZoom",void 0),e$e([y$e()],c$8.prototype,"rotationEnabled",void 0),e$e([y$e()],c$8.prototype,"snapToZoom",void 0),e$e([y$e()],c$8.prototype,"view",void 0),e$e([y$e()],c$8.prototype,"_defaultLODs",null),e$e([y$e({type:g$4})],c$8.prototype,"_geometry",null),e$e([y$e({type:a$9})],c$8.prototype,"_rotation",null),e$e([y$e({readOnly:!0,type:r$6})],c$8.prototype,"_zoom",null),c$8=e$e([i$o("esri.views.2d.MapViewConstraints")],c$8);var y$2=c$8;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
function r$5(){const r=new Float32Array(9);return r[0]=1,r[4]=1,r[8]=1,r}function n$c(r){const n=new Float32Array(9);return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],n}function e$6(r,n,e,t,a,o,c,u,s){const l=new Float32Array(9);return l[0]=r,l[1]=n,l[2]=e,l[3]=t,l[4]=a,l[5]=o,l[6]=c,l[7]=u,l[8]=s,l}function t$6(r,n){return new Float32Array(r,n,9)}Object.freeze({__proto__:null,create:r$5,clone:n$c,fromValues:e$6,createView:t$6});

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
function n$b(n){return n instanceof Float32Array&&n.length>=2}function r$4(n){return Array.isArray(n)&&n.length>=2}function t$5(t){return n$b(t)||r$4(t)}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
var b$1;const E$2=[0,0];let G$1=b$1=class extends a$j{constructor(...t){super(...t),this._viewpoint2D={center:n$B(),rotation:0,scale:0,spatialReference:null},this.center=[0,0],this.extent=new M$7,this.id=0,this.inverseTransform=e$7(),this.resolution=0,this.rotation=0,this.scale=0,this.transform=e$7(),this.transformNoRotation=e$7(),this.displayMat3=r$5(),this.displayViewMat3=r$5(),this.viewMat3=r$5(),this.viewMat2d=n$D(),this.worldScreenWidth=0,this.size=[0,0];}set pixelRatio(t){this._set("pixelRatio",t),this._update();}set size(t){this._set("size",t),this._update();}set viewpoint(t){if(t){const s=this._viewpoint2D,i=t.targetGeometry;s.center[0]=i.x,s.center[1]=i.y,s.rotation=t.rotation,s.scale=t.scale,s.spatialReference=i.spatialReference;}this._update();}copy(t){const s=this.size,i=this.viewpoint;return i&&s?(this.viewpoint=Z(i,t.viewpoint),this._set("size",a$p(s,t.size))):(this.viewpoint=t.viewpoint.clone(),this._set("size",[t.size[0],t.size[1]])),this._set("pixelRatio",t.pixelRatio),this}clone(){return new b$1({size:this.size,viewpoint:this.viewpoint.clone(),pixelRatio:this.pixelRatio})}toMap(t,s,i){return t$5(s)?D$4(t,s,this.inverseTransform):(E$2[0]=s,E$2[1]=i,D$4(t,E$2,this.inverseTransform))}toScreen(t,s,i){return t$5(s)?D$4(t,s,this.transform):(E$2[0]=s,E$2[1]=i,D$4(t,E$2,this.transform))}toScreenNoRotation(t,s,i){return t$5(s)?D$4(t,s,this.transformNoRotation):(E$2[0]=s,E$2[1]=i,D$4(t,E$2,this.transformNoRotation))}getScreenTransform(t,s){const{center:i}=this._viewpoint2D,e=this._get("pixelRatio")||1,o=this._get("size");return lt(t,i,o,s,0,e),t}_update(){const{center:t,spatialReference:s,scale:i,rotation:e}=this._viewpoint2D,r=this._get("pixelRatio")||1,p=this._get("size"),w=new u$9({targetGeometry:new j$5(t[0],t[1],s),scale:i,rotation:e});if(this._set("viewpoint",w),!p||!s||!i)return;this.resolution=at(w),this.rotation=e,this.scale=i,this.spatialReference=s,a$p(this.center,t);const R=0!==p[0]?2/p[0]:0,_=0!==p[1]?-2/p[1]:0;s$v(this.displayMat3,R,0,0,0,_,0,-1,1,1);const x=r$m(this.viewMat3),N=t$n(p[0]/2,p[1]/2),T=t$n(-p[0]/2,-p[1]/2),V=r$j(e);M$9(x,x,N),h$j(x,x,V),M$9(x,x,T),i$v(this.displayViewMat3,this.displayMat3,x);const b=n$C(this.viewMat2d);return i$t(b,b,N),c$z(b,b,V),i$t(b,b,T),_$1(this.extent,w,p),mt(this.transform,w,p,r),r$k(this.inverseTransform,this.transform),yt(this.transformNoRotation,w,p,r),this.worldScreenWidth=gt(this.spatialReference,this.resolution),this._set("id",this.id+1),this}};e$e([y$e({readOnly:!0})],G$1.prototype,"id",void 0),e$e([y$e({value:1,json:{write:!0}})],G$1.prototype,"pixelRatio",null),e$e([y$e({json:{write:!0}})],G$1.prototype,"size",null),e$e([y$e({type:u$9,json:{write:!0}})],G$1.prototype,"viewpoint",null),G$1=b$1=e$e([i$o("esri.views.2d.ViewState")],G$1);var O$1=G$1;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
let c$7=class extends u$k{constructor(){super(...arguments),this.left=0,this.top=0,this.right=0,this.bottom=0;}};e$e([y$e()],c$7.prototype,"left",void 0),e$e([y$e()],c$7.prototype,"top",void 0),e$e([y$e()],c$7.prototype,"right",void 0),e$e([y$e()],c$7.prototype,"bottom",void 0),c$7=e$e([i$o("esri.views.2d.PaddedViewState.Padding")],c$7);let h$5=class extends O$1{constructor(...t){super(...t),this.paddedViewState=new O$1,this._updateContent=(()=>{const t=n$B();return ()=>{const e=this._get("size"),o=this._get("padding");if(!e||!o)return;const s=this.paddedViewState;r$i(t,o.left+o.right,o.top+o.bottom),o$m(t,e,t),a$p(s.size,t);const i=s.viewpoint;i&&(this.viewpoint=i);}})(),this.watch(["size","padding"],this._updateContent,!0),this.padding=new c$7,this.size=[0,0];}set padding(t){this._set("padding",t||new c$7);}set viewpoint(t){if(t){const e=t.clone();this.paddedViewState.viewpoint=t,bt(e,t,this._get("size"),this._get("padding"));const o=this._viewpoint2D,s=e.targetGeometry;o.center[0]=s.x,o.center[1]=s.y,o.rotation=e.rotation,o.scale=e.scale,o.spatialReference=s.spatialReference,this._update();}}};e$e([y$e()],h$5.prototype,"paddedViewState",void 0),e$e([y$e({type:c$7})],h$5.prototype,"padding",null),e$e([y$e()],h$5.prototype,"viewpoint",null),h$5=e$e([i$o("esri.views.2d.PaddedViewState")],h$5);var m$5=h$5;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const s$9=s=>-1!==s.indexOf("Brush");class e$5{constructor(){this._names=new Map;}begin(e){this._names.has(e)||(this._names.set(e,!1),s$9(e)&&this.record("Esri.FirstDraw"),performance.mark(`Esri.${e}.Start`));}end(s){this._names.has(s)&&!this._names.get(s)&&(this._names.set(s,!0),performance.mark(`Esri.${s}.End`));}record(s){this._names.has(s)||(this._names.set(s,!0),performance.mark(`Esri.${s}`));}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const G=n$v.getLogger("esri.views.MapView");function N$1(t){return t&&"esri.Viewpoint"===t.declaredClass}const q=160;let A=class extends(t$9(P$1)){constructor(t){super(t),this._stationaryTimer=null,this.frameTask=new a$b(this),this.featuresTilingScheme=null,this.fullOpacity=1,this.graphicsView=null,this.initialExtent=null,this.labelManager=null,this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!0,labelsAnimationTime:125,labelCollisionsEnabled:!0},this.resizeAlign="center",this.supportsGround=!1,this.timeline=new e$5,this.type="2d",this.constraints=new y$2,this.padding={top:0,right:0,bottom:0,left:0};const e=this.handles,i=()=>this.notifyChange("updating");e.add([this.watch("viewpoint",(()=>{this._lastStationaryEventTimestamp=performance.now(),this._flipStationary(q);}),!0),this.on("resize",(t=>this._resizeHandler(t))),this.watch("animationManager.animation",(t=>{this.animation=t;})),this.allLayerViews.on("change",(()=>{i(),e.remove("map-view-base-layerViewsUpdating"),e.add(this.allLayerViews.map((t=>t.watch("updating",i))),"map-view-base-layerViewsUpdating");}))],"map-view-base");}destroy(){this.destroyed||(this._set("preconditionsReady",!1),this._gotoTask=this.frameTask=null);}set animation(t){const e=this._get("animation");if(t===e)return;if(e&&e.stop(),!t||t.isFulfilled())return void this._set("animation",null);this._set("animation",t),this.frameTask.animationInProgress=!0;const i=()=>{t===this._get("animation")&&(this._set("animation",null),this.frameTask.requestFrame()),this.frameTask.animationInProgress=!1;};t.when(i,i);}get center(){if(!this.ready)return this._get("center");const{center:t,spatialReference:e}=this.state.paddedViewState;return new j$5({x:t[0],y:t[1],spatialReference:e})}set center(t){if(null==t)return;if(!this._normalizeInput(t))return void G.error("#center",`incompatible spatialReference ${JSON.stringify(t.spatialReference)} with view's spatialReference ${JSON.stringify(this.spatialReference)}`);if(!this.ready)return this._set("center",t),void this.notifyChange("initialExtentRequired");const e=this.viewpoint;wt(e,e,t),this.viewpoint=e;}set constraints(t){const e=this._get("constraints");e&&(this.handles.remove("map-view-base-constraints"),e.destroy()),this._set("constraints",t),t&&(t.view=this,this.ready&&(this.state.viewpoint=t.fit(this.state.paddedViewState.viewpoint)),this.handles.add(t.on("update",(()=>{this.ready&&this.state&&(this.state.viewpoint=t.fit(this.state.paddedViewState.viewpoint));})),"map-view-base-constraints"));}get extent(){return this.ready?this.state.paddedViewState.extent.clone():this._get("extent")}set extent(t){if(null==t)return;const e=this._normalizeInput(t);if(!e)return void G.error("#center",`incompatible spatialReference ${JSON.stringify(t.spatialReference)} with view's spatialReference ${JSON.stringify(this.spatialReference)}`);if(!e.width||!e.height)return void G.error("#extent","invalid extent size");if(!this.ready)return this._set("extent",e),this._set("center",null),this._set("viewpoint",null),this._set("scale",0),this._set("zoom",-1),void this.notifyChange("initialExtentRequired");const i=this.viewpoint;tt(i,i,e,this.size,{constraints:this.constraints}),this.viewpoint=i;}get initialExtentRequired(){const{extent:t,center:e,scale:i,viewpoint:s,zoom:n}=this;return !this.get("map.initialViewProperties.viewpoint")&&(!t&&((!e||0===i&&-1===n)&&!s))}get padding(){return this.ready?this.state.padding:this._get("padding")}set padding(t){this.ready?(this.state.padding=t,this._set("padding",this.state.padding)):this._set("padding",t);}get resolution(){return this.state?this.state.resolution:0}get rotation(){return this.ready?this.state.rotation:this._get("rotation")}set rotation(t){if(isNaN(t))return;if(!this.ready)return void this._set("rotation",t);const e=this.viewpoint;At(e,e,t),this.viewpoint=e;}get scale(){return this.ready?this.state.scale:this._get("scale")}set scale(t){if(!t||isNaN(t))return;if(!this.ready){this._set("scale",t),this._set("zoom",-1);const e=this._get("extent");return e&&(this._set("extent",null),this._set("center",e.center)),void this.notifyChange("initialExtentRequired")}const e=this.viewpoint;kt(e,e,t),this.viewpoint=e;}get stationary(){return !(this.animation||this.navigating||this._get("resizing")||this._stationaryTimer)}get updating(){return !this.destroyed&&(!0===this.get("layerViewManager.updating")||!0===this.get("labelManager.updating")||!0===this.get("graphicsView.updating")||this.allLayerViews.some((t=>!t.destroyed&&!("layerViews"in t)&&!0===t.updating)))}get viewpoint(){if(!this.ready)return this._get("viewpoint");const t=this.state.paddedViewState;return t&&t.viewpoint.clone()}set viewpoint(t){if(null==t)return;const i=this._normalizeInput(t);if(!i)return void(!t.scale||isNaN(t.scale)?G.error("#viewpoint",`invalid scale value of ${t.scale}`):t$f(t.targetGeometry)?G.error("#viewpoint","geometry not defined"):G.error("#viewpoint",`incompatible spatialReference ${JSON.stringify(t.targetGeometry.spatialReference)} with view's spatialReference ${JSON.stringify(this.spatialReference)}`));if(!this.ready)return this._set("viewpoint",i),this._set("extent",null),this._set("center",null),this._set("zoom",-1),this._set("scale",0),void this.notifyChange("initialExtentRequired");const s=new u$9({targetGeometry:new j$5,scale:0,rotation:0});Z(s,i),this.constraints.constrain(s,this.state.paddedViewState.viewpoint),this.state.viewpoint=s,this.frameTask.requestFrame(),this._set("viewpoint",s);}get zoom(){return this.ready?this.constraints.scaleToZoom(this.scale):this._get("zoom")}set zoom(t){if(null==t)return;if(!this.ready){this.notifyChange("initialExtentRequired"),this._set("zoom",t),this._set("scale",0);const e=this._get("extent");e&&(this._set("extent",null),this._set("center",e.center));}if(!this.constraints.effectiveLODs)return;const e=this.viewpoint;kt(e,e,this.constraints.zoomToScale(t)),this.viewpoint=e,this._set("zoom",this.constraints.scaleToZoom(this.scale));}goTo(t,e){if(t)return this.animation&&(this.animation=null),this._createAnimation(),x$6(this,"ready",e&&e.signal).then((()=>{const i={animate:!0,...e},s=ht(t,this);return this.animation.update(s),this._gotoTask={},i.animate?this._gotoAnimated(s,i):this._gotoImmediate(s,i)}));G.error("#goTo()","target cannot be null or undefined");}hitTest(t){return Promise.reject("Should be implemented by subclasses")}popupHitTest(t){return this.hitTest(t).then((e=>({...e,mapPoint:this.toMap(t)})))}toMap(t){if(!this.ready)return null;const e=[0,0],[i,s]=this.state.toMap(e,[t.x,t.y]),n=this.spatialReference;return new j$5({x:i,y:s,spatialReference:n})}isTileInfoRequired(){return !0}toScreen(t){if(!this.ready)return null;const e=this._normalizeInput(t),i=[e.x,e.y];return this.state.toScreen(i,i),c$y(i[0],i[1])}pixelSizeAt(){return this.ready?this.state.resolution:(G.error("#pixelSizeAt()","Map view cannot be used before it is ready"),null)}requestUpdate(){this.ready&&this.frameTask.requestUpdate();}getDefaultSpatialReference(){return this.get("map.initialViewProperties.spatialReference")||this.get("defaultsFromMap.spatialReference")||null}isSpatialReferenceSupported(t,e){return !(!e&&!this._get("ready"))||null!==this._getDefaultViewpoint()}importLayerView(t){return n$d.importLayerView(t)}hasLayerViewModule(t){return n$d.hasLayerViewModule(t)}_createAnimation(){return this.animation&&!this.animation.done||(this.animation=new n$f),this.animation}_cancellableGoTo(t,e,i){const s=()=>t===this._gotoTask,n=i.then((()=>{s()&&(this.animation=null);})).catch((t=>{throw s()&&(this.animation=null,e.done||(e.stop(),this.frameTask.animationInProgress=!1)),t})),a=new Promise((t=>t(n)));return e.when().catch((()=>{s()&&a.cancel&&a.cancel();})),a}_gotoImmediate(t,e){const i=this._gotoTask,s=this.animation,n=t.then((t=>{if(h$h(e),i!==this._gotoTask)throw new s$n("view:goto-interrupted","Goto was interrupted");this.viewpoint=s.target=t,s.finish();}));return this._cancellableGoTo(i,s,n)}_gotoAnimated(t,e){const i=this._gotoTask,s=this.animation,n=t.then((t=>{if(h$h(e),i!==this._gotoTask)throw new s$n("view:goto-interrupted","Goto was interrupted");return s.update(t),this.animationManager.animate(s,this.viewpoint,e),s.when().then((()=>{}),(()=>{}))}));return this._cancellableGoTo(i,s,n)}_resizeHandler(t){const e=this.state;if(!e)return;let i=this.state.paddedViewState.viewpoint;const s=this.state.paddedViewState.size.concat();e.size=[t.width,t.height],Gt(i,i,s,this.state.paddedViewState.size,this.resizeAlign),i=this.constraints.constrain(i,null),this.state.viewpoint=i;}_startup(){const t=this._getDefaultViewpoint();this.constraints.view=this,this.constraints.fit(t),this._set("animationManager",new d$4({view:this})),this._set("state",new m$5({padding:this._get("padding"),size:this.size,viewpoint:t})),this._set("featuresTilingScheme",new h$k(x$7.create({spatialReference:this.spatialReference,size:512}))),this._set("ready",!0),this.frameTask&&this.frameTask.start();}_teardown(){this.frameTask&&this.frameTask.stop(),this._set("ready",!1),this._stationaryTimer&&(clearTimeout(this._stationaryTimer),this._stationaryTimer=null);const{center:[t,e],spatialReference:i,rotation:s,scale:n}=this.state.paddedViewState,a=new j$5({x:t,y:e,spatialReference:i});this._set("viewpoint",null),this._set("extent",null),this._set("center",a),this._set("zoom",-1),this._set("rotation",s),this._set("scale",n),this._set("spatialReference",i),this.constraints.view=null,this.animationManager.destroy(),this._set("animationManager",null),this._set("state",null),this.animation=null;}_flipStationary(t){return null!==this._stationaryTimer||(this._stationaryTimer=setTimeout((()=>{this._stationaryTimer=null;const t=performance.now()-this._lastStationaryEventTimestamp;t<q&&(this._stationaryTimer=this._flipStationary(t));}),t)),this._stationaryTimer}_normalizeInput(t,e=this.spatialReference){const i=t&&t.targetGeometry||t;return e?i?e.equals(i.spatialReference)?t:x$4(i,e)?N$1(t)?(t.targetGeometry=g$h(i,e),t):g$h(i,e):null:null:t}_getDefaultViewpoint(){const t=this.constraints,e={zoom:this._get("zoom"),scale:this._get("scale"),center:this._normalizeInput(this._get("center")),extent:this._normalizeInput(this._get("extent")),rotation:this._get("rotation"),viewpoint:this._normalizeInput(this._get("viewpoint")),spatialReference:this._userSpatialReference};t.effectiveLODs?-1!==e.zoom&&(e.scale=t.zoomToScale(e.zoom)):e.zoom=-1;let s=null,n=null,a=0;const r=e.viewpoint&&e.viewpoint.rotation,o=e.viewpoint&&e.viewpoint.targetGeometry;r$f(o)&&("extent"===o.type?s=o:"point"===o.type&&(n=o,a=e.viewpoint.scale));const l=this._normalizeInput(this.get("map.initialViewProperties.viewpoint.targetGeometry.extent")),p=this._normalizeInput(this.initialExtent),h=e.extent||s||l||p,d=e.center||n||h&&h.center,m=this.get("map.initialViewProperties.viewpoint.scale"),c=e.scale||a||m||h&&J(h,this.size),g=this.get("map.initialViewProperties.viewpoint.rotation"),y=e.rotation||r||g||0;return d&&c?new u$9({targetGeometry:d,scale:c,rotation:y}):null}};e$e([y$e()],A.prototype,"_stationaryTimer",void 0),e$e([y$e()],A.prototype,"animation",null),e$e([y$e({readOnly:!0})],A.prototype,"animationManager",void 0),e$e([y$e({value:null,type:j$5,dependsOn:["state.id","ready"]})],A.prototype,"center",null),e$e([y$e({type:y$2})],A.prototype,"constraints",null),e$e([y$e({value:null,type:M$7,dependsOn:["state.id","ready"]})],A.prototype,"extent",null),e$e([y$e({readOnly:!0})],A.prototype,"featuresTilingScheme",void 0),e$e([y$e()],A.prototype,"fullOpacity",void 0),e$e([y$e()],A.prototype,"graphicsView",void 0),e$e([y$e({type:M$7})],A.prototype,"initialExtent",void 0),e$e([y$e({dependsOn:["map.initialViewProperties?.viewpoint"]})],A.prototype,"initialExtentRequired",null),e$e([y$e()],A.prototype,"labelManager",void 0),e$e([y$e({value:{top:0,right:0,bottom:0,left:0},cast:t=>({top:0,right:0,bottom:0,left:0,...t})})],A.prototype,"padding",null),e$e([y$e({type:Object})],A.prototype,"renderingOptions",void 0),e$e([y$e()],A.prototype,"resizeAlign",void 0),e$e([y$e({readOnly:!0,dependsOn:["state.id"]})],A.prototype,"resolution",null),e$e([y$e({value:0,type:Number,dependsOn:["state.id","ready"]})],A.prototype,"rotation",null),e$e([y$e({value:0,type:Number,dependsOn:["state.id","ready"]})],A.prototype,"scale",null),e$e([y$e({type:k$7,dependsOn:["map.initialViewProperties?.spatialReference","defaultsFromMap.isSpatialReferenceDone"]})],A.prototype,"spatialReference",void 0),e$e([y$e({readOnly:!0})],A.prototype,"state",void 0),e$e([y$e({dependsOn:["animation","navigating","resizing","_stationaryTimer"]})],A.prototype,"stationary",null),e$e([y$e({readOnly:!0})],A.prototype,"supportsGround",void 0),e$e([y$e({type:e$5,readOnly:!0})],A.prototype,"timeline",void 0),e$e([y$e({readOnly:!0})],A.prototype,"type",void 0),e$e([y$e({readOnly:!0,dependsOn:["layerViewManager.updating","labelManager.updating","graphicsView?.updating"]})],A.prototype,"updating",null),e$e([y$e({value:null,type:u$9,dependsOn:["state.id","ready"]})],A.prototype,"viewpoint",null),e$e([y$e({value:-1,dependsOn:["state.id"]})],A.prototype,"zoom",null),A=e$e([i$o("esri.views.MapViewBase")],A);var L$1=A;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
function t$4(t,r){switch(r){case"primary":return "touch"===t.pointerType||0===t.button;case"secondary":return "touch"!==t.pointerType&&2===t.button;case"tertiary":return "touch"!==t.pointerType&&1===t.button}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
class a$7 extends i$g{constructor(t,i){super(!0),this.view=t,this.registerIncoming("double-click",i,(t=>this._handleDoubleClick(t,i)));}_handleDoubleClick(t,a){t$4(t.data,"primary")&&(t.stopPropagation(),a?this.view.mapViewNavigation.zoomOut([t.data.x,t.data.y]):this.view.mapViewNavigation.zoomIn([t.data.x,t.data.y]));}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
class e$4 extends i$g{constructor(t,e,a){super(!0),this.view=t,this.pointerType=e,this.registerIncoming("double-tap-drag",a,(t=>this._handleDoubleTapDrag(t)));}_handleDoubleTapDrag(t){const{data:e}=t,{pointerType:a}=e;if(a!==this.pointerType)return;t.stopPropagation();const{action:s,delta:i}=e,{view:r}=this,{mapViewNavigation:n}=r;switch(s){case"begin":{const{scale:t}=r;this._startScale=t,this._currentScale=t,this._previousDelta=i,n.begin();break}case"update":{if(this._previousDelta.y===i.y)return;this._previousDelta=i;const t=1.015**i.y,e=this._startScale*t,a=e/this._currentScale;n.setViewpointImmediate(a),this._currentScale=e;break}case"end":{const{constraints:t}=r,{effectiveLODs:e,snapToZoom:a}=t;if(!a||!e)return void n.end();const s=t.snapScale(this._currentScale),o=(i.y>0?Math.max(s,t.snapToPreviousScale(this._startScale)):Math.min(s,t.snapToNextScale(this._startScale)))/this._currentScale;n.zoom(o);break}}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
class t$3{constructor(t){this.callbacks=t,this.currentCount=0,this.callbacks.condition||(this.callbacks.condition=()=>!0);}handle(t){const s=t.data,i=s.pointers.size;switch(s.action){case"start":this.currentCount=i,this.emitStart(t);break;case"added":this.emitEnd(this.previousEvent),this.currentCount=i,this.emitStart(t);break;case"update":this.emitUpdate(t);break;case"removed":this.startEvent&&this.emitEnd(this.previousEvent),this.currentCount=i,this.emitStart(t);break;case"end":this.emitEnd(t),this.currentCount=0;}this.previousEvent=t;}emitStart(t){this.startEvent=t,this.callbacks.condition(this.currentCount,t)&&this.callbacks.start(this.currentCount,t,this.startEvent);}emitUpdate(t){this.callbacks.condition(this.currentCount,t)&&this.callbacks.update(this.currentCount,t,this.startEvent);}emitEnd(t){this.callbacks.condition(this.currentCount,t)&&this.callbacks.end(this.currentCount,t,this.startEvent),this.startEvent=null;}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
class n$a extends i$g{constructor(t,n,o){super(!0),this.view=t,this.pointerAction=n,this.registerIncoming("drag",o,(t=>this._handleDrag(t))),this.registerIncoming("pointer-down",(()=>this.stopMomentumNavigation()));const e=this.view.mapViewNavigation;this.dragEventSeparator=new t$3({start:(t,i)=>{e.pan.begin(this.view,i.data),i.stopPropagation();},update:(t,i)=>{e.pan.update(this.view,i.data),i.stopPropagation();},end:(t,i)=>{e.pan.end(this.view,i.data),i.stopPropagation();},condition:(t,a)=>1===t&&t$4(a.data,this.pointerAction)});}_handleDrag(t){const i=this.view.mapViewNavigation;i.pinch.zoomMomentum||i.pinch.rotateMomentum?this.stopMomentumNavigation():this.dragEventSeparator.handle(t);}stopMomentumNavigation(){this.view.mapViewNavigation.pan.stopMomentumNavigation();}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
class o$4 extends i$g{constructor(t,o,r){super(!0),this.view=t,this.pointerAction=o;const e=this.view.mapViewNavigation;this.dragEventSeparator=new t$3({start:(t,a)=>{e.rotate.begin(this.view,a.data),a.stopPropagation();},update:(t,a)=>{e.rotate.update(this.view,a.data),a.stopPropagation();},end:(t,a)=>{e.rotate.end(),a.stopPropagation();},condition:(t,i)=>1===t&&t$4(i.data,this.pointerAction)}),this.registerIncoming("drag",r,(t=>this.dragEventSeparator.handle(t)));}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
function n$9(t){let n=t*t;return t<0&&(n*=-1),n}function a$6(t){return t.translation[0]=0,t.translation[1]=0,t.translation[2]=0,t.heading=0,t.tilt=0,t}function i$4(a,i,o){const s=o,e=a.state,r=a.device,l="forward-down"===i.tiltDirection?1:-1,c=1;return "standard"===r.deviceType?(s.translation[0]=n$9(e.axes[0]),s.translation[1]=n$9(e.axes[1]),s.translation[2]=n$9(e.buttons[7])-n$9(e.buttons[6]),s.heading=n$9(e.axes[2]),s.tilt=n$9(e.axes[3])):"spacemouse"===r.deviceType&&(s.translation[0]=1.2*n$9(e.axes[0]),s.translation[1]=1.2*n$9(e.axes[1]),s.translation[2]=2*-n$9(e.axes[2]),s.heading=1.2*n$9(e.axes[5]),s.tilt=1.2*n$9(e.axes[3])),s.tilt*=l,d$o(s.translation,s.translation,c),s}function s$8(t){return 0===t.translation[0]&&0===t.translation[1]&&0===t.translation[2]&&0===t.heading&&0===t.tilt&&0===t.zoom}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
class l$6 extends i$g{constructor(t){super(!0),this.view=t,this.frameTask=null,this.watchHandles=new u$j,this.currentDevice=null,this.transformation={translation:[0,0,0],heading:0,tilt:0,zoom:0},this.handle=this.registerIncoming("gamepad",(t=>this.handleEvent(t))),this.handle.pause();}onInstall(i){super.onInstall(i),this.watchHandles.add([d$f(this.view.navigation.gamepad,"enabled",(i=>{i?(this.handle.resume(),this.frameTask||(this.frameTask=v$8({update:t=>this.frameUpdate(t.deltaTime)}))):(this.handle.pause(),this.frameTask&&(this.frameTask.remove(),this.frameTask=null));}))]);}onUninstall(){this.watchHandles.removeAll(),this.frameTask&&(this.frameTask.remove(),this.frameTask=null),super.onUninstall();}handleEvent(t){const i=this.view.navigation.gamepad.device;i&&t.data.device!==i||this.currentDevice&&this.currentDevice!==t.data.device||("end"===t.data.action?(this.currentDevice=null,a$6(this.transformation)):(this.currentDevice=t.data.device,i$4(t.data,this.view.navigation.gamepad,this.transformation)));}frameUpdate(t){const i=this.transformation;if(s$8(i))return;const e=this.view.viewpoint.clone(),a=this.view.navigation.gamepad.velocityFactor,r=m$4*a*t;Ft(e,e,[i.translation[0]*r,-i.translation[1]*r]);const o=1+i.translation[2]*c$6*t,l=this.view.constraints.rotationEnabled?-i.heading*d$3*t:0,v=this.view.size,p=[v[0]/2,v[1]];St(e,e,o,l,p,v);const f=this.view.constraints.constrain(e,this.view.viewpoint);this.view.viewpoint=f;}}const d$3=.06,m$4=.7,c$6=6e-4;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
class i$3 extends i$g{constructor(e,i,t){super(!0),this.view=e,this.keys=i,this._pressed=!1,this._keyMap={[i.left]:"left",[i.right]:"right",[i.up]:"up",[i.down]:"down"},this.registerIncoming("key-down",t,(e=>this._handleKeyDown(e))),this.registerIncoming("key-up",t,(e=>this._handleKeyUp(e))),this.registerIncoming("blur",t,(()=>this._handleBlur()));}_handleKeyDown(e){e.data.repeat||this._handleKey(e,!0);}_handleKeyUp(e){this._handleKey(e,!1);}_handleBlur(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop());}_handleKey(e,i){const t=this._keyMap[e.data.key];if(this._pressed=null!=t,this._pressed){if(i)switch(this.view.mapViewNavigation.begin(),t){case"left":this.view.mapViewNavigation.continousPanLeft();break;case"right":this.view.mapViewNavigation.continousPanRight();break;case"up":this.view.mapViewNavigation.continousPanUp();break;case"down":this.view.mapViewNavigation.continousPanDown();}else this._pressed=!1,this.view.mapViewNavigation.stop();e.stopPropagation();}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
class i$2 extends i$g{constructor(e,i,t){super(!0),this.view=e,this.keys=i,this._pressed=!1,this._keyToDirection={[i.clockwiseOption1]:"clockwise",[i.clockwiseOption2]:"clockwise",[i.counterClockwiseOption1]:"counterClockwise",[i.counterClockwiseOption2]:"counterClockwise",[i.resetOption1]:"reset",[i.resetOption2]:"reset"},this.registerIncoming("key-down",t,(e=>this._handleKeyDown(e))),this.registerIncoming("key-up",t,(e=>this._handleKeyUp(e))),this.registerIncoming("blur",t,(()=>this._handleBlur()));}_handleKeyDown(e){e.data.repeat||this._handleKey(e,!0);}_handleKeyUp(e){this._handleKey(e,!1);}_handleBlur(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop());}_handleKey(e,i){const t=e.modifiers;if(t.size>0&&!t.has("Shift")||!this.view.constraints.rotationEnabled)return;const s=this._keyToDirection[e.data.key];if(this._pressed=null!=s,this._pressed){if(i)switch(this.view.mapViewNavigation.begin(),s){case"clockwise":this.view.mapViewNavigation.continousRotateClockwise();break;case"counterClockwise":this.view.mapViewNavigation.continousRotateCounterclockwise();break;case"reset":this.view.mapViewNavigation.resetRotation();}else this._pressed=!1,this.view.mapViewNavigation.stop();e.stopPropagation();}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
class t$2 extends i$g{constructor(o,t,e){super(!0),this.view=o,this.keys=t,this._keysToZoomAction={},this.registerIncoming("key-down",e,(o=>this._handleKeyDown(o))),t.zoomIn.forEach((o=>this._keysToZoomAction[o]=0)),t.zoomOut.forEach((o=>this._keysToZoomAction[o]=1));}_handleKeyDown(o){this._handleKey(o);}_handleKey(o){const t=o.modifiers;if(t.size>0&&!t.has("Shift"))return;const{key:e}=o.data;if(!(e in this._keysToZoomAction))return;const i=this._keysToZoomAction[e],{mapViewNavigation:s}=this.view;let n=null;switch(i){case 0:n=s.zoomIn();break;case 1:n=s.zoomOut();break;default:return}s.begin(),n.then((()=>s.end())),o.stopPropagation();}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const t$1=.6;class o$3 extends i$g{constructor(e,t){super(!0),this.view=e,this._canZoom=!0,this.registerIncoming("mouse-wheel",t,(e=>this._handleMouseWheel(e)));}_handleMouseWheel(e){if(!this.view.navigation.mouseWheelZoomEnabled)return;if(e.preventDefault(),e.stopPropagation(),!this._canZoom)return;const o=this.view.mapViewNavigation,{x:n,y:i,deltaY:s}=e.data,a=1/t$1**(1/60*s),h=o.zoom(a,[n,i]);h&&(this._canZoom=!1,h.catch((()=>{})).then((()=>{this._canZoom=!0,o.end();})));}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
class a$5 extends i$g{constructor(t){super(!0),this.view=t,this.registerIncoming("drag",(t=>this._handleDrag(t))),this.registerIncoming("pointer-down",(()=>this.stopMomentumNavigation()));const a=this.view.mapViewNavigation;this.dragEventSeparator=new t$3({start:(t,i)=>{a.pinch.begin(this.view,i.data),i.stopPropagation();},update:(t,i)=>{a.pinch.update(this.view,i.data),i.stopPropagation();},end:(t,i)=>{a.pinch.end(this.view),i.stopPropagation();},condition:t=>t>=2});}_handleDrag(t){this.dragEventSeparator.handle(t);}stopMomentumNavigation(){this.view.mapViewNavigation.pinch.stopMomentumNavigation();}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
function e$3(t){const e=t.native;return e?{buttons:e.buttons.map((t=>t.pressed?t.value?t.value:1:0)),axes:e.axes.map((e=>s$7(e,t.axisThreshold)))}:{buttons:[],axes:[]}}function n$8(t,e){if(t.axes.length!==e.axes.length)return !1;if(t.buttons.length!==e.buttons.length)return !1;for(let n=0;n<t.axes.length;n++)if(t.axes[n]!==e.axes[n])return !1;for(let n=0;n<t.buttons.length;n++)if(t.buttons[n]!==e.buttons[n])return !1;return !0}function r$3(t){for(let e=0;e<t.axes.length;e++)if(0!==t.axes[e])return !1;for(let e=0;e<t.buttons.length;e++)if(0!==t.buttons[e])return !1;return !0}function s$7(e,n){const r=Math.abs(e);return r<n?0:c$B(e)*(r-n)/(1-n)}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
class a$4{constructor(e,t){this.element=e,this.input=t,this._hasEventListeners=!1,this.onConnectGamepad=e=>{this.connectGamepad(e.gamepad);},this.onDisconnectGamepad=e=>{const t=e.gamepad,i=t.index,n=this.inputDevices[i];n&&(this.emitGamepadEvent(t,e$3(n),!1),this.inputDevices.splice(i,1),this.latestUpdate.splice(i,1),this.input.gamepad.devices.remove(n),this.ensurePollingState());},this.frameTask=null,this.latestUpdate=new Array,this.inputDevices=new Array,this.callback=null;const i="getGamepads"in window.navigator,n=window.isSecureContext;this.supported=i&&n,this.supported&&(this.forEachGamepad(this.connectGamepad),window.addEventListener("gamepadconnected",this.onConnectGamepad),window.addEventListener("gamepaddisconnected",this.onDisconnectGamepad),this.ensurePollingState());}destroy(){this.hasEventListeners=!1,this.supported&&(window.removeEventListener("gamepadconnected",this.onConnectGamepad),window.removeEventListener("gamepaddisconnected",this.onDisconnectGamepad));}set hasEventListeners(e){this._hasEventListeners!==e&&(this._hasEventListeners=e,this.ensurePollingState());}get eventsEnabled(){return this.supported&&this.inputDevices.length>0&&this._hasEventListeners}set onEvent(e){this.callback=e;}connectGamepad(e){const s=new n$g(e);"unknown"!==s.deviceType&&(this.inputDevices[e.index]=s,this.input.gamepad.devices.add(s)),this.ensurePollingState();}ensurePollingState(){this.eventsEnabled?this.startPolling():this.stopPolling();}startPolling(){null==this.frameTask&&(this.frameTask=v$8({update:()=>this.readGamepadState()}));}stopPolling(){null!=this.frameTask&&(this.frameTask.remove(),this.frameTask=null,this.latestUpdate=new Array);}readGamepadState(){const e=document.hasFocus(),t=this.element.contains(document.activeElement),a="document"===this.input.gamepad.enabledFocusMode&&!e||"view"===this.input.gamepad.enabledFocusMode&&!t;this.forEachGamepad((e=>{const t=this.inputDevices[e.index];if(!t)return;const d=this.latestUpdate[e.index],o=e$3(t),r=a||r$3(o);if(d){if(d.timestamp===e.timestamp)return;if(!d.active&&r)return;if(n$8(d.state,o))return}this.emitGamepadEvent(e,o,!r);}));}forEachGamepad(e){const t=window.navigator.getGamepads();for(let s=0;s<t.length;s++){const i=t[s];this.validate(i)&&e(i);}}emitGamepadEvent(e,t,s){const i=this.latestUpdate[e.index],n=i&&i.active;if(!n&&!s)return;const a=!n&&s?"start":n&&s?"update":"end";this.latestUpdate[e.index]={timestamp:e.timestamp,state:t,active:s},this.callback&&this.callback({device:this.inputDevices[e.index],state:t,action:a});}validate(e){if(!e)return !1;if(!e.connected)return !1;for(let t=0;t<e.axes.length;t++)if(isNaN(e.axes[t]))return !1;return !0}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const o$2=t$g("trident"),a$3=t$g("edge"),s$6=t$g("chrome"),r$2=t$g("ff"),h$4=t$g("safari"),l$5={touchNone:"esri-view-surface--touch-none",touchPan:"esri-view-surface--touch-pan"};class u$5{constructor(e,t){this.input=t,this._active={},this._activePointerCaptures=new Set,this._keyDownState=new Set,this._eventId=1,this._browserTouchPanningEnabled=!1,this._element=e,e.getAttribute("tabindex")||e.setAttribute("tabindex","0"),this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointer,"pointer-move":this._handlePointerPreventDefault,"pointer-up":this._handlePointerPreventDefault,"pointer-enter":this._handlePointer,"pointer-leave":this._handlePointer,"pointer-cancel":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost},this._updateTouchAction(),this._element.addEventListener("keydown",this._preventAltKeyDefault),this._gamepadSource=new a$4(e,this.input),this._gamepadSource.onEvent=e=>this._callback("gamepad",e);}destroy(){this._callback=null,this.activeEvents=null,this._activePointerCaptures.forEach((e=>{this._releasePointerCaptureSafe(e);})),this._gamepadSource&&(this._gamepadSource.destroy(),this._gamepadSource=null),this._activePointerCaptures=null,this._removeTouchAction(),this._element.removeEventListener("keydown",this._preventAltKeyDefault);}get browserTouchPanningEnabled(){return this._browserTouchPanningEnabled}set browserTouchPanningEnabled(e){this._browserTouchPanningEnabled=e,this._updateTouchAction(),this._updateTouchEventHandling();}set onEventReceived(e){this._callback=e;}set activeEvents(e){for(const t in this._active)if(!e||!e.has(t)){const e=this._active[t];this._element.removeEventListener(c$5[t],e),delete this._active[t];}e&&e.forEach((e=>{if(!this._active[e]&&c$5[e]){const t=(this._eventHandlers[e]||this._handleDefault).bind(this,e);this._element.addEventListener(c$5[e],t),this._active[e]=t;}})),this._gamepadSource.hasEventListeners=e&&e.has("gamepad");}setPointerCapture(e,t){t?(this._element.setPointerCapture(e.pointerId),this._activePointerCaptures.add(e.pointerId)):(this._releasePointerCaptureSafe(e.pointerId),this._activePointerCaptures.delete(e.pointerId));}_updateTouchAction(){this._element.classList.remove(this._browserTouchPanningEnabled?l$5.touchNone:l$5.touchPan),this._element.classList.add(this._browserTouchPanningEnabled?l$5.touchPan:l$5.touchNone);}_updateTouchEventHandling(){this._browserTouchPanningEnabled?this._element.addEventListener("touchmove",this._preventMultiTouchPanning):this._element.removeEventListener("touchmove",this._preventMultiTouchPanning);}_removeTouchAction(){this._element.classList.remove(l$5.touchNone),this._element.classList.remove(l$5.touchPan),this._element.removeEventListener("touchmove",this._preventMultiTouchPanning);}_releasePointerCaptureSafe(e){try{if(this._element.hasPointerCapture&&!this._element.hasPointerCapture(e))return;this._element.releasePointerCapture(e);}catch(t){}}_updateNormalizedPointerLikeEvent(e,t){const i=t$a(this._element,e);return u$5.test.disableSubpixelCoordinates&&(i.x=Math.round(i.x),i.y=Math.round(i.y)),t.x=i.x,t.y=i.y,t}_handleKey(e,n){const i=a$f(n);i&&"key-up"===e&&this._keyDownState.delete(i);const o={native:n,key:i,repeat:i&&this._keyDownState.has(i)};i&&"key-down"===e&&this._keyDownState.add(o.key),this._callback(e,o);}_handlePointer(e,t){const n=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,pointerType:t.pointerType,button:t.button,buttons:t.buttons,eventId:this._eventId++});this._callback(e,n);}_handlePointerPreventDefault(e,t){const n=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,pointerType:t.pointerType,button:t.button,buttons:t.buttons,eventId:this._eventId++});t.preventDefault(),this._callback(e,n);}_handleMouseWheel(e,t){let n=t.deltaY;switch(t.deltaMode){case 0:(o$2||a$3)&&(n=n/document.documentElement.clientHeight*600);break;case 1:n*=30;break;case 2:n*=900;}o$2||a$3?n*=.7:s$6||h$4?n*=.6:r$2&&(n*=1.375);const i=100,l=Math.abs(n);if(l>i){const e=.02;n=n/l*200/(1+Math.exp(-e*(l-i)));}const u=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,deltaY:n});this._callback(e,u);}_handlePointerCaptureLost(e,t){this._activePointerCaptures.delete(t.pointerId),this._handleDefault(e,t);}_handleDefault(e,t){const n={native:t};t.preventDefault(),this._callback(e,n);}_preventAltKeyDefault(e){"Alt"===e.key&&e.preventDefault();}_preventMultiTouchPanning(e){e.touches.length>1&&e.preventDefault();}}u$5.test={disableSubpixelCoordinates:!1};const c$5={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove","mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu","pointer-enter":"pointerenter","pointer-leave":"pointerleave","pointer-cancel":"pointercancel",focus:"focus",blur:"blur"};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
class e$2 extends i$g{constructor(){super(!0),this.registerIncoming("context-menu",(t=>{t.data.native.preventDefault();}));}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
function e$1(t,e){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)}function n$7(t,e){const n=e.x-t.x,r=e.y-t.y;return Math.sqrt(n*n+r*r)}function r$1(e,n){if(n?(n.radius=0,n.center.x=0,n.center.y=0):n={radius:0,center:c$y()},0===e.length)return n;if(1===e.length)return n.center.x=e[0].x,n.center.y=e[0].y,n;if(2===e.length){const[t,r]=e,[c,s]=[r.x-t.x,r.y-t.y];return n.radius=Math.sqrt(c*c+s*s)/2,n.center.x=(t.x+r.x)/2,n.center.y=(t.y+r.y)/2,n}let r=0,c=0;for(let t=0;t<e.length;t++)r+=e[t].x,c+=e[t].y;r/=e.length,c/=e.length;const s=e.map((t=>t.x-r)),x=e.map((t=>t.y-c));let o=0,y=0,a=0,h=0,l=0,u=0,i=0;for(let t=0;t<s.length;t++){const e=s[t],n=x[t],r=e*e,c=n*n;o+=r,y+=c,a+=e*n,h+=r*e,l+=c*n,u+=e*c,i+=n*r;}const f=.5*(h+u),g=.5*(l+i),M=o*y-a*a,d=(f*y-g*a)/M,m=(o*g-a*f)/M,p=c$y(d+r,m+c);return {radius:Math.sqrt(d*d+m*m+(o+y)/e.length),center:p}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const l$4={maximumDoubleClickDelay:250,maximumDoubleClickDistance:10,maximumDoubleTouchDelay:350,maximumDoubleTouchDistance:35};class s$5 extends i$g{constructor(t=l$4.maximumDoubleClickDelay,i=l$4.maximumDoubleClickDistance,o=l$4.maximumDoubleTouchDelay,s=l$4.maximumDoubleTouchDistance,u=o$o){super(!1),this.maximumDoubleClickDelay=t,this.maximumDoubleClickDistance=i,this.maximumDoubleTouchDelay=o,this.maximumDoubleTouchDistance=s,this._clock=u,this._pointerState=new Map,this._click=this.registerOutgoing("click"),this._doubleClick=this.registerOutgoing("double-click"),this.registerIncoming("immediate-click",this._handleImmediateClick.bind(this)),this.registerIncoming("pointer-drag",this._handlePointerDrag.bind(this)),this.registerIncoming("drag",this._handleDrag.bind(this));}onUninstall(){this._pointerState.forEach((e=>{null!=e.doubleClickTimeout&&(e.doubleClickTimeout.remove(),e.doubleClickTimeout=null);}));}get hasPendingInputs(){return n$j(this._pointerState,(e=>null!=e.doubleClickTimeout))}_pointerId(e){const t=e.native;return "mouse"===t.pointerType?`${t.pointerId}:${t.button}`:`${t.pointerType}`}_handleImmediateClick(e){const t=e.data,i=this._pointerId(t),l=this._pointerState.get(i);if(l){const s="touch"===t.native.pointerType?this.maximumDoubleTouchDistance:this.maximumDoubleClickDistance;e$1(l.event.data,t)>s?(this._clearDoubleClickTimeout(i,!0),this._startClick(e)):(this._clearDoubleClickTimeout(i,!1),this._doubleClick.emit(l.event.data,void 0,l.event.modifiers));}else this._startClick(e);}_startClick(e){const t=this._pointerId(e.data),i="touch"===e.data.native.pointerType?this.maximumDoubleTouchDelay:this.maximumDoubleClickDelay;this._pointerState.set(t,{event:e,doubleClickTimeout:this._clock.setTimeout((()=>this._doubleClickTimeoutExceeded(t)),i)}),this.refreshHasPendingInputs();}_handlePointerDrag(e){const t=this._pointerId(e.data.currentEvent);this._clearDoubleClickTimeout(t,!0);}_handleDrag(e){const t=this._pointerId(e.data.pointer);this._clearDoubleClickTimeout(t,!0);}_clearDoubleClickTimeout(e,t){const i=this._pointerState.get(e);i&&(i.doubleClickTimeout.remove(),i.doubleClickTimeout=null,t&&this._doubleClickTimeoutExceeded(e),this._pointerState.delete(e),this.refreshHasPendingInputs());}_doubleClickTimeoutExceeded(e){const t=this._pointerState.get(e);this._click.emit(t.event.data,void 0,t.event.modifiers),t.doubleClickTimeout=null,this._pointerState.delete(e),this.refreshHasPendingInputs();}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
class s$4 extends i$g{constructor(i=l$4.maximumDoubleClickDelay,a=l$4.maximumDoubleClickDistance,r=l$4.maximumDoubleTouchDelay,s=l$4.maximumDoubleTouchDistance,u=o$o){super(!1),this.maximumDoubleClickDelay=i,this.maximumDoubleClickDistance=a,this.maximumDoubleTouchDelay=r,this.maximumDoubleTouchDistance=s,this._clock=u,this._doubleTapDragReady=!1,this._doubleTapDragActive=!1,this._dragStartCenter=c$y(0,0),this._pointerState=new Map,this._doubleTapDrag=this.registerOutgoing("double-tap-drag"),this._dragEventSeparator=new t$3({start:(t,e)=>this._dragStart(t,e),update:(t,e)=>this._dragUpdate(e),end:(t,e)=>this._dragEnd(e)}),this.registerIncoming("drag",(t=>this._dragEventSeparator.handle(t))),this.registerIncoming("pointer-down",(t=>this._handlePointerDown(t))),this.registerIncoming("pointer-up",(()=>this._handlePointerUp()));}onUninstall(){this._pointerState.forEach((t=>{null!=t.doubleTapTimeout&&(t.doubleTapTimeout.remove(),t.doubleTapTimeout=null);}));}get hasPendingInputs(){return n$j(this._pointerState,(t=>null!=t.doubleTapTimeout))}_clearPointerDown(t){const e=this._pointerState.get(t);e&&(e.doubleTapTimeout.remove(),e.doubleTapTimeout=null,this._pointerState.delete(t),this.refreshHasPendingInputs());}_createDoubleTapDragData(t,e,i){const{button:a,buttons:o,pointer:r,pointers:n,pointerType:s,timestamp:u}=i;return {action:t,delta:e,button:a,buttons:o,pointer:r,pointers:n,pointerType:s,timestamp:u}}_dragStart(t,i){if(!this._doubleTapDragReady||1!==t)return;this._doubleTapDragReady=!1,this._doubleTapDragActive=!0;const{data:a,modifiers:o}=i,{center:r}=a;this._dragStartCenter=r;const n=this._createDoubleTapDragData("begin",c$y(0,0),a);this._doubleTapDrag.emit(n,void 0,o),i.stopPropagation();}_dragUpdate(t){if(!this._doubleTapDragActive)return;const{data:i,modifiers:a}=t,{center:o}=i,r=c$y(o.x-this._dragStartCenter.x,o.y-this._dragStartCenter.y),n=this._createDoubleTapDragData("update",r,i);this._doubleTapDrag.emit(n,void 0,a),t.stopPropagation();}_dragEnd(t){if(!this._doubleTapDragActive)return;const{data:i,modifiers:a}=t,{center:o}=i,r=c$y(o.x-this._dragStartCenter.x,o.y-this._dragStartCenter.y),n=this._createDoubleTapDragData("end",r,i);this._doubleTapDrag.emit(n,void 0,a),this._doubleTapDragActive=!1,t.stopPropagation();}_handlePointerDown(t){const{data:e}=t,i=this._pointerId(e),a=this._pointerState.get(i),{pointerType:o}=e.native;if(a){const n="touch"===o?this.maximumDoubleTouchDistance:this.maximumDoubleClickDistance;this._clearPointerDown(i),e$1(a.event.data,e)>n?this._storePointerDown(t):this._doubleTapDragReady=!0;}else this._storePointerDown(t);}_handlePointerUp(){this._doubleTapDragReady=!1;}_pointerId(t){const{native:e}=t,{pointerId:i,button:a,pointerType:o}=e;return "mouse"===o?`${i}:${a}`:`${o}`}_storePointerDown(t){const{data:e}=t,{pointerType:i}=e.native,a=this._pointerId(e),o="touch"===i?this.maximumDoubleTouchDelay:this.maximumDoubleClickDelay,r=this._clock.setTimeout((()=>this._clearPointerDown(a)),o);this._pointerState.set(a,{event:t,doubleTapTimeout:r}),this.refreshHasPendingInputs();}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
class s$3 extends i$g{constructor(t){super(!1),this.navigationTouch=t,this.startStateModifiers=new Set,this.activePointerMap=new Map,this.isDragging=!1,this.isCurrentDragSuppressed=!1,this.drag=this.registerOutgoing("drag"),this.registerIncoming("pointer-drag",this.handlePointerDrag.bind(this)),this.registerIncoming("pointer-up",this.handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-capture-lost",this.handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-cancel",this.handlePointerUpAndPointerLost.bind(this));}createPayload(t,e,i,n){return {action:t,pointerType:this.pointerType,button:this.mouseButton,buttons:e.buttons,timestamp:n,pointers:o$1(this.activePointerMap),pointer:e,angle:i.angle,radius:i.radius,center:i.center}}addPointer(t){const e=t.native.pointerId,i=a$2(this.activePointerMap).angle,n={event:t,initialAngle:0,lastAngle:0};this.activePointerMap.set(e,n);const s=h$3(n,r(this.activePointerMap));n.initialAngle=s,n.lastAngle=s,this.updatePointerAngles(i);}updatePointer(t){if(t&&null==t.x&&null==t.y)return;const e=t.native.pointerId,i=this.activePointerMap.get(e);i?i.event=t:this.addPointer(t);}removePointer(t){const e=a$2(this.activePointerMap).angle;this.activePointerMap.delete(t),this.updatePointerAngles(e);}updatePointerAngles(t){const e=a$2(this.activePointerMap);this.activePointerMap.forEach((i=>{i.initialAngle=h$3(i,e)-t,i.lastAngle=h$3(i,e)-t;}));}emitEvent(t,e,i){const n=a$2(this.activePointerMap);this.drag.emit(this.createPayload(t,e,n,i),void 0,this.startStateModifiers);}handlePointerUpAndPointerLost(t){const i=t.data.native.pointerId,n=t$o(t.timestamp);this.activePointerMap.get(i)&&(1===this.activePointerMap.size?(this.updatePointer(t.data),!this.isCurrentDragSuppressed&&this.emitEvent("end",t.data,n),this.isDragging=!1,this.isCurrentDragSuppressed=!1,this.removePointer(i)):(this.removePointer(i),this.emitEvent("removed",t.data,t$o(t.timestamp))));}handlePointerDrag(t){const i=t.data,n=i.currentEvent,s=t$o(t.timestamp);switch(i.action){case"start":case"update":this.isDragging?this.activePointerMap.has(n.native.pointerId)?(this.updatePointer(n),!this.isCurrentDragSuppressed&&this.emitEvent("update",n,s)):(this.addPointer(n),this.emitEvent("added",n,s),this.isCurrentDragSuppressed=this.isSuppressed):(this.updatePointer(n),this.pointerType=t.data.startEvent.pointerType,this.mouseButton=t.data.startEvent.button,this.startStateModifiers=t.modifiers,this.isDragging=!0,this.isCurrentDragSuppressed=this.isSuppressed,!this.isCurrentDragSuppressed&&this.emitEvent("start",n,s));}}get isSuppressed(){return this.navigationTouch&&!this.navigationTouch.browserTouchPanEnabled&&"touch"===this.pointerType&&1===this.activePointerMap.size}}function r(e){const i=[];return e.forEach((e=>{i.push(c$y(e.event.x,e.event.y));})),r$1(i)}function a$2(t){const e=r(t);let i=0;return t.forEach((t=>{let n=h$3(t,e),s=n-t.lastAngle;for(;s>Math.PI;)s-=2*Math.PI;for(;s<-Math.PI;)s+=2*Math.PI;n=t.lastAngle+s,t.lastAngle=n;const r=n-t.initialAngle;i+=r;})),i/=t.size||1,{angle:i,radius:e.radius,center:e.center}}function o$1(t){const e=new Map;return t.forEach(((t,i)=>e.set(i,t.event))),e}function h$3(t,e){const i=t.event,n=i.x-e.center.x,s=i.y-e.center.y;return Math.atan2(s,n)}var p$9;!function(t){t[t.Left=0]="Left",t[t.Middle=1]="Middle",t[t.Right=2]="Right",t[t.Back=3]="Back",t[t.Forward=4]="Forward",t[t.Undefined=-1]="Undefined";}(p$9||(p$9={}));

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
class n$6 extends i$g{constructor(e=l$4.maximumDoubleClickDelay,i=l$4.maximumDoubleClickDistance,n=l$4.maximumDoubleTouchDelay,a=l$4.maximumDoubleTouchDistance,s=o$o){super(!1),this.maximumDoubleClickDelay=e,this.maximumDoubleClickDistance=i,this.maximumDoubleTouchDelay=n,this.maximumDoubleTouchDistance=a,this._clock=s,this._pointerState=new Map,this._immediateDoubleClick=this.registerOutgoing("immediate-double-click"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",(t=>{this._handlePointerLoss(t,"pointer-up");})),this.registerIncoming("pointer-capture-lost",(t=>{this._handlePointerLoss(t,"pointer-capture-lost");})),this.registerIncoming("pointer-cancel",(t=>{this._handlePointerLoss(t,"pointer-cancel");}));}onUninstall(){this._pointerState.forEach((t=>{t.immediateDoubleClick&&t.immediateDoubleClick.timeoutHandle.remove();})),super.onUninstall();}_handlePointerDown(t){const e=t.data,i=this._pointerId(e);if(!this._pointerState.has(i)){const t={downButton:e.native.button,immediateDoubleClick:null};this._pointerState.set(i,t),this.startCapturingPointer(e.native);}}_handlePointerLoss(t,e){const o=t.data,n=this._pointerId(o),a=this._pointerState.get(n);if(a&&"pointer-up"===e&&a.downButton===o.native.button){const e=a.immediateDoubleClick;if(e){e.timeoutHandle.remove();const n="touch"===t.data.native.pointerType?this.maximumDoubleTouchDistance:this.maximumDoubleClickDistance;e$1(e,t.data)>n?this._startImmediateDoubleClick(t,a):(this._immediateDoubleClick.emit(t.data,void 0,e.modifiers),this._removeState(o));}else this._startImmediateDoubleClick(t,a);}}_startImmediateDoubleClick(t,e){const i="touch"===t.data.native.pointerType?this.maximumDoubleTouchDelay:this.maximumDoubleClickDelay;e.immediateDoubleClick={x:t.data.x,y:t.data.y,modifiers:t.modifiers,timeoutHandle:this._clock.setTimeout((()=>this._removeState(t.data)),i)};}_pointerId(t){const e=t.native;return "mouse"===e.pointerType?`${e.pointerId}:${e.button}`:`${e.pointerType}`}_removeState(t){const e=this._pointerId(t);this._pointerState.delete(e),this.stopCapturingPointer(t.native),this.refreshHasPendingInputs();}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const n$5={maximumClickDelay:300,movementUntilMouseDrag:1.5,movementUntilPenDrag:6,movementUntilTouchDrag:6,holdDelay:500};class o extends i$g{constructor(e=n$5.maximumClickDelay,i=n$5.movementUntilMouseDrag,o=n$5.movementUntilPenDrag,r=n$5.movementUntilTouchDrag,s=n$5.holdDelay,a=o$o){super(!1),this.maximumClickDelay=e,this.movementUntilMouseDrag=i,this.movementUntilPenDrag=o,this.movementUntilTouchDrag=r,this.holdDelay=s,this._clock=a,this._pointerState=new Map,this._pointerDrag=this.registerOutgoing("pointer-drag"),this._immediateClick=this.registerOutgoing("immediate-click"),this._pointerHold=this.registerOutgoing("hold"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",(t=>{this._handlePointerLoss(t,"pointer-up");})),this.registerIncoming("pointer-capture-lost",(t=>{this._handlePointerLoss(t,"pointer-capture-lost");})),this.registerIncoming("pointer-cancel",(t=>{this._handlePointerLoss(t,"pointer-cancel");})),this._moveHandle=this.registerIncoming("pointer-move",this._handlePointerMove.bind(this)),this._moveHandle.pause();}onUninstall(){this._pointerState.forEach((t=>{null!=t.holdTimeout&&(t.holdTimeout.remove(),t.holdTimeout=null);})),super.onUninstall();}_handlePointerDown(t){const e=t.data,i=e.native.pointerId;let n=null;0===this._pointerState.size&&(n=this._clock.setTimeout((()=>{const e=this._pointerState.get(i);if(e){if(!e.isDragging){const i=e.previousEvent;this._pointerHold.emit(i,void 0,t.modifiers),e.holdEmitted=!0;}e.holdTimeout=null;}}),this.holdDelay));const o={startEvent:e,previousEvent:e,startTimestamp:t.timestamp,isDragging:!1,downButton:e.native.button,holdTimeout:n,modifiers:new Set};this._pointerState.set(i,o),this.startCapturingPointer(e.native),this._moveHandle.resume(),this._pointerState.size>1&&this.startDragging(t);}_createPointerDragData(t,e,i){return {action:t,startEvent:e.startEvent,previousEvent:e.previousEvent,currentEvent:i}}_handlePointerMove(t){const e=t.data,n=e.native.pointerId,o=this._pointerState.get(n);if(o){if(o.isDragging)this._pointerDrag.emit(this._createPointerDragData("update",o,e),void 0,o.modifiers);else {n$7(e,o.startEvent)>this._getDragThreshold(e.native.pointerType)&&this.startDragging(t);}o.previousEvent=e;}}_getDragThreshold(t){switch(t){case"touch":return this.movementUntilTouchDrag;case"pen":return this.movementUntilPenDrag;case"mouse":default:return this.movementUntilMouseDrag}}startDragging(t){const e=t.data,i=e.native.pointerId;this._pointerState.forEach((n=>{null!=n.holdTimeout&&(n.holdTimeout.remove(),n.holdTimeout=null),n.isDragging||(n.modifiers=t.modifiers,n.isDragging=!0,i===n.startEvent.native.pointerId?this._pointerDrag.emit(this._createPointerDragData("start",n,e)):this._pointerDrag.emit(this._createPointerDragData("start",n,n.previousEvent),t.timestamp));}));}_handlePointerLoss(t,e){const i=t.data,n=i.native.pointerId,o=this._pointerState.get(n);if(o){if(null!=o.holdTimeout&&(o.holdTimeout.remove(),o.holdTimeout=null),o.isDragging)this._pointerDrag.emit(this._createPointerDragData("end",o,"pointer-up"===e?i:o.previousEvent),void 0,o.modifiers);else if("pointer-up"===e&&o.downButton===i.native.button){t.timestamp-o.startTimestamp<=this.maximumClickDelay&&!o.holdEmitted&&this._immediateClick.emit(i);}this._pointerState.delete(n),this.stopCapturingPointer(i.native),0===this._pointerState.size&&this._moveHandle.pause();}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const k$1={counter:"Ctrl",pan:{left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown"},zoom:{zoomIn:["=","+"],zoomOut:["-","_"]},rotate:{clockwiseOption1:"a",clockwiseOption2:"A",counterClockwiseOption1:"d",counterClockwiseOption2:"D",resetOption1:"n",resetOption2:"N"}};let C$2=class extends u$k{constructor(){super(...arguments),this._handles=new u$j;}initialize(){this._handles.add([b$c(this.view,"ready",(()=>this._disconnect())),y$h(this.view,"ready",(()=>this._connect()))]);}destroy(){this._handles&&(this._handles.removeAll(),this._handles=null),this._disconnect();}_disconnect(){this._inputManager&&(this.view.viewEvents.disconnect(),this._inputManager.destroy(),this._inputManager=null,this._source.destroy(),this._source=null);}_connect(){const e=this.view.surface,r=new u$5(e,this.view.input),o$1=[new n$6,new o,new s$5,new s$3(this.view.navigation),new s$4],t=new l$d({eventSource:r,recognizers:o$1});t.installHandlers("prevent-context-menu",[new e$2],u$d.INTERNAL),t.installHandlers("navigation",[new a$5(this.view),new l$6(this.view),new o$3(this.view),new a$7(this.view),new a$7(this.view,[k$1.counter]),new n$a(this.view,"primary"),new i$3(this.view,k$1.pan),new t$2(this.view,k$1.zoom),new i$2(this.view,k$1.rotate),new o$4(this.view,"secondary"),new e$4(this.view,"touch")],u$d.INTERNAL),this.view.viewEvents.connect(t),this._source=r,this._inputManager=t,d$f(this.view.navigation,"browserTouchPanEnabled",(e=>{this._source.browserTouchPanningEnabled=!e;}));}get test(){return {inputManager:this._inputManager}}};e$e([y$e()],C$2.prototype,"view",void 0),C$2=e$e([i$o("esri.views.2d.input.MapViewInputManager")],C$2);var E$1=C$2;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
let p$8=0,i$1=class extends u$k{constructor(){super(...arguments),this.color=new o$g([0,255,255]),this.haloOpacity=1,this.fillOpacity=.25;}get version(){return p$8++}};e$e([y$e({readOnly:!0})],i$1.prototype,"version",null),e$e([y$e({type:o$g})],i$1.prototype,"color",void 0),e$e([y$e({type:o$g})],i$1.prototype,"haloColor",void 0),e$e([y$e()],i$1.prototype,"haloOpacity",void 0),e$e([y$e()],i$1.prototype,"fillOpacity",void 0),i$1=e$e([i$o("esri.views.2d.support.HighlightOptions")],i$1);var c$4=i$1;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const t={checkMajorWebPerformanceCaveat:!0};function s$2(s){s={...t,...s};const o=r$n();return o.available?s.checkMajorWebPerformanceCaveat&&o.majorPerformanceCaveat?new s$n("webgl:major-performance-caveat-detected","Your WebGL implementation doesn't seem to support hardware accelerated rendering. Check your browser settings or if your GPU is in a blocklist."):o.supportsHighPrecisionFragment?o.supportsVertexShaderSamplers?o.supportsElementIndexUint?o.supportsStandardDerivatives?o.supportsInstancedArrays?null:new s$n("webgl:instanced-arrays-required","WebGL support for instanced rendering is required but not supported."):new s$n("webgl:standard-derivatives-required","WebGL support for standard derivatives is required but not supported."):new s$n("webgl:element-index-uint-required","WebGL support for uint vertex indices is required but not supported."):new s$n("webgl:vertex-shader-samplers-required","WebGL support for vertex shader samplers is required but not supported."):new s$n("webgl:high-precision-fragment-required","WebGL support for high precision fragment shaders is required but not supported."):new s$n("webgl:required","WebGL is required but not supported.")}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
function n$4(o){return o&&"nodeType"in o}function d$2(o){return o&&"function"==typeof o.render}const c$3={component:"esri-component"};let p$7=class extends u$k{constructor(){super(...arguments),this.widget=null;}destroy(){this.widget&&this.widget.destroy(),this.node=null;}get id(){return this.get("widget.id")||this.get("node.id")}set node(o){const t=this._get("node");o!==t&&(o&&o.classList.add(c$3.component),t&&t.classList.remove(c$3.component),this._set("node",o));}castNode(o){return o?"string"==typeof o||n$4(o)?(this._set("widget",null),e$l(o)):(d$2(o)&&!o.domNode&&(o.domNode=document.createElement("div")),this._set("widget",o),o.domNode):(this._set("widget",null),null)}};e$e([y$e({dependsOn:[]})],p$7.prototype,"id",null),e$e([y$e()],p$7.prototype,"node",null),e$e([c$r("node")],p$7.prototype,"castNode",null),e$e([y$e({readOnly:!0})],p$7.prototype,"widget",void 0),p$7=e$e([i$o("esri.views.ui.Component")],p$7);var u$4=p$7;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const l$3={left:0,top:0,bottom:0,right:0},h$2={bottom:30,top:15,right:15,left:15},m$3="manual",u$3={ui:"esri-ui",corner:"esri-ui-corner",innerContainer:"esri-ui-inner-container",manualContainer:"esri-ui-manual-container",cornerContainer:"esri-ui-corner-container",topLeft:"esri-ui-top-left",topRight:"esri-ui-top-right",bottomLeft:"esri-ui-bottom-left",bottomRight:"esri-ui-bottom-right"};function f$1(t){return t&&!t._started&&"function"==typeof t.postMixInProperties&&"function"==typeof t.buildRendering&&"function"==typeof t.postCreate&&"function"==typeof t.startup}function _(t){return "object"==typeof t&&!(t instanceof u$4)&&!("declaredClass"in t)&&("component"in t||"index"in t||"position"in t)?t:null}function g$3(t,{top:o,bottom:i,left:e,right:n}){t.style.top=o,t.style.bottom=i,t.style.left=e,t.style.right=n;}let y$1=class extends n$y.EventedAccessor{constructor(t){super(t),this._cornerNameToContainerLookup={},this._positionNameToContainerLookup={},this._components=new Array,this._componentToKey=new Map,this._handles=new u$j,this.view=null,this._initContainers();}initialize(){this._handles.add([d$f(this,"view.padding, container",this._applyViewPadding.bind(this)),d$f(this,"padding",this._applyUIPadding.bind(this))]);}destroy(){this.container=null;for(const t of this._components)t.destroy();this._components.length=0,this._handles.destroy(),this._componentToKey.clear();}set container(t){const o=this._get("container");t!==o&&(t&&(t.classList.add(u$3.ui),this._attachContainers(t)),o&&(o.classList.remove(u$3.ui),g$3(o,{top:"",bottom:"",left:"",right:""}),t$j(o)),this._set("container",t));}get height(){const t=this.get("view.height")||0;if(0===t)return t;const o=this._getViewPadding(),i=o.top+o.bottom;return Math.max(t-i,0)}get padding(){return this._get("padding")}set padding(t){t?this._override("padding",t):this._clearOverride("padding");}castPadding(t){return "number"==typeof t?{bottom:t,top:t,right:t,left:t}:{...h$2,...t}}get width(){const t=this.get("view.width")||0;if(0===t)return t;const o=this._getViewPadding(),i=o.left+o.right;return Math.max(t-i,0)}add(t,o){let i,e;if(Array.isArray(t))return void t.forEach((t=>this.add(t,o)));const n=_(t);n&&({index:i,position:o,component:t,key:e}=n),o&&"object"==typeof o&&({index:i,key:e,position:o}=o),!t||o&&!this._isValidPosition(o)||this._add(t,o,i,e);}remove(t,o){if(!t)return;if(Array.isArray(t))return t.map((t=>this.remove(t,o)));const i=this._find(t);if(i){const e=this._componentToKey;if(e.has(t)&&e.get(t)!==o)return;const n=this._components.indexOf(i);return i.node.parentNode&&i.node.parentNode.removeChild(i.node),this._componentToKey.delete(t),this._components.splice(n,1)[0]}}empty(t){if(Array.isArray(t))return t.map((t=>this.empty(t))).reduce(((t,o)=>t.concat(o)));if((t=t||m$3)===m$3){return Array.prototype.slice.call(this._manualContainer.children).filter((t=>!t.classList.contains(u$3.corner))).map((t=>this.remove(t)))}return this._isValidPosition(t)?Array.prototype.slice.call(this._cornerNameToContainerLookup[t].children).map(this.remove,this):null}move(t,o){if(Array.isArray(t)&&t.forEach((t=>this.move(t,o))),!t)return;let i;const e=_(t)||_(o);if(e&&(i=e.index,o=e.position,t=e.component||t),o&&!this._isValidPosition(o))return;const n=this.remove(t);n&&this.add(n,{position:o,index:i});}find(t){if(!t)return null;const o=this._findById(t);return o&&(o.widget||o.node)}getPosition(t){for(const o in this._positionNameToContainerLookup){if(this._positionNameToContainerLookup[o].contains(t))return o}return null}_add(t,o,i,e){t instanceof u$4||(t=new u$4({node:t})),this._place({component:t,position:o,index:i}),this._components.push(t),e&&this._componentToKey.set(t,e);}_find(t){return t?t instanceof u$4?this._findByComponent(t):"string"==typeof t?this._findById(t):this._findByNode(t.domNode||t):null}_getViewPadding(){return this.get("view.padding")||l$3}_attachContainers(t){t.appendChild(this._innerContainer),t.appendChild(this._manualContainer);}_initContainers(){const t=document.createElement("div");t.classList.add(u$3.innerContainer),t.classList.add(u$3.cornerContainer);const o=document.createElement("div");o.classList.add(u$3.innerContainer),o.classList.add(u$3.manualContainer);const i=document.createElement("div");i.classList.add(u$3.topLeft),i.classList.add(u$3.corner),t.appendChild(i);const e=document.createElement("div");e.classList.add(u$3.topRight),e.classList.add(u$3.corner),t.appendChild(e);const n=document.createElement("div");n.classList.add(u$3.bottomLeft),n.classList.add(u$3.corner),t.appendChild(n);const r=document.createElement("div");r.classList.add(u$3.bottomRight),r.classList.add(u$3.corner),t.appendChild(r),this._innerContainer=t,this._manualContainer=o;const s=d$i();this._cornerNameToContainerLookup={"top-left":i,"top-right":e,"bottom-left":n,"bottom-right":r,"top-leading":s?e:i,"top-trailing":s?i:e,"bottom-leading":s?r:n,"bottom-trailing":s?n:r},this._positionNameToContainerLookup={manual:o,...this._cornerNameToContainerLookup};}_isValidPosition(t){return !!this._positionNameToContainerLookup[t]}_place(t){const o=t.component,i=t.position||m$3,e=t.index,n=this._positionNameToContainerLookup[i],r=e>-1;if(f$1(o.widget)&&o.widget.startup(),!r)return void n.appendChild(o.node);const s=Array.prototype.slice.call(n.children);if(0===e)return void(n.firstChild?o$p(o.node,n.firstChild):n.appendChild(o.node));e>=s.length?n.appendChild(o.node):o$p(o.node,s[e]);}_applyViewPadding(){const t=this.container;t&&g$3(t,this._toPxPosition(this._getViewPadding()));}_applyUIPadding(){const t=this._innerContainer;t&&g$3(t,this._toPxPosition(this.padding));}_toPxPosition(t){return {top:this._toPxUnit(t.top),left:this._toPxUnit(t.left),right:this._toPxUnit(t.right),bottom:this._toPxUnit(t.bottom)}}_toPxUnit(t){return 0===t?"0":t+"px"}_findByComponent(t){let o,i=null;return this._components.some((e=>(o=e===t,o&&(i=e),o))),i}_findById(t){let o,i=null;return this._components.some((e=>(o=e.id===t,o&&(i=e),o))),i}_findByNode(t){let o,i=null;return this._components.some((e=>(o=e.node===t,o&&(i=e),o))),i}};e$e([y$e()],y$1.prototype,"container",null),e$e([y$e()],y$1.prototype,"height",null),e$e([y$e({value:h$2})],y$1.prototype,"padding",null),e$e([c$r("padding")],y$1.prototype,"castPadding",null),e$e([y$e()],y$1.prototype,"view",void 0),e$e([y$e()],y$1.prototype,"width",null),y$1=e$e([i$o("esri.views.ui.UI")],y$1);var C$1=y$1;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
function p$6(t,e){return t&&"copyright"in t&&(!e||"function"==typeof t.originOf&&"user"===t.originOf("copyright"))}function d$1(t,e){return t.length!==e.length||t.some(((t,i)=>t.text!==e[i].text))}function m$2(t,e,i){if(!i||!e)return;t.find((t=>t.layerView===e&&t.text===i))||t.push({text:i,layerView:e});}function f(t){return "bing-maps"===t.type}const b=[];let y=class extends d$h{constructor(t){super(t),this.clear=()=>{this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.handles.remove("suspension"),this.notifyChange("state");},this._pendingAttributions=new Set,this._fetchedAttributionData=new Map,this.items=new L$5,this.view=null,this._allLayerViewsChange=t=>{this.handles.remove("suspension");const e=this.get("view.allLayerViews");e&&this.handles.add(e.map((t=>t.watch(["suspended","attributionVisible"],this._updateAttributionItems))),"suspension"),t&&t.removed&&t.removed.forEach((t=>{this._pendingAttributions.delete(t),this._fetchedAttributionData.delete(t);})),this._updateAttributionItems();},this._updateAttributionItems=()=>{const t=this.get("view.allLayerViews");b.length=0,t?(t.forEach((t=>{if(t.suspended||!t.get("layer.attributionVisible"))return;const e=t.layer;if(p$6(e,"user"))return void m$2(b,t,e.copyright);if(e.hasAttributionData){if(this._fetchedAttributionData.has(t)){const i=this._fetchedAttributionData.get(t);return void(i?m$2(b,t,this._getDynamicAttribution(i,this.view,e)):p$6(e)&&m$2(b,t,e.copyright))}return void this._fetchAttributionData(t)}const i=e.get("portalItem.accessInformation");m$2(b,t,i||e.copyright);})),d$1(this.items,b)&&(this.items.removeAll(),this.items.addMany(b)),b.length=0,this.notifyChange("state")):this.clear();},this.handles.add([C$7(this,"view.allLayerViews","change",this._allLayerViewsChange,this._allLayerViewsChange,this.clear),w$5(this,"view.stationary",(()=>this._updateAttributionItems()))]);}destroy(){this.view=null,this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.items.removeAll();}get state(){return this.get("view.ready")?this._pendingAttributions.size>0?"loading":"ready":"disabled"}async _fetchAttributionData(t){if(this._pendingAttributions.has(t))return;this._pendingAttributions.add(t);const e=await o$q(t.layer.fetchAttributionData());if(this._pendingAttributions.has(t)){const i=e.ok?this._createContributionIndex(e.value,f(t.layer)):null;this._pendingAttributions.delete(t),this._fetchedAttributionData.set(t,i);}this._updateAttributionItems();}_createContributionIndex(t,e){const i=t.contributors,s={};if(!i)return s;for(let n=0;n<i.length;n++){const t=i[n],a=t.coverageAreas;if(!a)return;for(const i of a){const a=i.bbox,c=i.zoomMin-(e&&i.zoomMin?1:0),u=i.zoomMax-(e&&i.zoomMax?1:0),h={xmin:a[1],ymin:a[0],xmax:a[3],ymax:a[2],spatialReference:k$7.WGS84},l={extent:d$j(h),attribution:t.attribution||"",score:null!=i.score?i.score:100,id:n};for(let t=c;t<=u;t++)s[t]=s[t]||[],s[t].push(l);}}return s.maxKey=Math.max.apply(null,Object.keys(s)),s}_getDynamicAttribution(t,e,i){const{extent:r,scale:o}=e;let a=i.tileInfo.scaleToZoom(o);if(a=Math.min(t.maxKey,Math.round(a)),!r||null==a||a<=-1)return "";const c=t[a],u=g$h(r.center.clone().normalize(),e.spatialReference),h={};return c?c.filter((t=>{const e=!h[t.id]&&u&&t$m(t.extent,u);return e&&(h[t.id]=!0),e})).sort(((t,e)=>e.score-t.score||t.objectId-e.objectId)).map((t=>t.attribution)).join(", "):""}};e$e([y$e({readOnly:!0,type:L$5})],y.prototype,"items",void 0),e$e([y$e({readOnly:!0})],y.prototype,"state",null),e$e([y$e()],y.prototype,"view",void 0),y=e$e([i$o("esri.widgets.Attribution.AttributionViewModel")],y);var g$2=y;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const p$5={base:"esri-attribution esri-widget",anchor:"esri-widget__anchor",poweredBy:"esri-attribution__powered-by",sources:"esri-attribution__sources",open:"esri-attribution--open",sourcesOpen:"esri-attribution__sources--open",link:"esri-attribution__link",widgetIcon:"esri-icon-description",interactive:"esri-interactive"};let l$2=class extends L$7{constructor(e,t){super(e,t),this._isOpen=!1,this._attributionTextOverflowed=!1,this._prevSourceNodeHeight=0,this.iconClass=p$5.widgetIcon,this.itemDelimiter=" | ",this.label=void 0,this.messages=null,this.view=null,this.viewModel=new g$2;}initialize(){this.own(C$7(this,"viewModel.items","change",(()=>this.scheduleRender())));}get attributionText(){return this.viewModel.items.reduce(((e,t)=>(-1===e.indexOf(t.text)&&e.push(t.text),e)),[]).join(this.itemDelimiter)}render(){const e={[p$5.open]:this._isOpen};return o$i("div",{bind:this,class:this.classes(p$5.base,e),onclick:this._toggleState,onkeydown:this._toggleState},this.renderSourcesNode(),this.renderPoweredBy())}renderPoweredBy(){return o$i("div",{class:p$5.poweredBy},"Powered by"," ",o$i("a",{class:this.classes(p$5.link,p$5.anchor),href:"http://www.esri.com/",target:"_blank",rel:"noreferrer"},"Esri"))}renderSourcesNode(){const e=this._isOpen,t=this._isInteractive(),i=t?0:-1,{attributionText:r}=this,s=t?"button":void 0,o={[p$5.sourcesOpen]:e,[p$5.interactive]:t};return o$i("div",{afterCreate:this._afterSourcesNodeCreate,afterUpdate:this._afterSourcesNodeUpdate,bind:this,class:this.classes(p$5.sources,o),innerHTML:r,role:s,tabIndex:i})}_afterSourcesNodeCreate(e){this._prevSourceNodeHeight=e.clientWidth;}_afterSourcesNodeUpdate(e){let t=!1;const{clientHeight:i,clientWidth:r,scrollWidth:s}=e,o=s>=r,n=this._attributionTextOverflowed!==o;if(this._attributionTextOverflowed=o,n&&(t=!0),this._isOpen){const e=i<this._prevSourceNodeHeight;this._prevSourceNodeHeight=i,e&&(this._isOpen=!1,t=!0);}t&&this.scheduleRender();}_toggleState(){this._isInteractive()&&(this._isOpen=!this._isOpen);}_isInteractive(){return this._isOpen||this._attributionTextOverflowed}};e$e([y$e({readOnly:!0,dependsOn:["viewModel.items.length","itemDelimiter"]})],l$2.prototype,"attributionText",null),e$e([y$e()],l$2.prototype,"iconClass",void 0),e$e([y$e()],l$2.prototype,"itemDelimiter",void 0),e$e([y$e({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],l$2.prototype,"label",void 0),e$e([y$e(),e$h("esri/widgets/Attribution/t9n/Attribution")],l$2.prototype,"messages",void 0),e$e([o$j("viewModel.view")],l$2.prototype,"view",void 0),e$e([y$e({type:g$2})],l$2.prototype,"viewModel",void 0),e$e([n$z()],l$2.prototype,"_toggleState",null),l$2=e$e([i$o("esri.widgets.Attribution")],l$2);var u$2=l$2;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const n$3="esri.widgets.CompassViewModel";let h$1=class extends(e$j(u$k)){constructor(t){super(t),this._handles=new u$j,this.orientation={x:0,y:0,z:0},this.view=null,this._updateForCamera=this._updateForCamera.bind(this),this._updateForRotation=this._updateForRotation.bind(this),this._updateRotationWatcher=this._updateRotationWatcher.bind(this);}initialize(){this._handles.add(d$f(this,"view",this._updateRotationWatcher));}destroy(){this._handles.destroy(),this._handles=null,this.view=null;}get canShowNorth(){const t=this.get("view.spatialReference");return !(!t||!t.isWebMercator&&!t.isGeographic)}get state(){return this.get("view.ready")?this.canShowNorth?"compass":"rotation":"disabled"}reset(){if(!this.get("view.ready"))return;const t={};"2d"===this.view.type?t.rotation=0:t.heading=0,this.callGoTo({target:t});}_updateForRotation(t){null!=t&&(this.orientation={z:t});}_updateForCamera(t){if(!t)return;const o=-t.heading;this.orientation={x:0,y:0,z:o};}_updateRotationWatcher(t){this._handles.removeAll(),t&&("2d"===t.type?this._handles.add(d$f(this,"view.rotation",this._updateForRotation)):this._handles.add(d$f(this,"view.camera",this._updateForCamera)));}};e$e([y$e({readOnly:!0})],h$1.prototype,"canShowNorth",null),e$e([y$e()],h$1.prototype,"orientation",void 0),e$e([y$e({readOnly:!0})],h$1.prototype,"state",null),e$e([y$e()],h$1.prototype,"view",void 0),h$1=e$e([i$o(n$3)],h$1);var p$4=h$1;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const n$2={base:"esri-compass esri-widget--button esri-widget",text:"esri-icon-font-fallback-text",icon:"esri-compass__icon",rotationIcon:"esri-icon-dial",northIcon:"esri-icon-compass",widgetIcon:"esri-icon-locate-circled",interactive:"esri-interactive",disabled:"esri-disabled"};let l$1=class extends L$7{constructor(e,s){super(e,s),this.goToOverride=null,this.iconClass=n$2.widgetIcon,this.label=void 0,this.messages=null,this.view=null,this.viewModel=new p$4;}reset(){return this.viewModel.reset()}render(){const{orientation:e,state:s}=this.viewModel,o="disabled"===s,t="compass"===("rotation"===s?"rotation":"compass"),r=o?-1:0,i={[n$2.disabled]:o,[n$2.interactive]:!o},c={[n$2.northIcon]:t,[n$2.rotationIcon]:!t},{messages:p}=this;return o$i("div",{bind:this,class:this.classes(n$2.base,i),onclick:this._reset,onkeydown:this._reset,role:"button",tabIndex:r,"aria-label":p.reset,title:p.reset},o$i("span",{"aria-hidden":"true",class:this.classes(n$2.icon,c),styles:this._toRotationTransform(e)}),o$i("span",{class:n$2.text},p.reset))}_reset(){this.viewModel.reset();}_toRotationTransform(e){return {transform:`rotateZ(${e.z}deg)`}}};e$e([o$j("viewModel.goToOverride")],l$1.prototype,"goToOverride",void 0),e$e([y$e()],l$1.prototype,"iconClass",void 0),e$e([y$e({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],l$1.prototype,"label",void 0),e$e([y$e(),e$h("esri/widgets/Compass/t9n/Compass")],l$1.prototype,"messages",void 0),e$e([o$j("viewModel.view")],l$1.prototype,"view",void 0),e$e([y$e({type:p$4})],l$1.prototype,"viewModel",void 0),e$e([n$z()],l$1.prototype,"_reset",null),l$1=e$e([i$o("esri.widgets.Compass")],l$1);var d=l$1;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
let a$1=class extends u$k{constructor(t){super(t),this._handles=new u$j,this.navigationMode="pan",this.view=null;}initialize(){this._handles.add(y$h(this,"view.inputManager",this._setNavigationMode.bind(this)));}destroy(){this._handles.destroy(),this._handles=null,this.view=null;}get state(){return this.get("view.ready")&&"3d"===this.view.type?"ready":"disabled"}toggle(){"disabled"!==this.state&&(this.navigationMode="pan"!==this.navigationMode?"pan":"rotate",this._setNavigationMode());}_setNavigationMode(){this.get("view.inputManager").primaryDragAction="pan"===this.navigationMode?"pan":"rotate";}};e$e([y$e({readOnly:!0})],a$1.prototype,"state",null),e$e([y$e()],a$1.prototype,"navigationMode",void 0),e$e([y$e()],a$1.prototype,"view",void 0),a$1=e$e([i$o("esri.widgets.NavigationToggleViewModel")],a$1);var n$1=a$1;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const g$1={base:"esri-navigation-toggle esri-widget",button:"esri-navigation-toggle__button esri-widget--button",activeButton:"esri-navigation-toggle__button--active",panButton:"esri-navigation-toggle__button--pan",rotateButton:"esri-navigation-toggle__button--rotate",isLayoutHorizontal:"esri-navigation-toggle--horizontal",rotationIcon:"esri-icon-rotate",panIcon:"esri-icon-pan",widgetIcon:"esri-icon-pan2",disabled:"esri-disabled"};let p$3=class extends L$7{constructor(t,o){super(t,o),this.iconClass=g$1.widgetIcon,this.label=void 0,this.messages=null,this.view=null,this.viewModel=new n$1;}set layout(t){"horizontal"!==t&&(t="vertical"),this._set("layout",t);}toggle(){return this.viewModel.toggle()}render(){const t="disabled"===this.get("viewModel.state"),o="pan"===this.get("viewModel.navigationMode"),e={[g$1.disabled]:t,[g$1.isLayoutHorizontal]:"horizontal"===this.layout},s={[g$1.activeButton]:o},i={[g$1.activeButton]:!o},r=t?-1:0,n=this.messages.toggle;return o$i("div",{bind:this,class:this.classes(g$1.base,e),onclick:this._toggle,onkeydown:this._toggle,tabIndex:r,"aria-label":n,title:n},o$i("div",{class:this.classes(g$1.button,g$1.panButton,s)},o$i("span",{class:g$1.panIcon})),o$i("div",{class:this.classes(g$1.button,g$1.rotateButton,i)},o$i("span",{class:g$1.rotationIcon})))}_toggle(){this.toggle();}};e$e([y$e()],p$3.prototype,"iconClass",void 0),e$e([y$e({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],p$3.prototype,"label",void 0),e$e([y$e({value:"vertical"})],p$3.prototype,"layout",null),e$e([y$e(),e$h("esri/widgets/NavigationToggle/t9n/NavigationToggle")],p$3.prototype,"messages",void 0),e$e([o$j("viewModel.view")],p$3.prototype,"view",void 0),e$e([y$e({type:n$1})],p$3.prototype,"viewModel",void 0),e$e([n$z()],p$3.prototype,"_toggle",null),p$3=e$e([i$o("esri.widgets.NavigationToggle")],p$3);var c$2=p$3;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const c$1={button:"esri-widget--button esri-widget",disabled:"esri-disabled",interactive:"esri-interactive",iconText:"esri-icon-font-fallback-text",icon:"esri-icon"};let n=class extends L$7{constructor(){super(...arguments),this.enabled=!0,this.iconClass="",this.title="";}render(){const t=this.enabled?0:-1,s={[c$1.disabled]:!this.enabled,[c$1.interactive]:this.enabled},o={[this.iconClass]:!!this.iconClass};return o$i("div",{bind:this,class:this.classes(c$1.button,s),onclick:this._triggerAction,onkeydown:this._triggerAction,role:"button",tabIndex:t,title:this.title},o$i("span",{"aria-hidden":"true",role:"presentation",class:this.classes(c$1.icon,o)}),o$i("span",{class:c$1.iconText},this.title))}_triggerAction(){this.action.call(this);}};e$e([y$e()],n.prototype,"action",void 0),e$e([y$e()],n.prototype,"enabled",void 0),e$e([y$e()],n.prototype,"iconClass",void 0),e$e([y$e()],n.prototype,"title",void 0),e$e([n$z()],n.prototype,"_triggerAction",null),n=e$e([i$o("esri.widgets.IconButton")],n);var a=n;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
let s$1=class extends u$k{get canZoomIn(){if(!this.get("view.ready"))return !1;const e=this.get("view.animation.target.scale")||this.get("view.scale"),t=this.get("view.constraints.effectiveMaxScale");return 0===t||e>t}get canZoomOut(){if(!this.get("view.ready"))return !1;const e=this.get("view.animation.target.scale")||this.get("view.scale"),t=this.get("view.constraints.effectiveMinScale");return 0===t||e<t}};e$e([y$e({readOnly:!0})],s$1.prototype,"canZoomIn",null),e$e([y$e({readOnly:!0})],s$1.prototype,"canZoomOut",null),e$e([y$e()],s$1.prototype,"view",void 0),s$1=e$e([i$o("esri.widgets.Zoom.ZoomConditions2D")],s$1);var i=s$1;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
let s=class extends u$k{get canZoomIn(){return !!this.get("view.ready")}get canZoomOut(){return !!this.get("view.ready")}};e$e([y$e({readOnly:!0})],s.prototype,"canZoomIn",null),e$e([y$e({readOnly:!0})],s.prototype,"canZoomOut",null),e$e([y$e()],s.prototype,"view",void 0),s=e$e([i$o("esri.widgets.Zoom.ZoomConditions3D")],s);var p$2=s;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
let m$1=class extends u$k{constructor(o){super(o),this.canZoomIn=!1,this.canZoomOut=!1;}destroy(){this.view=null;}get state(){return this.get("view.ready")?"ready":"disabled"}set view(o){o?"2d"===o.type?this._zoomConditions=new i({view:o}):"3d"===o.type&&(this._zoomConditions=new p$2({view:o})):this._zoomConditions=null,this._set("view",o);}zoomIn(){if(!this.canZoomIn)return;const o=this.view;"2d"===o.type?o.mapViewNavigation.zoomIn():y$i(o.goTo({zoomFactor:2}));}zoomOut(){if(!this.canZoomOut)return;const o=this.view;"2d"===o.type?o.mapViewNavigation.zoomOut():y$i(o.goTo({zoomFactor:.5}));}};e$e([y$e()],m$1.prototype,"_zoomConditions",void 0),e$e([y$e({aliasOf:"_zoomConditions.canZoomIn",readOnly:!0})],m$1.prototype,"canZoomIn",void 0),e$e([y$e({aliasOf:"_zoomConditions.canZoomOut",readOnly:!0})],m$1.prototype,"canZoomOut",void 0),e$e([y$e({readOnly:!0})],m$1.prototype,"state",null),e$e([y$e()],m$1.prototype,"view",null),m$1=e$e([i$o("esri.widgets.Zoom.ZoomViewModel")],m$1);var p$1=m$1;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const u$1={base:"esri-zoom esri-widget",horizontalLayout:"esri-zoom--horizontal",zoomInIcon:"esri-icon-plus",zoomOutIcon:"esri-icon-minus",widgetIcon:"esri-icon-zoom-in-magnifying-glass"};let l=class extends L$7{constructor(o,t){super(o,t),this.iconClass=u$1.widgetIcon,this.label=void 0,this.messages=null,this.view=null,this.viewModel=new p$1;}initialize(){this._zoomInButton=new a({action:this.zoomIn.bind(this),iconClass:u$1.zoomInIcon}),this._zoomOutButton=new a({action:this.zoomOut.bind(this),iconClass:u$1.zoomOutIcon});}destroy(){this._zoomInButton.destroy(),this._zoomOutButton.destroy(),this._zoomInButton=null,this._zoomOutButton=null;}set layout(o){"horizontal"!==o&&(o="vertical"),this._set("layout",o);}render(){const o=this.viewModel,t={[u$1.horizontalLayout]:"horizontal"===this.layout};return this._zoomInButton.enabled="ready"===o.state&&o.canZoomIn,this._zoomOutButton.enabled="ready"===o.state&&o.canZoomOut,this._zoomInButton.title=this.messages.zoomIn,this._zoomOutButton.title=this.messages.zoomOut,o$i("div",{class:this.classes(u$1.base,t)},this._zoomInButton.render(),this._zoomOutButton.render())}zoomIn(){return this.viewModel.zoomIn()}zoomOut(){return this.viewModel.zoomOut()}};e$e([y$e()],l.prototype,"iconClass",void 0),e$e([y$e({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],l.prototype,"label",void 0),e$e([y$e({value:"vertical"})],l.prototype,"layout",null),e$e([y$e(),e$h("esri/widgets/Zoom/t9n/Zoom")],l.prototype,"messages",void 0),e$e([o$j("viewModel.view")],l.prototype,"view",void 0),e$e([y$e({type:p$1})],l.prototype,"viewModel",void 0),l=e$e([i$o("esri.widgets.Zoom")],l);var c=l;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const m="esri.views.ui.DefaultUI";n$v.getLogger(m);function h(t){return t&&void 0!==t.view}let u=class extends C$1{constructor(t){super(t),this._defaultPositionLookup={attribution:"manual",compass:"top-leading","navigation-toggle":"top-leading",zoom:"top-leading"},this.components=[];}initialize(){this._handles.add([d$f(this,"components",this._componentsWatcher.bind(this)),d$f(this,"view",this._updateViewAwareWidgets.bind(this))]);}_add(t,o,i,e){if("string"==typeof t&&this._defaultPositionLookup[t]){if(this._find(t))return;t=this._createComponent(t);}super._add(t,o,i,e);}_removeComponents(t){t.forEach((t=>{const o=this._find(t);o&&(this.remove(o),o.destroy());}));}_updateViewAwareWidgets(t){this.components.forEach((o=>{const i=this._find(o),e=i&&i.widget;h(e)&&(e.view=t);}));}_componentsWatcher(t,o){this._removeComponents(o),this._addComponents(t),this._adjustPadding(t);}_adjustPadding(t){if(-1===t.indexOf("attribution")&&!this._isOverridden("padding")){const{top:t}=this.padding;this.padding=t;}}_addComponents(t){this.initialized&&t.forEach((t=>this.add(this._createComponent(t),this._defaultPositionLookup[t])));}_createComponent(t){const o=this._createWidget(t);if(o)return new u$4({id:t,node:o})}_createWidget(t){return "attribution"===t?this._createAttribution():"compass"===t?this._createCompass():"navigation-toggle"===t?this._createNavigationToggle():"zoom"===t?this._createZoom():void 0}_createAttribution(){return new u$2({view:this.view})}_createCompass(){return new d({view:this.view})}_createNavigationToggle(){return new c$2({view:this.view})}_createZoom(){return new c({view:this.view})}};e$e([y$e()],u.prototype,"components",void 0),u=e$e([i$o(m)],u);var g=u;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
let e=class extends g{constructor(o){super(o),this.components=["attribution","zoom"];}};e$e([y$e()],e.prototype,"components",void 0),e=e$e([i$o("esri.views.ui.2d.DefaultUI2D")],e);var p=e;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const M=n$v.getLogger("esri.views.MapView");let j,O,C,L,S,k;async function E(){const[,{GraphicsView2D:e,GraphicContainer:t,LabelManager:i,MapViewNavigation:r,MagnifierView2D:s,Stage:a}]=await Promise.all([import('./webgl-02e5f62e.js'),import('./mapViewDeps-cba28061.js')]);O=e,C=t,L=i,S=r,k=s,j=a;}function x(e){return e instanceof n$x}function N(e,t,i){if(e)if(Array.isArray(e)||L$5.isCollection(e)){if(0===e.length)return;e.forEach((e=>N(e,t,i)));}else x(e)?t.add(e):i.add(e);}let P=class extends(m$i(_$3(L$1))){constructor(e){super(e),this._magnifierView=null,this._stage=null,this._resolveWhenReady=[],this.rootLayerViews=new l$n({root:this,rootCollectionNames:["basemapView.baseLayerViews","layerViews","basemapView.referenceLayerViews"],getChildrenFunction:e=>null}),this.floors=new L$5,this.graphicsView=null,this.highlightOptions=new c$4,this.inputManager=new E$1({view:this}),this.mapViewNavigation=null,this.supersampleScreenhotsEnabled=!0,this.ui=new p,this.rendering=!1,m$q();}destroy(){this.rootLayerViews.destroy(),this.inputManager.destroy(),this._set("inputManager",null);}get background(){return this.get("map.initialViewProperties.background")||null}set background(e){void 0===e?this._clearOverride("background"):this._override("background",e);}get textureManager(){return this._stage.painter.textureManager}get navigating(){return !(!this.mapViewNavigation||!this.mapViewNavigation.interacting)}toMap(e){if(i$e(e)){const t=n$l(this,e);return super.toMap(t)}return super.toMap(e)}hitTest(e,t){const i=i$e(e)?n$l(this,e):e;if(!this.ready||isNaN(i.x)||isNaN(i.y))return Promise.resolve({screenPoint:i,results:[]});const r=this.toMap(i),s=[this.graphicsView];s.push.apply(s,this.allLayerViews.toArray().reverse());const a=new Set,n=new Set,o=new Set,h=new Set;return t&&(N(t&&t.include,a,o),N(t&&t.exclude,n,h)),Promise.all(s.map((e=>!e||!e.hitTest||o.size>0&&!e.layer||o.size>0&&e.layer&&!o.has(e.layer)||h.size>0&&e.layer&&h.has(e.layer)?null:e.hitTest(i.x,i.y)))).then((e=>({screenPoint:i,results:e.filter((e=>null!=e&&(!(a.size>0)||a.has(e))&&(!(n.size>0)||!n.has(e)))).map((e=>({mapPoint:r,graphic:e})))})))}takeScreenshot(e){return this.ready?this._stage.takeScreenshot(n$u(e,this),this.allLayerViews):Promise.reject("Map view cannot be used before it is ready")}on(e,t,i,r){const s=this.inputManager&&this.viewEvents.on(e,t,i,r);return s||super.on(e,t)}hasEventListener(e){return super.hasEventListener(e)||this.viewEvents.hasHandler(e)}whenLayerView(e){return super.whenLayerView(e)}graphicChanged(e){if(this.graphicsView){this.graphicsView.graphicUpdateHandler(e);}}whenReady(){return new Promise((e=>{this.ready?e(this):this._resolveWhenReady.push(e);}))}forceDOMReadyCycle(){this.forceReadyCycle();}validate(){let e=s$2({checkMajorWebPerformanceCaveat:!1});return t$g("safari")&&t$g("safari")<9&&(e=new s$n("mapview:browser-not-supported","This browser is not supported by MapView (Safari < 9)",{type:"safari",requiredVersion:9,detectedVersion:t$g("safari")})),r$f(e)?(M.warn("#validate()",e.message),Promise.reject(e)):E()}_startup(){this.timeline.begin("MapView Startup"),super._startup(),this.graphics.owner=this;const e={disabledExtensions:this.deactivatedWebGLExtensions,debugWebGLExtensions:this.debugWebGLExtensions},t=new j(this.surface,{canvas:this.renderCanvas,supersampleScreenshots:this.supersampleScreenhotsEnabled,contextOptions:e,renderingOptions:this.renderingOptions,timeline:this.timeline}),i=new O({view:this,graphics:this.graphics,requestUpdateCallback:()=>this.requestUpdate(),container:new C(this.featuresTilingScheme)}),r=new S({view:this,animationManager:this.animationManager}),s=new L({view:this});this._magnifierView=new k,this._magnifierView.magnifier=this.magnifier,this._stage=t,this.frameTask.graphicsView=i,this._set("graphicsView",i),this._set("mapViewNavigation",r),this._set("labelManager",s),this.handles.add([this.rootLayerViews.on("change",(()=>this._updateStageChildren())),t.on("post-render",(()=>this._set("rendering",t.renderRequested))),t.on("will-render",(()=>this._set("rendering",t.renderRequested))),t.on("webgl-error",(e=>this.fatalError=e.error)),d$f(this,"stationary",(e=>t.stationary=e),!0),d$f(this,"state.id",(()=>t.state=this.state),!0),d$f(this,"background",(e=>{t.background=e,this._magnifierView.background=e;}),!0),d$f(this,"magnifier",(e=>this._magnifierView.magnifier=e),!0),d$f(this,"renderingOptions",(e=>t.renderingOptions=e),!0),d$f(this,"highlightOptions",(()=>t.highlightOptions=this.highlightOptions),!0)],"map-view"),t.state=this.state,this._updateStageChildren();const a=this._resolveWhenReady;this._resolveWhenReady=[],a.forEach((e=>e(this))),this.timeline.end("MapView Startup");}_teardown(){this.handles.remove("map-view"),this.layerViewManager.clear(),this.labelManager.destroy(),this._magnifierView.destroy(),this._stage.destroy();this.graphicsView.destroy(),this.mapViewNavigation.destroy(),this._stage=null,this._set("graphicsView",null),this._magnifierView=null,this._set("labelManager",null),this._set("mapViewNavigation",null),this.graphics.owner=null,super._teardown();}_updateStageChildren(){this._stage.removeAllChildren(),this.rootLayerViews.forEach((e=>{this._stage.addChild(e.container);}));const e=this.graphicsView;this._stage.addChild(e.container),this._stage.addChild(this._magnifierView);}};e$e([y$e({type:m$k})],P.prototype,"background",null),e$e([y$e()],P.prototype,"floors",void 0),e$e([y$e()],P.prototype,"graphicsView",void 0),e$e([y$e({type:c$4})],P.prototype,"highlightOptions",void 0),e$e([y$e({readOnly:!0})],P.prototype,"inputManager",void 0),e$e([y$e({readOnly:!0})],P.prototype,"textureManager",null),e$e([y$e({readOnly:!0})],P.prototype,"mapViewNavigation",void 0),e$e([y$e({type:Boolean})],P.prototype,"navigating",null),e$e([y$e({type:Boolean,constructOnly:!0})],P.prototype,"supersampleScreenhotsEnabled",void 0),e$e([y$e({type:p})],P.prototype,"ui",void 0),e$e([y$e({readOnly:!0})],P.prototype,"rendering",void 0),e$e([y$e({constructOnly:!0})],P.prototype,"renderCanvas",void 0),e$e([y$e({constructOnly:!0})],P.prototype,"deactivatedWebGLExtensions",void 0),e$e([y$e({constructOnly:!0})],P.prototype,"debugWebGLExtensions",void 0),P=e$e([i$o("esri.views.MapView")],P);var W=P;

export { $, Ft as F, Mt as M, St as S, W, e$7 as a, e$5 as b, a$i as c, d$e as d, e$c as e, f$c as f, r$5 as g, i$c as i, l$k as l, n$c as n, pt as p, rt as r, u$9 as u, vt as v, xt as x };
