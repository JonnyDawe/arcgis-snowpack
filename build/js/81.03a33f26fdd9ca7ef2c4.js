(window.webpackJsonp=window.webpackJsonp||[]).push([[81],{288:function(e,t,r){"use strict";r.r(t);r(18);var i=r(0),n=(r(1),r(53)),a=r(337),s=r(224);r(9),r(20),r(3),r(6),r(4),r(13),r(52),r(51),r(82),r(21),r(62),r(26),r(24),r(85),r(48),r(70),r(10),r(109),r(49),r(111),r(71),r(333),r(313),r(312),r(310),r(320),r(330),r(314),r(84),r(106),r(7),r(8),r(31),r(19),r(35),r(54),r(334),r(338),r(5),r(32),r(14),r(16),r(122),r(138),r(43),r(72),r(2),r(40),r(15),r(75),r(27),r(89),r(12),r(44),r(63),r(55),r(119),r(17),r(120),r(83),r(115),r(47),r(103),r(57),r(23),r(104),r(112),r(108),r(58),r(105),r(110),r(107),r(56),r(116),r(36),r(64),r(42),r(113),r(41),r(121),r(117),r(114),r(66),r(118),r(123),r(73),r(65),r(74),r(90),r(11),r(67),r(86),r(137),r(335),r(317),r(318),r(364),r(356),r(357);function o(e,t){if(Object(i.J)(e)&&Object(i.J)(t))return null;const r={};return Object(i.P)(t)&&(r.geometry=t.toJSON()),Object(i.P)(e)&&(r.where=e),r}let c=class extends s.default{constructor(){super(...arguments),this._enabledDataReceived=!1,this.errorString=null,this.connectionStatus="disconnected"}initialize(){this.handles.add([this.layer.watch("purgeOptions",(()=>this._update()))])}destroy(){this.connectionStatus="disconnected"}get connectionError(){if(this.errorString)return new i.s("stream-controller",this.errorString)}on(e,t){"data-received"===e&&(this._enabledDataReceived=!0,this._proxy.enableEvent("data-received",!0));const r=super.on(e,t),i=this;return{remove(){r.remove(),"data-received"===e&&(i._proxy.closed||i.hasEventListener("data-received")||i._proxy.enableEvent("data-received",!1))}}}queryLatestObservations(e,t){if(!this.layer.timeInfo.endField&&!this.layer.timeInfo.startField)throw new i.s("streamlayer-no-timeField","queryLatestObservation can only be used with services that define a TrackIdField");return this._proxy.queryLatestObservations(this._cleanUpQuery(e),t).then((e=>{const t=n.default.fromJSON(e);return t.features.forEach((e=>{e.layer=this.layer,e.sourceLayer=this.layer})),t}))}_createClientOptions(){return{...super._createClientOptions(),setProperty:e=>{this.set(e.propertyName,e.value)}}}_createTileRendererHash(e){const t=`${JSON.stringify(this.layer.purgeOptions)}.${JSON.stringify(o(this.layer.definitionExpression,this.layer.geometryDefinition))})`;return super._createTileRendererHash(e)+t}async _createServiceOptions(){const e=this.layer,{objectIdField:t}=e,r=e.fields.map((e=>e.toJSON())),i=Object(a.D)(e.geometryType),n=e.timeInfo&&e.timeInfo.toJSON()||null,s=e.spatialReference?e.spatialReference.toJSON():null;return{type:"stream",fields:r,geometryType:i,objectIdField:t,timeInfo:n,source:this.layer.parsedUrl,serviceFilter:o(this.layer.definitionExpression,this.layer.geometryDefinition),purgeOptions:this.layer.purgeOptions.toJSON(),enableDataReceived:this._enabledDataReceived,spatialReference:s,maxReconnectionAttempts:this.layer.maxReconnectionAttempts,maxReconnectionInterval:this.layer.maxReconnectionInterval,updateInterval:this.layer.updateInterval}}};Object(i.e)([Object(i.y)()],c.prototype,"errorString",void 0),Object(i.e)([Object(i.y)({readOnly:!0})],c.prototype,"connectionError",null),Object(i.e)([Object(i.y)()],c.prototype,"connectionStatus",void 0),c=Object(i.e)([Object(i.i)("esri.views.2d.layers.StreamLayerView2D")],c);var l=c;t.default=l}}]);