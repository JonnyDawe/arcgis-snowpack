(window.webpackJsonp=window.webpackJsonp||[]).push([[49],{281:function(e,i,t){"use strict";t.r(i);var r=t(0),s=(t(1),t(335)),a=t(312),l=t(325);t(40),t(5),t(317),t(318),t(137),t(31),t(8),t(310),t(9),t(313),t(314),t(316),t(323),t(319),t(138),t(20),t(3),t(6),t(4),t(13),t(52),t(43),t(72),t(2),t(15),t(75),t(10),t(27),t(14),t(16),t(51),t(82),t(89),t(53),t(12),t(44),t(106),t(63),t(55),t(119),t(17),t(120),t(48),t(83),t(115),t(47),t(103),t(32),t(57),t(23),t(70),t(21),t(62),t(26),t(24),t(85),t(109),t(49),t(111),t(71),t(104),t(112),t(108),t(58),t(105),t(110),t(107),t(56),t(116),t(36),t(64),t(42),t(113),t(41),t(121),t(117),t(114),t(66),t(118),t(35),t(54),t(123),t(73),t(84),t(65),t(74),t(90),t(11),t(7),t(19),t(67),t(86),t(122),t(326),t(321),t(320);let n=class extends s.a{constructor(e){super(e),this.layerViews=new r.L}initialize(){this.handles.add([this.layerViews.on("change",(e=>this._layerViewsChangeHandler(e))),this.layerViews.on("after-changes",(()=>this._layerViewsAfterChangesHandler())),this.layer.watch("visibilityMode",(()=>this._visibilityModeHandler()),!0),this.watch("visible",(()=>this._visibleHandler()),!0)],"grouplayerview"),this._layerViewsChangeHandler({target:null,added:this.layerViews.toArray(),removed:[],moved:[]}),this._layerViewsAfterChangesHandler()}set layerViews(e){this._set("layerViews",Object(r.c)(e,this._get("layerViews")))}isUpdating(){return this.layerViews.some((e=>e.updating))}_hasLayerViewVisibleOverrides(){return this.layerViews.some((e=>e._isOverridden("visible")))}_findLayerViewForLayer(e){return e&&this.layerViews.find((i=>i.layer===e))}_firstVisibleOnLayerOrder(){const e=this.layer.layers.find((e=>{const i=this._findLayerViewForLayer(e);return i&&i.visible}));return e&&this._findLayerViewForLayer(e)}_enforceExclusiveVisibility(e){this._hasLayerViewVisibleOverrides()&&(e||!(e=this._firstVisibleOnLayerOrder())&&this.layerViews.length>0&&(e=this._findLayerViewForLayer(this.layer.layers.getItemAt(0))),this.layerViews.forEach((i=>{i.visible=i===e})))}_layerViewsChangeHandler(e){this.handles.remove("grouplayerview:visible"),this.handles.add(this.layerViews.map((e=>e.watch("visible",(i=>this._layerViewVisibleHandler(i,e)),!0))).toArray(),"grouplayerview:visible");const i=e.added[e.added.length-1];let t=null;i&&i.visible&&(t=i),this._enforceVisibility(t)}_layerViewsAfterChangesHandler(){this.handles.remove("grouplayerview:updating"),this.handles.add(this.layerViews.map((e=>e.watch("updating",(()=>this._updateUpdating()),!0))).toArray(),"grouplayerview:updating"),this._updateUpdating()}_enforceVisibility(e){if(this._hasLayerViewVisibleOverrides())switch(this.layer.visibilityMode){case"inherited":{const e=this.visible;this.layerViews.forEach((i=>{i.visible=e}));break}case"exclusive":this._enforceExclusiveVisibility(e)}}_visibilityModeHandler(){this._enforceVisibility()}_layerViewVisibleHandler(e,i){if(this._hasLayerViewVisibleOverrides())switch(this.layer.visibilityMode){case"inherited":e!==this.visible&&(i.visible=this.visible);break;case"exclusive":this._enforceExclusiveVisibility(e&&i)}}_visibleHandler(){var e;this._hasLayerViewVisibleOverrides()&&"inherited"===(null==(e=this.layer)?void 0:e.visibilityMode)&&this._enforceVisibility()}_updateUpdating(){this.notifyChange("updating")}};Object(r.e)([Object(r.y)({cast:r.aW})],n.prototype,"layerViews",null),Object(r.e)([Object(r.y)()],n.prototype,"view",void 0),n=Object(r.e)([Object(r.i)("esri.views.layers.GroupLayerView")],n);var h=n;class d extends l.g{constructor(){super(...arguments),this._lastWidth=0,this._lastHeight=0,this.requiresDedicatedFBO=!1}dispose(){this._renderTarget&&(this._renderTarget.dispose(),this._renderTarget=null)}doRender(e){const i=this.createRenderParams(e),{context:t,painter:r,profiler:s}=i;this._prevFBO=t.getBoundFramebufferObject(),s.recordContainerStart(this.name);const a=this._getFbo(i),l=r.getRenderTarget();t.bindFramebuffer(a),r.setRenderTarget(a),t.setDepthWriteEnabled(!0),t.setColorMask(!0,!0,!0,!0),t.setClearColor(0,0,0,0),t.setClearDepth(1),t.clear(t.gl.COLOR_BUFFER_BIT|t.gl.DEPTH_BUFFER_BIT),t.setDepthWriteEnabled(!1);for(const i of this.children)i.beforeRender(e);for(const e of this.children)e.processRender(i);for(const i of this.children)i.afterRender(e);r.setRenderTarget(l),t.bindFramebuffer(this._prevFBO),r.beforeRenderLayer(i,this._clippingInfos?255:0,this.computedOpacity),t.setStencilTestEnabled(!1),t.setStencilWriteMask(0),r.blitTexture(t,a.colorTexture,9728),r.compositeLayer(i,this.computedOpacity),s.recordContainerEnd()}createRenderParams(e){return{...super.createRenderParams(e),blendMode:this.blendMode,effects:this.computedEffects,globalOpacity:1}}_getFbo(e){const{context:i,painter:t}=e,{width:r,height:s}=i.getViewport();if(r!==this._lastWidth||s!==this._lastHeight)if(this._lastWidth=r,this._lastHeight=s,this._renderTarget)this._renderTarget.resize(r,s);else{const e={target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:r,height:s},l={colorTarget:0,depthStencilTarget:3},n=t.getSharedStencilBuffer();this._renderTarget=new a.g(i,l,e,n)}return this._renderTarget}}let o=class extends(Object(s.b)(h)){constructor(){super(...arguments),this.container=new d}attach(){this._updateStageChildren(),this.handles.add(this.layerViews.on("after-changes",(()=>this._updateStageChildren())),"grouplayerview2d")}detach(){this.handles.remove("grouplayerview2d"),this.container.removeAllChildren()}hitTest(e,i){return null}update(e){}moveStart(){}viewChange(){}moveEnd(){}_updateStageChildren(){this.container.removeAllChildren(),this.layerViews.forEach(((e,i)=>this.container.addChildAt(e.container,i)))}};o=Object(r.e)([Object(r.i)("esri.views.2d.layers.GroupLayerView2D")],o);var c=o;i.default=c}}]);