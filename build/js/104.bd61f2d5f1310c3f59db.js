(window.webpackJsonp=window.webpackJsonp||[]).push([[104],{235:function(e,r,a){"use strict";a.r(r),a.d(r,"fromUrl",(function(){return s}));var t=a(0),n=a(32),l=a(371);a(1),a(13);async function s(e){var r;const s=null==(r=e.properties)?void 0:r.customParameters,c=await async function(e,r){let a=Object(n.c)(e);if(Object(t.J)(a)&&(a=await async function(e,r){const a=await i(e,r);let l=null,s=null;const o=a.type;if("Feature Layer"===o||"Table"===o?(l="FeatureServer",s=a.id):"indexedVector"===o?l="VectorTileServer":a.hasOwnProperty("mapName")?l="MapServer":a.hasOwnProperty("bandCount")&&a.hasOwnProperty("pixelSizeX")?l="ImageServer":a.hasOwnProperty("maxRecordCount")&&a.hasOwnProperty("allowGeometryUpdates")?l="FeatureServer":a.hasOwnProperty("streamUrls")&&(l="StreamServer"),!l)return null;const u=null!=s?Object(n.f)(e):null;return{title:Object(t.P)(u)&&a.name||Object(t.bZ)(e),serverType:l,sublayer:s,url:{path:Object(t.P)(u)?u.serviceUrl:Object(t.U)(e).path}}}(e,r)),Object(t.J)(a))throw new t.s("arcgis-layers:url-mismatch","The url '${url}' is not a valid arcgis resource",{url:e});const{serverType:s,sublayer:o}=a;let c;const y={FeatureServer:"FeatureLayer",StreamServer:"StreamLayer",VectorTileServer:"VectorTileLayer"};switch(s){case"MapServer":c=null!=o?"FeatureLayer":async function(e,r){return(await i(e,r)).tileInfo}(e,r).then((e=>e?"TileLayer":"MapImageLayer"));break;case"ImageServer":c=i(e,r).then((e=>{const r=e.tileInfo&&e.tileInfo.format;return e.tileInfo?!r||"LERC"!==r.toUpperCase()||e.cacheType&&"elevation"!==e.cacheType.toLowerCase()?"ImageryTileLayer":"ElevationLayer":"ImageryLayer"}));break;case"SceneServer":c=i(a.url.path,r).then((e=>{const r={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"};if(e&&Array.isArray(e.layers)&&e.layers.length>0){const a=e.layers[0].layerType;if(null!=r[a])return r[a]}return"SceneLayer"}));break;default:c=y[s]}const d={FeatureLayer:!0,SceneLayer:!0},b="FeatureServer"===s,f={parsedUrl:a,Constructor:null,layerOrTableId:b?o:null,sublayerIds:null,tableIds:null},I=await c;if(d[I]&&null==o){const a=await u(e,s,r);if(b&&(f.sublayerInfos=a.layerInfos,f.tableInfos=a.tableInfos),1!==a.layerIds.length+a.tableIds.length)f.sublayerIds=a.layerIds,f.tableIds=a.tableIds;else if(b){var p,v;f.layerOrTableId=null!=(p=a.layerIds[0])?p:a.tableIds[0],f.sourceJSON=null!=(v=a.layerInfos[0])?v:a.tableInfos[0]}}return f.Constructor=await async function(e){return(0,l.a[e])()}(I),f}(e.url,s),y={...e.properties,url:e.url};if(!c.sublayerIds)return null!=c.layerOrTableId&&(y.layerId=c.layerOrTableId,y.sourceJSON=c.sourceJSON),new c.Constructor(y);const d=new((await a.e(14).then(a.bind(null,406))).default)({title:c.parsedUrl.title});return function(e,r,a){function n(e,n){const l={...a,layerId:e,sublayerTitleMode:"service-name"};return Object(t.P)(n)&&(l.sourceJSON=n),new r.Constructor(l)}r.sublayerIds.forEach((a=>{const t=n(a,o(r.sublayerInfos,a));e.add(t)})),r.tableIds.forEach((a=>{const t=n(a,o(r.tableInfos,a));e.tables.add(t)}))}(d,c,y),d}function o(e,r){return e?e.find((e=>e.id===r)):null}async function u(e,r,a){var t,n;let l,s=!1;if("FeatureServer"===r){const r=await async function(e,r){var a,t;let n=await i(e,r);n=n||{},n.layers=(null==(a=n.layers)?void 0:a.filter(c))||[];const l={serviceJSON:n};if(n.currentVersion<10.5)return l;const s=await i(e+"/layers",r);return l.layersJSON={layers:(null==s||null==(t=s.layers)?void 0:t.filter(c))||[],tables:(null==s?void 0:s.tables)||[]},l}(e,a);s=!!r.layersJSON,l=r.layersJSON||r.serviceJSON}else l=await i(e,a);const o=null==(t=l)?void 0:t.layers,u=null==(n=l)?void 0:n.tables;return{layerIds:(null==o?void 0:o.map((e=>e.id)).reverse())||[],tableIds:(null==u?void 0:u.map((e=>e.id)).reverse())||[],layerInfos:s?o:[],tableInfos:s?u:[]}}function c(e){return!e.type||"Feature Layer"===e.type}async function i(e,r){return(await Object(t.C)(e,{responseType:"json",query:{f:"json",...r}})).data}}}]);