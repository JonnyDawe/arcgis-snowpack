(window.webpackJsonp=window.webpackJsonp||[]).push([[56],{423:function(e,t,r){"use strict";r.r(t);r(18);var i,o=r(0),s=r(1),n=r(13),a=r(382),c=r(47),p=r(103),l=r(5),y=r(23),d=r(112),u=r(105),h=r(107),b=r(388),O=r(86);r(32),r(57),r(10),r(91),r(16),r(6),r(70),r(31),r(8),r(137);function f(e){const t=Object(o.P)(e)&&e.origins?e.origins:[void 0];return(r,i)=>{const s=function(e,t,r){if(Object(o.P)(e)&&"resource"===e.type)return function(e,t,r){const i=Object(o.cQ)(t,r);return{type:String,read:(e,t,r)=>{const o=Object(n.d)(e,t,r);return i.type===String?o:"function"==typeof i.type?new i.type({url:o}):void 0},write:{writer(t,s,c,p){if(!p||!p.resources)return"string"==typeof t?void(s[c]=Object(n.c)(t,p)):void(s[c]=t.write({},p));const l=(u=t,Object(o.J)(u)?null:"string"==typeof u?u:u.url),y=l?Object(n.c)(l,{...p,verifyItemRelativeUrls:p&&p.verifyItemRelativeUrls?{writtenUrls:p.verifyItemRelativeUrls.writtenUrls,rootPath:null}:null},1):null,d=i.type!==String&&(!Object(a.b)(this)||p&&p.origin&&this.originIdOf(r)>Object(o.bE)(p.origin));var u;p&&p.portalItem&&Object(o.P)(y)&&!Object(o.aQ)(y)?d?function(e,t,r,i,s,n,a,c){const p=a.portalItem.resourceFromPath(i),l=v(r,i,a);Object(o.cR)(l)===Object(o.bY)(p.path)?(m(e,t,p,l,a.resources.toUpdate),s[n]=i):j(e,t,r,i,s,n,a,c)}(this,r,t,y,s,c,p,e):function(e,t,r,i){i.resources.toKeep.push({resource:i.portalItem.resourceFromPath(e)}),t[r]=e}(y,s,c,p):p&&p.portalItem&&(Object(o.J)(y)||Object(o.P)(Object(n.f)(y))||Object(o.cP)(y)||d)?j(this,r,t,y,s,c,p,e):s[c]=y}}}}(e,t,r);switch(Object(o.P)(e)&&e.type?e.type:"other"){case"other":return{read:!0,write:!0};case"url":{const{read:e,write:t}=n.a;return{read:e,write:t}}}}(e,r,i);for(const e of t){const t=Object(o.cO)(r,e,i);for(const e in s)t[e]=s[e]}}}function j(e,t,i,s,n,a,c,p){const l=Object(o.a$)(),y=v(i,s,c),d=Object(o.aX)(Object(o.ap)(p,"prefix"),l),u=`${d}.${Object(o.cR)(y)}`,h=c.portalItem.resourceFromPath(u);Object(o.cP)(s)&&c.resources.pendingOperations.push(async function(e){const t=(await Promise.resolve().then(r.bind(null,0)).then((function(e){return e.d1}))).default,{data:i}=await t(e,{responseType:"blob"});return i}(s).then((e=>{h.path=`${d}.${Object(o.cR)(e)}`,n[a]=h.itemRelativeUrl})).catch((()=>{}))),m(e,t,h,y,c.resources.toAdd),n[a]=h.itemRelativeUrl}function m(e,t,r,i,o){o.push({resource:r,content:i,finish:r=>{!function(e,t,r){"string"==typeof e[t]?e[t]=r.url:e[t].url=r.url}(e,t,r)}})}function v(e,t,r){return"string"==typeof e?{url:t}:new Blob([JSON.stringify(e.toJSON(r))],{type:"application/json"})}let g=i=class extends o.a{constructor(e){super(e),this.geometry=null,this.type="clip"}writeGeometry(e,t,r,i){if(i.layer&&i.layer.spatialReference&&!i.layer.spatialReference.equals(this.geometry.spatialReference)){if(!Object(O.i)(e.spatialReference,i.layer.spatialReference))return void(i&&i.messages&&i.messages.push(new o.aU("scenemodification:unsupported","Scene modifications with incompatible spatial references are not supported",{modification:this,spatialReference:i.layer.spatialReference,context:i})));const s=new o.au;Object(O.h)(e,s,i.layer.spatialReference),t[r]=s.toJSON(i)}else t[r]=e.toJSON(i);delete t[r].spatialReference}clone(){return new i({geometry:Object(s.o)(this.geometry),type:this.type})}};Object(o.e)([Object(o.y)({type:o.au}),f()],g.prototype,"geometry",void 0),Object(o.e)([Object(o.o)(["web-scene","portal-item"],"geometry")],g.prototype,"writeGeometry",null),Object(o.e)([Object(o.y)({type:["clip","mask","replace"],nonNullable:!0}),f()],g.prototype,"type",void 0),g=i=Object(o.e)([Object(o.i)("esri.layers.support.SceneModification")],g);var w,S=g;let R=w=class extends(Object(o.b)(o.L.ofType(S))){constructor(e){super(e),this.url=null}toJSON(e){return this.toArray().map((t=>t.toJSON(e))).filter((e=>!!e.geometry))}clone(){return new w({url:this.url,items:this.items.map((e=>e.clone()))})}_readModifications(e,t){for(const r of e)this.add(S.fromJSON(r,t))}static fromJSON(e,t){const r=new w;return r._readModifications(e,t),r}static async fromUrl(e,t,r){const i={url:Object(o.U)(e),origin:"service"},s=await Object(o.C)(e,{responseType:"json",signal:Object(o.ap)(r,"signal")}),n=t.toJSON(),a=[];for(const e of s.data)a.push(S.fromJSON({...e,geometry:{...e.geometry,spatialReference:n}},i));return new w({url:e,items:a})}};Object(o.e)([Object(o.y)({type:String})],R.prototype,"url",void 0),R=w=Object(o.e)([Object(o.i)("esri.layers.support.SceneModifications")],R);var T=R;let I=class extends(Object(a.a)(Object(d.a)(Object(y.i)(Object(u.a)(Object(h.a)(Object(p.b)(c.a))))))){constructor(...e){super(...e),this.handles=new o.w,this.geometryType="mesh",this.operationalLayerType="IntegratedMeshLayer",this.type="integrated-mesh",this.nodePages=null,this.materialDefinitions=null,this.textureSetDefinitions=null,this.geometryDefinitions=null,this.serviceUpdateTimeStamp=null,this.profile="mesh-pyramids",this.modifications=null,this._modificationsSource=null,this.elevationInfo=null,this.path=null}destroy(){this.handles.destroy()}initialize(){this.handles.add(Object(l.d)(this,"modifications","after-changes",(()=>this.modifications=this.modifications),null,null,!0))}normalizeCtorArgs(e,t){return"string"==typeof e?{url:e,...t}:e}readModifications(e,t,r){this._modificationsSource={url:Object(n.b)(e,r),context:r}}async load(e){return this.addResolvingPromise(this._doLoad(e)),this}async _doLoad(e){const t=Object(o.ap)(e,"signal");try{await this.loadFromPortal({supportedTypes:["Scene Service"]},e)}catch(e){Object(o.bR)(e)}if(await this._fetchService(t),Object(o.P)(this._modificationsSource)){const t=await T.fromUrl(this._modificationsSource.url,this.spatialReference,e);this.setAtOrigin("modifications",t,this._modificationsSource.context.origin),this._modificationsSource=null}await this._fetchIndexAndUpdateExtent(this.nodePages,t)}beforeSave(){if(!Object(o.J)(this._modificationsSource))return this.load().then((()=>{}),(()=>{}))}async saveAs(e,t){return this._debouncedSaveOperations(1,{...t,getTypeKeywords:()=>this._getTypeKeywords(),portalItemLayerType:"integrated-mesh"},e)}async save(){const e={getTypeKeywords:()=>this._getTypeKeywords(),portalItemLayerType:"integrated-mesh"};return this._debouncedSaveOperations(0,e)}validateLayer(e){if(e.layerType&&"IntegratedMesh"!==e.layerType)throw new o.s("integrated-mesh-layer:layer-type-not-supported","IntegratedMeshLayer does not support this layer type",{layerType:e.layerType});if(isNaN(this.version.major)||isNaN(this.version.minor))throw new o.s("layer:service-version-not-supported","Service version is not supported.",{serviceVersion:this.version.versionString,supportedVersions:"1.x"});if(this.version.major>1)throw new o.s("layer:service-version-too-new","Service version is too new.",{serviceVersion:this.version.versionString,supportedVersions:"1.x"})}_getTypeKeywords(){return["IntegratedMeshLayer"]}};Object(o.e)([Object(o.y)({type:String,readOnly:!0})],I.prototype,"geometryType",void 0),Object(o.e)([Object(o.y)({type:["show","hide"]})],I.prototype,"listMode",void 0),Object(o.e)([Object(o.y)({type:["IntegratedMeshLayer"]})],I.prototype,"operationalLayerType",void 0),Object(o.e)([Object(o.y)({json:{read:!1},readOnly:!0})],I.prototype,"type",void 0),Object(o.e)([Object(o.y)({type:b.c,readOnly:!0})],I.prototype,"nodePages",void 0),Object(o.e)([Object(o.y)({type:[b.a],readOnly:!0})],I.prototype,"materialDefinitions",void 0),Object(o.e)([Object(o.y)({type:[b.d],readOnly:!0})],I.prototype,"textureSetDefinitions",void 0),Object(o.e)([Object(o.y)({type:[b.b],readOnly:!0})],I.prototype,"geometryDefinitions",void 0),Object(o.e)([Object(o.y)({readOnly:!0})],I.prototype,"serviceUpdateTimeStamp",void 0),Object(o.e)([Object(o.y)({type:T}),f({origins:["web-scene","portal-item"],type:"resource",prefix:"modifications"})],I.prototype,"modifications",void 0),Object(o.e)([Object(o.a1)(["web-scene","portal-item"],"modifications")],I.prototype,"readModifications",null),Object(o.e)([Object(o.y)(y.j)],I.prototype,"elevationInfo",void 0),Object(o.e)([Object(o.y)({type:String,json:{origins:{"web-scene":{read:!0,write:!0},"portal-item":{read:!0,write:!0}},read:!1}})],I.prototype,"path",void 0),I=Object(o.e)([Object(o.i)("esri.layers.IntegratedMeshLayer")],I);var P=I;t.default=P}}]);