(window.webpackJsonp=window.webpackJsonp||[]).push([[167],{517:function(e,t,n){"use strict";n.r(t),n.d(t,"createLabelFunction",(function(){return c})),n.d(t,"formatField",(function(){return p}));n(25);var r=n(0),a=n(6),u=n(104),i=n(42);n(1);const l=r.n.getLogger("esri.layers.support.labelFormatUtils"),s={type:"simple",evaluate:()=>null},o={getAttribute:(e,t)=>e.field(t)};async function c(e,t,c){if(!e||!e.symbol)return s;const d=e.where,f=Object(i.f)(e),b=d?await n.e(0).then(n.bind(null,221)):null;let y;if("arcade"===f.type){const e=await Object(a.B)(f.expression,c,t);y={type:"arcade",evaluate(t){try{const n=e.evaluate({$feature:"attributes"in t?e.repurposeFeature(t):e.repurposeAdapter(t)});if(null!=n)return n.toString()}catch(e){l.error(new r.s("bad-arcade-expression","Encountered an error when evaluating label expression for feature",{feature:t,expression:f}))}return null},needsHydrationToEvaluate:()=>null==Object(i.a)(f.expression)}}else y={type:"simple",evaluate:e=>f.expression.replace(/{[^}]*}/g,(n=>{const r=n.slice(1,-1),u=Object(a.g)(t,r);if(!u)return n;let i=null;return"attributes"in e?e&&e.attributes&&(i=e.attributes[u.name]):i=e.field(u.name),null==i?"":p(i,u)}))};if(d){let e;try{e=b.WhereClause.create(d,new u.a(t))}catch(e){return s}const n=y.evaluate;y.evaluate=t=>{const r="attributes"in t?void 0:o;return e.testFeature(t,r)?n(t):null}}return y}function p(e,t){if(null==e)return"";const n=t.domain;if(n)if("codedValue"===n.type||"coded-value"===n.type){const t=e;for(const e of n.codedValues)if(e.code===t)return e.name}else if("range"===n.type){const t=+e,r="range"in n?n.range[0]:n.minValue,a="range"in n?n.range[1]:n.maxValue;if(r<=t&&t<=a)return n.name}let u=e;return"date"===t.type||"esriFieldTypeDate"===t.type?u=Object(r.K)(u,Object(r.O)("short-date")):Object(a.j)(t)&&(u=Object(r.H)(+u)),u||""}}}]);