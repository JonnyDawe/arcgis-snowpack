(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{294:function(t,e,n){"use strict";n.r(e),n.d(e,"work",(function(){return K})),n.d(e,"wrappedWork",(function(){return $}));n(163),n(88),n(139),n(140);var o=n(0),r=n(378),i=n(31),c=n(8),s=n(1),a=n(123);n(7),n(354);function l(t,e,n,o){for(let r=0;r<o;r++)if(t[e+r]!==t[n+r])return!1;return!0}function f(t,e,n,o,r){for(let i=0;i<r;i++)n[o+i]=t[e+i]}function u(t,e,n){let o=0;for(let r=0;r<n;r++)o=t[e+r]+o|0,o=o+(o<<11)+(o>>>2)|0;return o>>>0}let d=null;const g={divisor:0};function p(t,e={}){e={...g,...e};const n=t.stride;return t.fieldNames.filter((e=>{const n=t.fields.get(e).optional;return!(n&&n.glPadding)})).map((o=>{const r=t.fields.get(o),i=r.constructor.ElementCount,c=h(r.constructor.ElementType),s=r.offset,a=!(!r.optional||!r.optional.glNormalized);return{name:o,stride:n,count:i,type:c,offset:s,normalized:a,divisor:e.divisor}}))}function h(t){const e=m[t];if(e)return e;throw new Error("BufferType not supported in WebGL")}const m={u8:5121,u16:5123,u32:5125,i8:5120,i16:5122,i32:5124,f32:5126},b=Object(r.a)().vec3f("position").u16("componentIndex").u16("u16padding");p(Object(r.a)().vec2u8("sideness"));const w=Object(r.a)().vec3f("position0").vec3f("position1").u16("componentIndex").u8("variantOffset",{glNormalized:!0}).u8("variantStroke").u8("variantExtension",{glNormalized:!0}).u8("u8padding",{glPadding:!0}).u16("u16padding",{glPadding:!0}),v=w.clone().vec3f("normal"),y=w.clone().vec3f("normalA").vec3f("normalB");class O{updateSettings(t){this.settings=t,this.edgeHashFunction=t.reducedPrecision?N:L}write(t,e,n){const o=this.edgeHashFunction(n);k.seed=o;const r=k.getIntRange(0,255),i=k.getIntRange(0,this.settings.variants-1),c=k.getFloat(),s=255*(.5*function(t,e){const n=t<0?-1:1;return Math.abs(t)**e*n}(-(1-Math.min(c/.7,1))+Math.max(0,c-.7)/(1-.7),1.2)+.5);t.position0.setVec(e,n.position0),t.position1.setVec(e,n.position1),t.componentIndex.set(e,n.componentIndex),t.variantOffset.set(e,r),t.variantStroke.set(e,i),t.variantExtension.set(e,s)}trim(t,e){return t.slice(0,e)}}const j=new Float32Array(6),A=new Uint32Array(j.buffer),I=new Uint32Array(1);function L(t){const e=j;e[0]=t.position0[0],e[1]=t.position0[1],e[2]=t.position0[2],e[3]=t.position1[0],e[4]=t.position1[1],e[5]=t.position1[2],I[0]=5381;for(let t=0;t<A.length;t++)I[0]=31*I[0]+A[t];return I[0]}function N(t){const e=j;e[0]=E(t.position0[0]),e[1]=E(t.position0[1]),e[2]=E(t.position0[2]),e[3]=E(t.position1[0]),e[4]=E(t.position1[1]),e[5]=E(t.position1[2]),I[0]=5381;for(let t=0;t<A.length;t++)I[0]=31*I[0]+A[t];return I[0]}function E(t){return Math.round(1e4*t)/1e4}class S{constructor(){this.commonWriter=new O}updateSettings(t){this.commonWriter.updateSettings(t)}allocate(t){return v.createBuffer(t)}write(t,e,n){this.commonWriter.write(t,e,n),Object(c.t)(V,n.faceNormal0,n.faceNormal1),Object(c.m)(V,V),t.normal.setVec(e,V)}trim(t,e){return this.commonWriter.trim(t,e)}}S.Layout=v,S.glLayout=p(v,{divisor:1});class U{constructor(){this.commonWriter=new O}updateSettings(t){this.commonWriter.updateSettings(t)}allocate(t){return y.createBuffer(t)}write(t,e,n){this.commonWriter.write(t,e,n),t.normalA.setVec(e,n.faceNormal0),t.normalB.setVec(e,n.faceNormal1)}trim(t,e){return this.commonWriter.trim(t,e)}}U.Layout=y,U.glLayout=p(y,{divisor:1});const V=Object(i.d)(),k=new o.cq;function x(t,e){return e.push(t.buffer),{buffer:t.buffer,layout:M(t.layout)}}function M(t){const e=new Array;return t.fields.forEach(((t,n)=>{const o={...t,constructor:W(t.constructor)};e.push([n,o])})),{stride:t.stride,fields:e,fieldNames:t.fieldNames}}const B=[r.v,r.K,r.q,r.F,r.s,r.E,r.y,r.C,r.n,r.t,r.r,r.B,r.x,r.u,r.l,r.N,r.w,r.M,r.e,r.j,r.f,r.i,r.o,r.z,r.p,r.k,r.m,r.A,r.G,r.L,r.O,r.b,r.c,r.d,r.g,r.h];function W(t){return`${t.ElementType}_${t.ElementCount}`}const D=new Map;function F(t,e,n){const o=e/3,r=new Uint32Array(n+1),i=new Uint32Array(n+1),c=(t,e)=>{t<e?r[t+1]++:i[e+1]++};for(let e=0;e<o;e++){const n=t[3*e],o=t[3*e+1],r=t[3*e+2];c(n,o),c(o,r),c(r,n)}let s=0,a=0;for(let t=0;t<n;t++){const e=r[t+1],n=i[t+1];r[t+1]=s,i[t+1]=a,s+=e,a+=n}const l=new Uint32Array(6*o),f=r[n],u=(t,e,n)=>{if(t<e){const o=r[t+1]++;l[2*o]=e,l[2*o+1]=n}else{const o=i[e+1]++;l[2*f+2*o]=t,l[2*f+2*o+1]=n}};for(let e=0;e<o;e++){const n=t[3*e],o=t[3*e+1],r=t[3*e+2];u(n,o,e),u(o,r,e),u(r,n,e)}const d=(t,e)=>{const n=2*t,o=e-t;for(let t=1;t<o;t++){const e=l[n+2*t],o=l[n+2*t+1];let r=t-1;for(;r>=0&&l[n+2*r]>e;r--)l[n+2*r+2]=l[n+2*r],l[n+2*r+3]=l[n+2*r+1];l[n+2*r+2]=e,l[n+2*r+3]=o}};for(let t=0;t<n;t++)d(r[t],r[t+1]),d(f+i[t],f+i[t+1]);const g=new Int32Array(3*o),p=(e,n)=>e===t[3*n]?0:e===t[3*n+1]?1:e===t[3*n+2]?2:-1,h=(t,e)=>{const n=p(t,e);g[3*e+n]=-1},m=(t,e,n,o)=>{const r=p(t,e);g[3*e+r]=o;const i=p(n,o);g[3*o+i]=e};for(let t=0;t<n;t++){let e=r[t];const n=r[t+1];let o=i[t];const c=i[t+1];for(;e<n&&o<c;){const n=l[2*e],r=l[2*f+2*o];n===r?(m(t,l[2*e+1],r,l[2*f+2*o+1]),e++,o++):n<r?(h(t,l[2*e+1]),e++):(h(r,l[2*f+2*o+1]),o++)}for(;e<n;)h(t,l[2*e+1]),e++;for(;o<c;)h(l[2*f+2*o],l[2*f+2*o+1]),o++}return g}B.forEach((t=>D.set(W(t),t)));const q=-1;function C(t,e,n,r=J){const i=t.vertices.position,a=t.vertices.componentIndex,l=Object(o.bq)(r.anglePlanar),f=Object(o.bq)(r.angleSignificantEdge),u=Math.cos(f),d=Math.cos(l),g=G.edge,p=g.position0,h=g.position1,m=g.faceNormal0,b=g.faceNormal1,w=R(t),v=function(t){const e=t.faces.length/3,n=t.faces,o=t.neighbors;let r=0;for(let t=0;t<e;t++){const e=o[3*t+0],i=o[3*t+1],c=o[3*t+2],s=n[3*t+0],a=n[3*t+1],l=n[3*t+2];r+=e===q||s<a?1:0,r+=i===q||a<l?1:0,r+=c===q||l<s?1:0}const i=new Int32Array(4*r);let c=0;for(let t=0;t<e;t++){const e=o[3*t+0],r=o[3*t+1],s=o[3*t+2],a=n[3*t+0],l=n[3*t+1],f=n[3*t+2];(e===q||a<l)&&(i[c++]=a,i[c++]=l,i[c++]=t,i[c++]=e),(r===q||l<f)&&(i[c++]=l,i[c++]=f,i[c++]=t,i[c++]=r),(s===q||f<a)&&(i[c++]=f,i[c++]=a,i[c++]=t,i[c++]=s)}return i}(t),y=v.length/4,O=e.allocate(y);let j=0;const A=y,I=n.allocate(A);let L=0,N=0,E=0;const S=Object(o.cB)(0,y),U=new Float32Array(y);Object(s.b)(U,((t,e,n)=>{i.getVec(v[4*e+0],p),i.getVec(v[4*e+1],h),n[e]=Object(c.p)(p,h)})),S.sort(((t,e)=>U[e]-U[t]));const V=new Array,k=new Array;for(let t=0;t<y;t++){const o=S[t],r=U[o],s=v[4*o+0],f=v[4*o+1],y=v[4*o+2],A=v[4*o+3],x=A===q;if(i.getVec(s,p),i.getVec(f,h),x)Object(c.n)(m,w[3*y+0],w[3*y+1],w[3*y+2]),Object(c.i)(b,m),g.componentIndex=a.get(s),g.cosAngle=Object(c.w)(m,b);else{if(Object(c.n)(m,w[3*y+0],w[3*y+1],w[3*y+2]),Object(c.n)(b,w[3*A+0],w[3*A+1],w[3*A+2]),g.componentIndex=a.get(s),g.cosAngle=Object(c.w)(m,b),z(g,d))continue;g.cosAngle<-.9999&&Object(c.i)(b,m)}N+=r,E++,x||P(g,u)?(e.write(O,j++,g),V.push(r)):T(g,l)&&(n.write(I,L++,g),k.push(r))}const x=new Float32Array(V.reverse()),M=new Float32Array(k.reverse());return{regular:{instancesData:e.trim(O,j),lodInfo:{lengths:x}},silhouette:{instancesData:n.trim(I,L),lodInfo:{lengths:M}},averageEdgeLength:N/E}}function P(t,e){return t.cosAngle<e}function z(t,e){return t.cosAngle>e}function T(t,e){const n=Object(o.cC)(t.cosAngle),r=G.fwd,i=G.ortho;return Object(a.c)(r,t.position1,t.position0),n*(Object(c.w)(Object(c.f)(i,t.faceNormal0,t.faceNormal1),r)>0?-1:1)>e}function R(t){const e=t.faces.length/3,n=t.vertices.position,o=t.faces,r=H.v0,i=H.v1,s=H.v2,a=new Float32Array(3*e);for(let t=0;t<e;t++){const e=o[3*t+0],l=o[3*t+1],f=o[3*t+2];n.getVec(e,r),n.getVec(l,i),n.getVec(f,s),Object(c.k)(i,i,r),Object(c.k)(s,s,r),Object(c.f)(r,i,s),Object(c.m)(r,r),a[3*t+0]=r[0],a[3*t+1]=r[1],a[3*t+2]=r[2]}return a}const G={edge:{position0:Object(i.d)(),position1:Object(i.d)(),faceNormal0:Object(i.d)(),faceNormal1:Object(i.d)(),componentIndex:0,cosAngle:0},ortho:Object(i.d)(),fwd:Object(i.d)()},H={v0:Object(i.d)(),v1:Object(i.d)(),v2:Object(i.d)()},J={anglePlanar:4,angleSignificantEdge:35};async function $(t){const e=_(t),n=K(e),o=[e.data.buffer];return{result:Q(n,o),transferList:o}}function K(t){const e=X(t.data,t.skipDeduplicate,t.indices,t.indicesLength);return Y.updateSettings(t.writerSettings),Z.updateSettings(t.writerSettings),C(e,Y,Z)}function _(t){return{data:b.createView(t.dataBuffer),indices:"Uint32Array"===t.indicesType?new Uint32Array(t.indicesBuffer):"Uint16Array"===t.indicesType?new Uint16Array(t.indicesBuffer):void 0,indicesLength:t.indicesLength,writerSettings:t.writerSettings,skipDeduplicate:t.skipDeduplicate}}function Q(t,e){return e.push(t.regular.lodInfo.lengths.buffer),e.push(t.silhouette.lodInfo.lengths.buffer),{regular:{instancesData:x(t.regular.instancesData,e),lodInfo:{lengths:t.regular.lodInfo.lengths.buffer}},silhouette:{instancesData:x(t.silhouette.instancesData,e),lodInfo:{lengths:t.silhouette.lodInfo.lengths.buffer}},averageEdgeLength:t.averageEdgeLength}}function X(t,e,n,r){if(e)return{faces:n,facesLength:r,neighbors:F(n,r,t.count),vertices:t};const i=function(t,e,n){var r;const i=t.byteLength/(4*e),c=new Uint32Array(t,0,i*e);let s=new Uint32Array(i);const a=null!=(r=null==n?void 0:n.minReduction)?r:0,g=(null==n?void 0:n.originalIndices)||null,p=g?g.length:0,h=(null==n?void 0:n.componentOffsets)||null;let m=0;if(h)for(let t=0;t<h.length-1;t++){const e=h[t+1]-h[t];e>m&&(m=e)}else m=i;const b=Math.floor(1.1*m)+1;(null==d||d.length<2*b)&&(d=new Uint32Array(Object(o.cl)(2*b)));for(let t=0;t<2*b;t++)d[t]=0;let w=0;const v=!!h&&!!g,y=v?p:i,O=v?new Uint32Array(p):null,j=1.96;let A=0!==a?Math.ceil(4*j*j/(a*a)*a*(1-a)):y,I=1,L=h?h[1]:y;for(let t=0;t<y;t++){if(t===A){const e=1-w/t;if(e+j*Math.sqrt(e*(1-e)/t)<a)return null;A*=2}if(t===L){for(let t=0;t<2*b;t++)d[t]=0;if(g)for(let t=h[I-1];t<h[I];t++)O[t]=s[g[t]];L=h[++I]}const n=v?g[t]:t,o=n*e,r=u(c,o,e);let i=r%b,f=w;for(;0!==d[2*i+1];){if(d[2*i]===r){const t=d[2*i+1]-1;if(l(c,o,t*e,e)){f=s[t];break}}i++,i>=b&&(i-=b)}f===w&&(d[2*i]=r,d[2*i+1]=n+1,w++),s[n]=f}if(0!==a&&1-w/i<a)return null;if(v){for(let t=h[I-1];t<O.length;t++)O[t]=s[g[t]];s=O}const N=new Uint32Array(e*w);w=0;for(let t=0;t<y;t++)s[t]===w&&(f(c,(v?g[t]:t)*e,N,w*e,e),w++);if(g&&!v){const t=new Uint32Array(p);for(let e=0;e<t.length;e++)t[e]=s[g[e]];s=t}return{buffer:N.buffer,indices:s,uniqueCount:w}}(t.buffer,t.stride/4,{originalIndices:n,originalIndicesLength:r}),c=F(i.indices,r,i.uniqueCount);return{faces:i.indices,facesLength:i.indices.length,neighbors:c,vertices:b.createView(i.buffer)}}const Y=new S,Z=new U}}]);