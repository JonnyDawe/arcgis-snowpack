import { aM as t, e, y, a1 as e$1, o, a3 as i, A as k, i as i$1, a, P as r, Y as e$2 } from './Identifiable-c8406192.js';
import './config-b3bf08ce.js';
import { p, y as y$2 } from './jsonUtils-d762dc00.js';
import { n } from './Graphic-9f79c7db.js';
import { y as y$1 } from './Field-e6fe6b12.js';
import './PopupTemplate-77ad81c4.js';
import './fieldUtils-a9f71c96.js';
import './symbols-a702d148.js';
import './persistableUrlUtils-b4be11a9.js';
import './uid-7967dd4d.js';
import './fieldType-769fe7ff.js';

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const h=new t({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh","":null});let d=class extends a{constructor(e){super(e),this.displayFieldName=null,this.exceededTransferLimit=!1,this.features=[],this.fields=null,this.geometryType=null,this.hasM=!1,this.hasZ=!1,this.queryGeometry=null,this.spatialReference=null;}readFeatures(e,r$1){const o=k.fromJSON(r$1.spatialReference),s=[];for(let i=0;i<e.length;i++){const r$1=e[i],n$1=n.fromJSON(r$1),p=r$1.geometry&&r$1.geometry.spatialReference;r(n$1.geometry)&&!p&&(n$1.geometry.spatialReference=o),s.push(n$1);}return s}writeGeometryType(e,r$1,o,s){if(e)return void h.write(e,r$1,o,s);const{features:i}=this;if(i)for(const n of i)if(n&&r(n.geometry))return void h.write(n.geometry.type,r$1,o,s)}readQueryGeometry(e,t){if(!e)return null;const r=!!e.spatialReference,o=p(e);return !r&&t.spatialReference&&(o.spatialReference=k.fromJSON(t.spatialReference)),o}writeSpatialReference(e,r$1){if(e)return void(r$1.spatialReference=e.toJSON());const{features:o}=this;if(o)for(const s of o)if(s&&r(s.geometry)&&s.geometry.spatialReference)return void(r$1.spatialReference=s.geometry.spatialReference.toJSON())}toJSON(e){const t=this.write(null);if(t.features&&Array.isArray(e)&&e.length>0)for(let r=0;r<t.features.length;r++){const o=t.features[r];if(o.geometry){const t=e&&e[r];o.geometry=t&&t.toJSON()||o.geometry;}}return t}quantize(e){const{scale:[t,o],translate:[s,i]}=e,n=e=>Math.round((e-s)/t),p=e=>Math.round((i-e)/o),l=this.features,a=this._getQuantizationFunction(this.geometryType,n,p);for(let y=0,u=l.length;y<u;y++)a(e$2(l[y].geometry))||(l.splice(y,1),y--,u--);return this.transform=e,this}unquantize(){const{geometryType:e,features:r$1,transform:o}=this;if(!o)return this;const{translate:[s,i],scale:[n,p]}=o,l=e=>e*n+s,a=e=>i-e*p,y=this._getHydrationFunction(e,l,a);for(const{geometry:u}of r$1)r(u)&&y(u);return this.transform=null,this}_quantizePoints(e,t,r){let o,s;const i=[];for(let n=0,p=e.length;n<p;n++){const p=e[n];if(n>0){const e=t(p[0]),n=r(p[1]);e===o&&n===s||(i.push([e-o,n-s]),o=e,s=n);}else o=t(p[0]),s=r(p[1]),i.push([o,s]);}return i.length>0?i:null}_getQuantizationFunction(e,t,r){return "point"===e?e=>(e.x=t(e.x),e.y=r(e.y),e):"polyline"===e||"polygon"===e?e=>{const o=y$2(e)?e.rings:e.paths,s=[];for(let i=0,n=o.length;i<n;i++){const e=o[i],n=this._quantizePoints(e,t,r);n&&s.push(n);}return s.length>0?(y$2(e)?e.rings=s:e.paths=s,e):null}:"multipoint"===e?e=>{const o=this._quantizePoints(e.points,t,r);return o.length>0?(e.points=o,e):null}:"extent"===e?e=>e:null}_getHydrationFunction(e,t,r){return "point"===e?e=>{e.x=t(e.x),e.y=r(e.y);}:"polyline"===e||"polygon"===e?e=>{const o=y$2(e)?e.rings:e.paths;let s,i;for(let n=0,p=o.length;n<p;n++){const e=o[n];for(let o=0,n=e.length;o<n;o++){const n=e[o];o>0?(s+=n[0],i+=n[1]):(s=n[0],i=n[1]),n[0]=t(s),n[1]=r(i);}}}:"extent"===e?e=>{e.xmin=t(e.xmin),e.ymin=r(e.ymin),e.xmax=t(e.xmax),e.ymax=r(e.ymax);}:"multipoint"===e?e=>{const o=e.points;let s,i;for(let n=0,p=o.length;n<p;n++){const e=o[n];n>0?(s+=e[0],i+=e[1]):(s=e[0],i=e[1]),e[0]=t(s),e[1]=r(i);}}:void 0}};e([y({type:String,json:{write:!0}})],d.prototype,"displayFieldName",void 0),e([y({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],d.prototype,"exceededTransferLimit",void 0),e([y({type:[n],json:{write:!0}})],d.prototype,"features",void 0),e([e$1("features")],d.prototype,"readFeatures",null),e([y({type:[y$1],json:{write:!0}})],d.prototype,"fields",void 0),e([y({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:h.read}}})],d.prototype,"geometryType",void 0),e([o("geometryType")],d.prototype,"writeGeometryType",null),e([y({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],d.prototype,"hasM",void 0),e([y({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],d.prototype,"hasZ",void 0),e([y({types:i,json:{write:!0}})],d.prototype,"queryGeometry",void 0),e([e$1("queryGeometry")],d.prototype,"readQueryGeometry",null),e([y({type:k,json:{write:!0}})],d.prototype,"spatialReference",void 0),e([o("spatialReference")],d.prototype,"writeSpatialReference",null),e([y({json:{write:!0}})],d.prototype,"transform",void 0),d=e([i$1("esri.tasks.support.FeatureSet")],d),d.prototype.toJSON.isDefaultToJSON=!0,d||(d={});var g=d;

export default g;
