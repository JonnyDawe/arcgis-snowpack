import { x as x$2, bO as m$6, P as r$1, j as o$3, z as r$2, e as e$2, y as y$7, i as i$4, a as a$8, n as n$8, s as s$3, J as t$2, M, au as x$3, W as s$4, K as L$1, _ as j$2, A as k$2, l as d$6, Y as e$3, C as U$1, a1 as e$5, o as o$4, Z as d$7, aT as w$4, L as L$2, m as n$c, u as u$8, w as u$9, Q as a$a, b3 as f$4, E as E$1, X as C$2, V as a$b, ap as g$3, b4 as c$9, bP as o$7, T as i$5 } from '../../../common/Identifiable-c8406192.js';
import { y as y$6, a as t$3, s as s$5 } from '../../../common/config-b3bf08ce.js';
import { M as M$1, o as o$6 } from '../../../common/PopupTemplate-77ad81c4.js';
import { C as C$1, d as d$8, $ as $$2, j as j$3, h as h$3 } from '../../../common/watchUtils-880dbce7.js';
import { e as e$8, L as L$3, o as o$5, p as p$8, c as L$4 } from '../../../common/Widget-2f53b352.js';
import { e as e$6, a as e$7, n as n$e, t as t$4 } from '../../../common/GoTo-21ecf3ed.js';
import { t as u$7, o as o$2, c as c$7, k as n$d, m as y$8, y as y$9, f as d$9, u as u$a } from '../../../common/symbols-a702d148.js';
import { n as n$9 } from '../../../common/Graphic-9f79c7db.js';
import { c as c$8 } from '../../../common/scaleUtils-be2fff7f.js';
import { G } from '../../../common/unitUtils-1b0a3531.js';
import { r as r$3, n as n$a, e as e$4, p as p$7 } from '../../../common/Task-21d7c7ba.js';
import { a as a$9 } from '../../../common/ProjectParameters-8b435286.js';
import { n as n$b } from '../../../common/TrimExtendParameters-1321bbb7.js';
import '../../../common/fieldUtils-a9f71c96.js';
import '../../../common/persistableUrlUtils-b4be11a9.js';
import '../../../common/jsonUtils-d762dc00.js';
import '../../../common/uid-7967dd4d.js';

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const r={light:["streets","gray","topo","terrain","national-geographic","oceans","osm","gray-vector","streets-vector","topo-vector","streets-relief-vector","streets-navigation-vector"],dark:["satellite","hybrid","dark-gray","dark-gray-vector","streets-night-vector"]};function m$5(e,t=r){for(const n in t)if(t[n].indexOf(e)>-1)return n}function y$5(e,r,o=!0){let i=null;return "string"==typeof e&&r.indexOf(e)>-1?i=e:e instanceof x$2&&(i=m$6(e)),o?i||"gray":i}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
function m$4(s,t,m){let o=null,i=null;if(t&&(o=y$5(t,s,!1),o)){const s=m$5(o);r$1(s)&&(i=s);}return !o&&m&&(o="dark"===m?"dark-gray":"gray",i=m),o||i||(o="gray",i="light"),{basemapId:o,basemapTheme:i}}class o$1{constructor(s){this.name=null,this.label=null,this.description=null,this.supportedBasemaps=null,this.basemapGroups=null,this.schemes=null;const{name:e,label:a,description:p,schemes:m}=s;this.name=e,this.label=a,this.description=p,this.schemes=m;const o=s.basemapGroups||r;let i=[];if(o)for(const t in o)i=i.concat(o[t]);this.supportedBasemaps=i,this.basemapGroups=o;}isBasemapSupported(s){const e=y$5(s,this.supportedBasemaps);return !!(e&&this.supportedBasemaps.indexOf(e)>-1)}getRawSchemes(t){const{basemapId:a,basemapTheme:o}=m$4(this.supportedBasemaps,t.basemap,t.basemapTheme);let i=o;if(a){const s=m$5(a,this.basemapGroups);r$1(s)&&(i=s);}let r=t.geometryType;"multipoint"===r?r="point":"mesh"===r&&(r="polygon");const n=this.schemes[r]||this.schemes.default;return {schemesInfo:y$6(n[i]),basemapId:a,basemapTheme:o}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
function n$7(n){const t=n.themeDictionary,r=new Map;for(const o in t){const n=t[o];r.set(o,new o$1(n));}return r}function t$1(e,n){const t=[];return e.forEach((e=>{e.isBasemapSupported(n)&&t.push({name:e.name,label:e.label,description:e.description,basemaps:[...e.supportedBasemaps]});})),t}function s$2(e){const n=e.theme;if(n)return n.getRawSchemes({basemap:e.basemap,geometryType:e.geometryType,basemapTheme:e.basemapTheme})}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
function l$6(t){const r=t.width,o=t.height;let n=t.pixelSizeAt(t.toMap(c$7(.5*r,.5*o),{exclude:[]}));if(n<=0&&(n=t.pixelSizeAt(t.toMap(c$7(.5*r,.95*o),{exclude:[]})),n<=0)){const e=t.camera.position.clone();e.z=0,n=2*t.pixelSizeAt(e);}return n}function u$6(e,o){return Math.ceil(l$6(o)*u$7(o$2(e)))}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const l$5=n$7({themeDictionary:{default:{name:"default",label:"Default",description:"Default theme for basic visualization of features.",schemes:{point:{light:{primary:{color:[77,77,77,1],outline:{color:[255,255,255,.25],width:"1px"},size:"8px"},secondary:[{color:[226,119,40,1],outline:{color:[255,255,255,.25],width:"1px"},size:"8px"},{color:[255,255,255,1],outline:{color:[51,51,51,.25],width:"1px"},size:"8px"}]},dark:{primary:{color:[255,255,255,1],outline:{color:[92,92,92,.25],width:"1px"},size:"8px"},secondary:[{color:[226,119,40,1],outline:{color:[255,255,255,.25],width:"1px"},size:"8px"},{color:[26,26,26,1],outline:{color:[178,178,178,.25],width:"1px"},size:"8px"}]}},polyline:{light:{primary:{color:[77,77,77,1],width:"2px"},secondary:[{color:[226,119,40,1],width:"2px"},{color:[255,255,255,1],width:"2px"}]},dark:{primary:{color:[255,255,255,1],width:"2px"},secondary:[{color:[226,119,40,1],width:"2px"},{color:[26,26,26,1],width:"2px"}]}},polygon:{light:{primary:{size:"12px",color:[227,139,79,1],outline:{color:[255,255,255,.25],width:"1px"},opacity:.8},secondary:[{size:"12px",color:[128,128,128,1],outline:{color:[255,255,255,.25],width:"1px"},opacity:.8},{size:"12px",color:[255,255,255,1],outline:{color:[128,128,128,.25],width:"1px"},opacity:.8}]},dark:{primary:{size:"12px",color:[227,139,79,1],outline:{color:[92,92,92,.25],width:"1px"},opacity:.8},secondary:[{size:"12px",color:[178,178,178,1],outline:{color:[92,92,92,.25],width:"1px"},opacity:.8},{size:"12px",color:[26,26,26,1],outline:{color:[128,128,128,.25],width:"1px"},opacity:.8}]}}}}}});function c$6(o){return t$1(l$5,o)}function n$6(o){const e="default",t=s$2({basemap:o.basemap,geometryType:o.geometryType,basemapTheme:o.basemapTheme,theme:l$5.get(e)});if(!t)return;const{schemesInfo:r,basemapId:c,basemapTheme:n}=t;return {primaryScheme:s$1(o,r.primary),secondarySchemes:r.secondary.map((e=>s$1(o,e))).filter(Boolean),basemapId:c,basemapTheme:n}}function p$6(e){if(!e)return;const t={...e};return t.color&&(t.color=new o$3(t.color)),"outline"in t&&t.outline&&(t.outline={color:t.outline.color&&new o$3(t.outline.color),width:t.outline.width}),t}function s$1(o,e){const t="mesh"!==o.geometryType&&o.worldScale?o.view:null;switch(o.geometryType){case"point":case"multipoint":{const o=e;return a$7({color:o.color,outline:{...o.outline},size:o.size},t)}case"polyline":{const o=e;return u$5({color:o.color,width:o.width},t)}case"polygon":{const o=e;return y$4({size:o.size,color:o.color,outline:{...o.outline},opacity:o.opacity},t)}case"mesh":{const o=e;return m$3({color:o.color,opacity:o.opacity})}}}function a$7(e,t){return {color:new o$3(e.color),outline:{color:new o$3(e.outline.color),width:e.outline.width},size:t?u$6(e.size,t):e.size,opacity:1}}function u$5(e,t){return {color:new o$3(e.color),width:t?u$6(e.width,t):e.width,opacity:1}}function y$4(e,t){return {color:new o$3(e.color),outline:{color:new o$3(e.outline.color),width:e.outline.width},size:t?u$6(e.size,t):e.size,opacity:e.opacity}}function m$3(e){return {color:new o$3(e.color),opacity:e.opacity}}Object.freeze({__proto__:null,getThemes:c$6,getSchemes:n$6,cloneScheme:p$6});

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
let p$5=class extends(r$2(a$8)){constructor(o){super(o),this.autoNavigate=null,this.filter=null,this.getResults=null,this.getSuggestions=null,this.maxResults=null,this.maxSuggestions=null,this.minSuggestCharacters=null,this.outFields=null,this.placeholder="",this.popupEnabled=null,this.popupTemplate=null,this.prefix="",this.resultGraphicEnabled=null,this.resultSymbol=null,this.suggestionsEnabled=null,this.suffix="",this.withinViewEnabled=!1,this.zoomScale=null;}};e$2([y$7()],p$5.prototype,"autoNavigate",void 0),e$2([y$7()],p$5.prototype,"filter",void 0),e$2([y$7()],p$5.prototype,"getResults",void 0),e$2([y$7()],p$5.prototype,"getSuggestions",void 0),e$2([y$7()],p$5.prototype,"maxResults",void 0),e$2([y$7()],p$5.prototype,"maxSuggestions",void 0),e$2([y$7()],p$5.prototype,"minSuggestCharacters",void 0),e$2([y$7()],p$5.prototype,"outFields",void 0),e$2([y$7()],p$5.prototype,"placeholder",void 0),e$2([y$7()],p$5.prototype,"popupEnabled",void 0),e$2([y$7()],p$5.prototype,"popupTemplate",void 0),e$2([y$7()],p$5.prototype,"prefix",void 0),e$2([y$7()],p$5.prototype,"resultGraphicEnabled",void 0),e$2([y$7()],p$5.prototype,"resultSymbol",void 0),e$2([y$7()],p$5.prototype,"suggestionsEnabled",void 0),e$2([y$7()],p$5.prototype,"suffix",void 0),e$2([y$7()],p$5.prototype,"withinViewEnabled",void 0),e$2([y$7()],p$5.prototype,"zoomScale",void 0),p$5=e$2([i$4("esri.widgets.Search.SearchSource")],p$5);var i$3=p$5;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const o=n$8.getLogger("esri.widgets.Search.support.geometryUtils");function s(e,r){var n,i;if(!r)return o.error("missing-parameter: view is missing."),Promise.reject(new s$3("searchgeometryutils:missing-parameter","view is missing."));if(!e)return o.error("missing-parameter: point is missing."),Promise.reject(new s$3("searchgeometryutils:missing-parameter","point is missing."));if(e.hasZ||"2d"===r.type)return Promise.resolve(e);const s=null==r||null==(n=r.map)?void 0:n.ground;return s&&s.layers.length?s.queryElevation(e,{cache:null==(i=r.basemapTerrain)?void 0:i.elevationQueryCache}).then((e=>e.geometry)):Promise.resolve(e)}function m$2(r){if(t$2(r))return null;switch(r.type){case"point":return r;case"extent":return r.center;case"polygon":return r.centroid;case"multipoint":return r.getPoint(0);case"polyline":return r.getPoint(0,0)}return null}function a$6(r,t,n){return t$2(r)?null:"extent"===r.type?r:"multipoint"===r.type||"polygon"===r.type||"polyline"===r.type?r.extent:"point"===r.type?l$4(r,t,n):void 0}function p$4(r,t,n){return t$2(r)||t$2(t)?null:l$4(r.center,t,n)}function l$4(e,r,t){const o=e.hasZ?e.z:void 0;if(r&&r.map){return (t?c$8(r,t):r.extent).clone().centerAt(e).set({zmax:o,zmin:o})}return new M({xmin:e.x-.25,ymin:e.y-.25,xmax:e.x+.25,ymax:e.y+.25,spatialReference:e.spatialReference,zmin:o,zmax:o})}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const d$5=/https?:\/\/services.*\.arcgis\.com/i,c$5=/(?:\{([^}]+)\})/g,f$3=n$8.getLogger("esri.widgets.Search.support.layerSearchUtils");function g$2(e,t){const{exactMatch:i=!1,location:n,maxResults:o,spatialReference:l,source:u,sourceIndex:a,suggestResult:d,view:c}=e,{layer:g,filter:m,zoomScale:F}=u,b=c&&c.scale,j=p$3(u,c),R=t&&t.signal;return h$2(g).then((()=>{const e=g.popupTemplate;return e?e.getRequiredFields(g.fields):null})).then((e=>{var t,p;const{objectIdField:h,returnZ:S}=g,L=w$3(u);if(!$$1(g,L))throw f$3.error("invalid-field: displayField is invalid."),new s$3("getResults():invalid-field","displayField is invalid.");const D=e&&e.length?e:[L],E=u.outFields||D,O=y$3(E);-1!==E.indexOf(h)||O||E.push(h);if(!(O||x$1(g,E)))throw f$3.error("invalid-field: outField is invalid."),new s$3("getResults():invalid-field","outField is invalid.");const C=g.createQuery(),{orderByFields:N}=u;if(N&&(C.orderByFields=N),l){C.outSpatialReference=l;const e=1/G(l);e&&(C.maxAllowableOffset=e);}const k="mesh"===g.geometryType||"multipatch"===g.geometryType,q=(null==(t=g.capabilities)||null==(p=t.data)?void 0:p.supportsZ)&&!k;if(C.returnZ=q&&!1!==S,C.returnGeometry=!0,C.multipatchOption=k?"xyFootprint":null,E&&(C.outFields=E),n)C.geometry=n;else if(d.key)C.objectIds=[parseInt(d.key,10)];else {const e=u.searchFields||[L];if(!x$1(g,e))throw f$3.error("invalid-field: search field is invalid."),new s$3("getResults():invalid-field","search field is invalid.");v$1(g)&&(C.num=o),j&&(C.geometry=j);if(!d.text.trim())return [];const{prefix:t="",suffix:n=""}=u,l=T(I$1(`${t}${d.text}${n}`),g,e,m,i);if(!l)return [];C.where=l;}return g.queryFeatures(C,{signal:R}).then((e=>U(e,c,u,a,L,b,F)))}))}function m$1(e,t){const{source:i,spatialReference:n,view:o,suggestTerm:l,maxSuggestions:s,sourceIndex:u}=e,{layer:a,filter:d}=i,g=t&&t.signal,m=p$3(i,o);return h$2(a).then((()=>{if(!v$1(a))return [];const e=w$3(i),t=i.searchFields||[e],o=[];i.suggestionTemplate?i.suggestionTemplate.replace(c$5,((e,t)=>(o.push(t),e))):o.push(e);const p=y$3(o);-1!==o.indexOf(a.objectIdField)||p||o.push(a.objectIdField);const h=$$1(a,e),F=p||x$1(a,o),b=x$1(a,t);if(!h)throw f$3.error("invalid-field: displayField is invalid."),new s$3("getSuggestions():invalid-field","displayField is invalid.");if(!F)throw f$3.error("invalid-field: outField is invalid."),new s$3("getSuggestions():invalid-field","outField is invalid.");if(!b)throw f$3.error("invalid-field: search field is invalid."),new s$3("getSuggestions():invalid-field","search field is invalid.");const j=a.createQuery(),{orderByFields:R}=i;R&&(j.orderByFields=R),j.outSpatialReference=n,j.returnGeometry=!1,j.num=s,j.outFields=o,m&&(j.geometry=m);if(!l.trim())return [];const{prefix:S="",suffix:L=""}=i,D=T(I$1(`${S}${l}${L}`),a,t,d,!1);return D?(j.where=D,a.queryFeatures(j,{signal:g}).then((t=>N(t,i,u,e)))):[]}))}function p$3(e,t){const{filter:i,withinViewEnabled:r}=e,n=t&&t.extent;return i&&i.geometry||(r&&n?n:void 0)}function y$3(e){return e&&-1!==e.indexOf("*")}async function h$2(e){e&&await e.load();}function v$1(e){var t,i,r;return null!=(t=null==e||null==(i=e.capabilities)||null==(r=i.query)?void 0:r.supportsPagination)&&t}function F(e){let t="";if(e){const{fields:i}=e;i&&i.some((e=>"string"===e.type&&(t=e.name,!0)));}return t}function w$3(e){return e.displayField||e.layer.displayField||F(e.layer)}function x$1(e,t){return !(!e||!t)&&t.every((t=>$$1(e,t)))}function $$1(e,t){return !!e.getField(t)}function b$1(e){for(let t=0;t<e.length;t++)if(e.charCodeAt(t)>255)return !0;return !1}function j$1(e,t,i){let r=null;const{codedValues:n}=e;return n&&n.some((e=>{const n=e.name,o=i?n:n.toLowerCase();return (i?t:t.toLowerCase())===o&&(r=e.code.toString(),!0)})),r}function I$1(e){return e.replace(/\'/g,"''")}function R(e,t){const i=t&&t.where;return i?`(${e}) AND (${i})`:e}function S$2(e,t,i,r,n){const o=t.type,l=t.name;if("string"===o||"date"===o||"global-id"===o){if(n)return R(`${l} = ${i}'${e}'`,r);return R(`UPPER(${l}) LIKE ${i}'%${e.toUpperCase()}%'`,r)}if("oid"===o||"small-integer"===o||"integer"===o||"single"===o||"double"===o){const t=Number(e);return isNaN(t)?null:R(`${l} = ${t}`,r)}return R(`${l} = ${e}`,r)}function L(e,t){return e?` OR (${t})`:`(${t})`}function T(e,t,i,r,n){const{definitionExpression:o}=t;let l="";if(e){const o=d$5.test(t.url)&&b$1(e)?"N":"";i&&i.forEach((i=>{const s=t.getField(i),u="function"==typeof t.getFieldDomain&&t.getFieldDomain(i),a=(u&&"coded-value"===u.type?j$1(u,e,n):null)||e||null;if(null!==a){const e=S$2(a,s,o,r,n);e&&(l+=L(l,e));}}));}return o?`(${o}) AND (${l})`:l}function D(e,t){let i=null;const{codedValues:r}=e;return r&&r.length&&r.some((e=>e.code===t&&(i=e.name,!0))),i}function E(e,t){return e[Object.keys(e).find((e=>e.toLowerCase()===t.toLowerCase()))]}function O(e,t,i){const r=e.sourceLayer,{attributes:n}=e,s="function"==typeof r.getFieldDomain&&r.getFieldDomain(i);if(t)return s$4(t,n);if(i&&n){const e=r.getField(i),t=E(n,i);return null==t?"":s&&"coded-value"===s.type?D(s,t):"date"===(null==e?void 0:e.type)?L$1(new Date(t)):"number"==typeof t?t.toString():"string"!=typeof t?"":t.trim()}return ""}function C(e,t,i,r){const n=e.sourceLayer,{attributes:o}=e,{objectIdField:l}=n,s=o[l];return {text:O(e,t.suggestionTemplate,r),key:s,sourceIndex:i}}function N(e,t,i,r){return e.features.map((e=>C(e,t,i,r)))}function k$1(i,r,o,l,s,d,c){const f=i.clone(),g=i.sourceLayer,m=g&&g.objectIdField,p=m&&i.attributes[m],y=O(i,o.searchTemplate,s),h=a$6(f.geometry,r,d),v="number"==typeof c?p$4(y$6(h),r,c):h,F=i.clone();return r$1(v)&&(F.geometry=x$3.fromExtent(v)),{extent:v,target:F,feature:f,key:p,name:y,sourceIndex:l}}function U(e,t,i,r,n,o,l){return e.features.map((e=>k$1(e,t,i,r,n,o,l)))}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
var a$5;let h$1=a$5=class extends i$3{constructor(){super(...arguments),this.displayField=null,this.exactMatch=null,this.orderByFields=null,this.searchFields=null,this.searchTemplate=null,this.suggestionTemplate=null,this.getResults=(e,t)=>g$2({source:this,...e},t),this.getSuggestions=(e,t)=>m$1({source:this,...e},t);}set layer(e){this._set("layer",e),e&&e.load().catch((()=>{}));}get name(){return this._getLayerTitle()||""}set name(e){void 0!==e?this._override("name",e):this._clearOverride("name");}clone(){return new a$5({autoNavigate:this.autoNavigate,filter:this.filter,maxResults:this.maxResults,maxSuggestions:this.maxSuggestions,minSuggestCharacters:this.minSuggestCharacters,outFields:this.outFields?y$6(this.outFields):null,placeholder:this.placeholder,popupEnabled:this.popupEnabled,prefix:this.prefix,resultGraphicEnabled:this.resultGraphicEnabled,resultSymbol:this.resultSymbol?this.resultSymbol.clone():null,suggestionsEnabled:this.suggestionsEnabled,suffix:this.suffix,withinViewEnabled:this.withinViewEnabled,displayField:this.displayField,exactMatch:this.exactMatch,layer:this.layer,searchFields:this.searchFields?y$6(this.searchFields):null,suggestionTemplate:this.suggestionTemplate,zoomScale:this.zoomScale})}_getFirstStringField(){const e=this.layer;let t="";return e&&e.fields&&e.fields.some((e=>"string"===e.type&&(t=e.name,!0))),t}_getDisplayField(){return this.displayField||this.layer.displayField||this._getFirstStringField()}_getSearchFieldsString(){const{layer:e,searchFields:t}=this;if(!e.loaded)return "";return `: ${(t||[this._getDisplayField()]).map((t=>{const s=e.getField(t);return s&&s.alias||t})).join(", ")}`}_getLayerTitle(){const{layer:e}=this;if(!e)return;const{title:t}=e;return t?`${t}${this._getSearchFieldsString()}`:void 0}};e$2([y$7({json:{read:{source:"field.name"},write:{target:"field.name"}}})],h$1.prototype,"displayField",void 0),e$2([y$7({json:{read:{source:"field.exactMatch"},write:{target:"field.exactMatch"}}})],h$1.prototype,"exactMatch",void 0),e$2([y$7({value:null})],h$1.prototype,"layer",null),e$2([y$7()],h$1.prototype,"name",null),e$2([y$7({type:[String],json:{write:!0}})],h$1.prototype,"orderByFields",void 0),e$2([y$7()],h$1.prototype,"searchFields",void 0),e$2([y$7()],h$1.prototype,"searchTemplate",void 0),e$2([y$7()],h$1.prototype,"suggestionTemplate",void 0),h$1=a$5=e$2([i$4("esri.widgets.Search.LayerSearchSource")],h$1);var n$5=h$1;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const t={type:String,json:{read:{source:"token"},write:{target:"token"}}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
let a$4=class extends a$8{constructor(o){super(o),this.address=null,this.apiKey=null,this.categories=null,this.countryCode=null,this.forStorage=null,this.location=null,this.locationType=null,this.magicKey=null,this.maxLocations=null,this.outFields=null,this.outSpatialReference=null,this.searchExtent=null;}};e$2([y$7({type:Object,json:{write:!0}})],a$4.prototype,"address",void 0),e$2([y$7(t)],a$4.prototype,"apiKey",void 0),e$2([y$7({type:[String],json:{read:{source:"category",reader:o=>o?o.split(","):null},write:{target:"category",writer:(o,t)=>{t.category=o?o.join(","):null;}}}})],a$4.prototype,"categories",void 0),e$2([y$7({type:String,json:{write:!0}})],a$4.prototype,"countryCode",void 0),e$2([y$7({type:Boolean,json:{write:!0}})],a$4.prototype,"forStorage",void 0),e$2([y$7({type:j$2,json:{write:{writer:(o,t)=>{t.location=o?o.clone().normalize():null;}}}})],a$4.prototype,"location",void 0),e$2([y$7({type:String,json:{write:!0}})],a$4.prototype,"locationType",void 0),e$2([y$7({type:String,json:{write:!0}})],a$4.prototype,"magicKey",void 0),e$2([y$7({type:Number,json:{write:!0}})],a$4.prototype,"maxLocations",void 0),e$2([y$7({type:[String],json:{write:{writer:(o,t)=>{t.outFields=o?o.join(","):null;}}}})],a$4.prototype,"outFields",void 0),e$2([y$7({type:k$2,json:{read:{source:"outSR"},write:{target:"outSR"}}})],a$4.prototype,"outSpatialReference",void 0),e$2([y$7({type:M,json:{write:{writer:(o,t)=>{const e=o?o.shiftCentralMeridian():null;t.searchExtent=e;}}}})],a$4.prototype,"searchExtent",void 0),a$4=e$2([i$4("esri.tasks.support.AddressToLocationsParameters")],a$4),a$4.from=d$6(a$4);var c$4=a$4;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
let a$3=class extends a$8{constructor(o){super(o),this.apiKey=null,this.location=null,this.locationType=null,this.outSpatialReference=null;}};e$2([y$7(t)],a$3.prototype,"apiKey",void 0),e$2([y$7({type:j$2,json:{write:{writer:(o,r)=>{const t=o?o.clone().normalize():null,e=void 0!==t;r.location=e?t:null;}}}})],a$3.prototype,"location",void 0),e$2([y$7({type:String,json:{write:!0}})],a$3.prototype,"locationType",void 0),e$2([y$7({type:k$2,json:{read:{source:"outSR"},write:{target:"outSR"}}})],a$3.prototype,"outSpatialReference",void 0),a$3=e$2([i$4("esri.tasks.support.LocationToAddressParameters")],a$3),a$3.from=d$6(a$3);var l$3=a$3;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
let c$3=class extends a$8{constructor(t){super(t),this.apiKey=null,this.categories=null,this.countryCode=null,this.location=null,this.maxSuggestions=null,this.outSpatialReference=null,this.searchExtent=null,this.text=null;}};e$2([y$7(t)],c$3.prototype,"apiKey",void 0),e$2([y$7({type:[String],json:{read:{source:"category",reader:t=>t?t.split(","):null},write:{target:"category",writer:(t,o)=>{o.category=t?t.join(","):null;}}}})],c$3.prototype,"categories",void 0),e$2([y$7({type:String,json:{write:!0}})],c$3.prototype,"countryCode",void 0),e$2([y$7({type:j$2,json:{write:{writer:(t,o)=>{o.location=t?t.clone().normalize():null;}}}})],c$3.prototype,"location",void 0),e$2([y$7({type:Number,json:{write:!0}})],c$3.prototype,"maxSuggestions",void 0),e$2([y$7({type:k$2,json:{read:{source:"outSR"},write:{target:"outSR"}}})],c$3.prototype,"outSpatialReference",void 0),e$2([y$7({type:M,json:{write:{writer:(t,o)=>{const r=t?t.shiftCentralMeridian():null;o.searchExtent=JSON.stringify(r);}}}})],c$3.prototype,"searchExtent",void 0),e$2([y$7({type:String,json:{write:!0}})],c$3.prototype,"text",void 0),c$3=e$2([i$4("esri.tasks.support.SuggestLocationsParameters")],c$3),c$3.from=d$6(c$3);var l$2=c$3;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const u$4="Single Line Input",l$1=3e5;function m(e,o){return e.location?x(e,o):S$1(e,o)}function f$2(e){const o=null==e?void 0:e.scale;return "number"==typeof o&&o<=l$1?e.get("extent.center"):null}function d$4(o,t){const{source:r,spatialReference:s,view:n,suggestTerm:c,maxSuggestions:a,sourceIndex:u}=o,l=new l$2,{apiKey:m,locator:d}=r,g=v(r,n),p=t&&t.signal;if(!d)return Promise.resolve(null);m&&(l.apiKey=m),r.categories&&(l.categories=r.categories),s&&(l.outSpatialReference=s);const y=f$2(n);y&&(l.location=y);if(!c.trim())return Promise.resolve(null);const{prefix:x="",suffix:S=""}=r,w=`${x}${c}${S}`;return l.text=w,g&&(l.searchExtent=e$3(g)),l.maxSuggestions=a,r.countryCode&&(l.countryCode=r.countryCode),d.suggestLocations(l,{signal:p}).then((e=>k(e,u)))}function g$1(e){return !!e&&/(?:geocode\-api\.arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/gi.test(e)}function p$2(e){return !!e&&/(?:\/servers\/[\da-z\.-]+\/rest\/services\/world\/geocodeserver).*/gi.test(e)}function y$2(e){return !!e&&/(?:arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/gi.test(e)}function x(e,o){const{source:t,spatialReference:r,location:s,sourceIndex:i,view:c}=e,{apiKey:a,locator:u,zoomScale:l,defaultZoomScale:m}=t,f=c&&c.scale,d=o&&o.signal,g=new l$3;return g.location=s,a&&(g.apiKey=a),r&&(g.outSpatialReference=r),u.locationToAddress(g,{signal:d}).then((e=>K$1([e],{sourceIndex:i,scale:f,view:c,zoomScale:l,defaultZoomScale:m})))}function v(e,o){const{filter:t,withinViewEnabled:r}=e,s=o&&o.scale,n=o&&o.extent,i=t&&t.geometry;return a$6(i,o,s)||(r&&n?n:void 0)}function S$1(o,t){const{source:r,suggestResult:n,spatialReference:i,view:c,maxResults:a,sourceIndex:l}=o,m=r&&r.zoomScale,d=r&&r.defaultZoomScale;if(!n.text.trim())return Promise.resolve(null);const g=!n.key&&r.prefix?r.prefix:"",p=!n.key&&r.suffix?r.suffix:"",y=`${g}${n.text}${p}`,x=new c$4,{apiKey:S,locator:w}=r,k=c&&c.scale,I=v(r,c),L=t&&t.signal;if(S&&(x.apiKey=S),!w)return Promise.resolve(null);r.categories&&(x.categories=r.categories),r.locationType&&(x.locationType=r.locationType),i&&(x.outSpatialReference=i);const P=f$2(c);P&&(x.location=P),x.maxLocations=a,I&&(x.searchExtent=e$3(I)),r.countryCode&&(x.countryCode=r.countryCode);const{key:R}=n;return R&&(x.magicKey=R),x.address={},x.address[r.singleLineFieldName||u$4]=y,r.outFields&&(x.outFields=r.outFields),w.addressToLocations(x,{signal:L}).then((e=>K$1(e,{key:R,scale:k,sourceIndex:l,view:c,zoomScale:m,defaultZoomScale:d})))}function w$2(e,o){return {text:e.text,key:e.magicKey,sourceIndex:o}}function k(e,o){return e.map((e=>w$2(e,o)))}function I(e,s){const{key:n,scale:i,sourceIndex:u,view:l,zoomScale:m,defaultZoomScale:f}=s,{attributes:d,extent:g,location:p,address:y}=e,x=new n$9({geometry:p,attributes:d}),v=g||p,S=a$6(v,l,i),w="number"==typeof m?p$4(S,l,m):"number"==typeof f&&"point"===v.type?p$4(S,l,f):S,k=p?`${p.x},${p.y}`:"",I=y||k,K=x.clone();return r$1(w)&&(K.geometry=x$3.fromExtent(w)),{extent:w,feature:x,target:K,key:n,name:I,sourceIndex:u}}function K$1(e,o){return e.map((e=>I(e,o)))}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
function n$4(n){return n&&"number"==typeof n.x&&"number"==typeof n.y}function e$1(n){return n&&"number"==typeof n.xmin&&"number"==typeof n.ymin&&"number"==typeof n.xmax&&"number"==typeof n.ymax}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
let i$2=class extends a$8{constructor(t){super(t),this.address=null,this.attributes=null,this.extent=null,this.location=null,this.score=null;}};e$2([y$7({type:String,json:{write:!0}})],i$2.prototype,"address",void 0),e$2([y$7({type:Object,json:{write:!0}})],i$2.prototype,"attributes",void 0),e$2([y$7({type:M,json:{write:!0}})],i$2.prototype,"extent",void 0),e$2([y$7({type:j$2,json:{write:!0}})],i$2.prototype,"location",void 0),e$2([y$7({type:Number,json:{write:!0}})],i$2.prototype,"score",void 0),i$2=e$2([i$4("esri.tasks.support.AddressCandidate")],i$2);var c$2=i$2;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
async function d$3(o,n,a){n=c$4.from(n);const d=r$3(o),{address:p,...m}=n.toJSON(),u={...p,...m,f:"json"},c=n$a({...d.query,...u}),j=e$4(c,a),l=`${d.path}/findAddressCandidates`;return U$1(l,j).then(f$1)}function f$1({data:t}){if(!t)return [];const{candidates:r,spatialReference:s}=t;return r?r.map((t=>{if(!t)return;const{extent:r,location:e}=t,i=!r||e$1(r);return n$4(e)&&i?(r&&(r.spatialReference=s),e.spatialReference=s,c$2.fromJSON(t)):void 0})):[]}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
let i$1=class extends a$8{constructor(r){super(r),this.addresses=null,this.categories=null,this.countryCode=null,this.locationType=null,this.outSpatialReference=null;}};e$2([y$7({type:[Object],json:{read:{reader:r=>r&&r.records?r.records.map((r=>r.attributes)):null},write:{writer:(r,e)=>{const o=[];Array.isArray(r)&&r.forEach((r=>{o.push({attributes:r});})),e.addresses={records:o};}}}})],i$1.prototype,"addresses",void 0),e$2([y$7({type:[String],json:{read:{source:"category",reader:r=>r?r.split(","):null},write:{target:"category",writer:(r,e)=>{e.category=r?r.join(","):null;}}}})],i$1.prototype,"categories",void 0),e$2([y$7({type:String,json:{read:{source:"sourceCountry"},write:{target:"sourceCountry"}}})],i$1.prototype,"countryCode",void 0),e$2([y$7({type:String,json:{write:!0}})],i$1.prototype,"locationType",void 0),e$2([y$7({type:k$2,json:{read:{source:"outSR"},write:{target:"outSR"}}})],i$1.prototype,"outSpatialReference",void 0),i$1=e$2([i$4("esri.tasks.support.AddressesToLocationsParameters")],i$1),i$1.from=d$6(i$1);var a$2=i$1;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
async function a$1(e,a,c){a=a$2.from(a);const p=r$3(e),f={...a.toJSON(),f:"json"},m=n$a({...p.query,...f}),u=e$4(m,c),d=`${p.path}/geocodeAddresses`;return U$1(d,u).then(i)}function i(t){const{data:s}=t;if(!s)return [];const{locations:o,spatialReference:r}=s;return o?o.map((t=>{const{location:s}=t;return s&&(s.spatialReference=r),c$2.fromJSON(t)})):[]}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
async function n$3(e,n,i){n=l$3.from(n);const c=r$3(e),m={...n.toJSON(),f:"json"},u=n$a({...c.query,...m}),f=e$4(u,i),p=`${c.path}/reverseGeocode`;return U$1(p,f).then(d$2)}function d$2({data:r}){if(!r)return;const{address:t,location:o}=r,s=t&&t.Match_addr||"";return c$2.fromJSON({address:s,attributes:t||{},location:o,score:100})}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
let e=class extends a$8{constructor(o){super(o),this.isCollection=null,this.magicKey=null,this.text=null;}};e$2([y$7({type:Boolean,json:{write:!0}})],e.prototype,"isCollection",void 0),e$2([y$7({type:String,json:{write:!0}})],e.prototype,"magicKey",void 0),e$2([y$7({type:String,json:{write:!0}})],e.prototype,"text",void 0),e=e$2([i$4("esri.tasks.support.SuggestionCandidate")],e);var p$1=e;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
async function u$3(n,u,i){const m=r$3(n),p={...(u=l$2.from(u)).toJSON(),f:"json"},f=n$a({...m.query,...p}),g=e$4(f,i),c=`${m.path}/suggest`;return U$1(c,g).then(a)}function a(t){const{data:s}=t;if(!s)return [];const{suggestions:o}=s;return o?o.map((t=>new p$1(t))):[]}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
let u$2=class extends p$7{constructor(e){super(e),this.outSpatialReference=null,this.url=null;}addressToLocations(e,t){!e.outSpatialReference&&this.outSpatialReference&&(e.outSpatialReference=this.outSpatialReference);const o={...this.requestOptions,...t};return d$3(this.url,e,o)}suggestLocations(e,t){const o={...this.requestOptions,...t};return u$3(this.url,e,o)}addressesToLocations(e,t){!e.outSpatialReference&&this.outSpatialReference&&(e.outSpatialReference=this.outSpatialReference);const o={...this.requestOptions,...t};return a$1(this.url,e,o)}locationToAddress(e,t){!e.outSpatialReference&&this.outSpatialReference&&(e.outSpatialReference=this.outSpatialReference);const o={...this.requestOptions,...t};return n$3(this.url,e,o)}};e$2([y$7({type:k$2})],u$2.prototype,"outSpatialReference",void 0),e$2([y$7()],u$2.prototype,"url",void 0),u$2=e$2([i$4("esri.tasks.Locator")],u$2);var n$2=u$2;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
var u$1;let n$1=u$1=class extends i$3{constructor(){super(...arguments),this.apiKey=null,this.categories=null,this.countryCode=null,this.defaultZoomScale=null,this.locator=null,this.locationType=null,this.name="",this.placeholder="",this.searchTemplate="",this.singleLineFieldName=null,this.suggestionsEnabled=null,this.zoomScale=null,this.getResults=(o,e)=>m({source:this,...o},e),this.getSuggestions=(o,e)=>d$4({source:this,...o},e);}readLocator(o,e){const{url:t}=e;return t?new n$2({url:t}):null}writeLocator(o,e){e.url=o?o.url:null;}clone(){return new u$1({apiKey:this.apiKey,autoNavigate:this.autoNavigate,filter:this.filter,maxResults:this.maxResults,maxSuggestions:this.maxSuggestions,minSuggestCharacters:this.minSuggestCharacters,outFields:this.outFields?y$6(this.outFields):null,placeholder:this.placeholder,popupEnabled:this.popupEnabled,prefix:this.prefix,resultGraphicEnabled:this.resultGraphicEnabled,resultSymbol:this.resultSymbol?this.resultSymbol.clone():null,suggestionsEnabled:this.suggestionsEnabled,suffix:this.suffix,withinViewEnabled:this.withinViewEnabled,categories:this.categories?y$6(this.categories):null,countryCode:this.countryCode,locationType:this.locationType,locator:this.locator,searchTemplate:this.searchTemplate,singleLineFieldName:this.singleLineFieldName,zoomScale:this.zoomScale})}};e$2([y$7()],n$1.prototype,"apiKey",void 0),e$2([y$7()],n$1.prototype,"categories",void 0),e$2([y$7()],n$1.prototype,"countryCode",void 0),e$2([y$7({json:{write:!0}})],n$1.prototype,"defaultZoomScale",void 0),e$2([y$7({type:n$2})],n$1.prototype,"locator",void 0),e$2([e$5("locator",["url"])],n$1.prototype,"readLocator",null),e$2([o$4("locator")],n$1.prototype,"writeLocator",null),e$2([y$7()],n$1.prototype,"locationType",void 0),e$2([y$7({json:{write:!0}})],n$1.prototype,"name",void 0),e$2([y$7({json:{write:!0}})],n$1.prototype,"placeholder",void 0),e$2([y$7()],n$1.prototype,"searchTemplate",void 0),e$2([y$7({json:{write:!0}})],n$1.prototype,"singleLineFieldName",void 0),e$2([y$7({json:{read:{source:"suggest"},write:{target:"suggest"}}})],n$1.prototype,"suggestionsEnabled",void 0),e$2([y$7({json:{write:!0}})],n$1.prototype,"zoomScale",void 0),n$1=u$1=e$2([i$4("esri.widgets.Search.LocatorSearchSource")],n$1);var h=n$1;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const u=n$8.getLogger("esri.widgets.support.geolocationUtils"),c$1={maximumAge:0,timeout:15e3,enableHighAccuracy:!0};function p(){const t=t$3("esri-geolocation");return t||u.warn("geolocation-unsupported","Geolocation unsupported."),t}function l(){const e=window.isSecureContext;return e||u.warn("insecure-context","Geolocation requires a secure origin."),e}function g(){return p()&&l()}function f(e){const t=15e3;return e||(e=c$1),new Promise(((r,i)=>{setTimeout((()=>i(new s$3("geolocation:timeout","getting the current geolocation position timed out"))),t),navigator.geolocation.getCurrentPosition(r,i,e);}))}function j(e,t){const{position:r,view:o}=e;return P(y$1(d$1(r)),o,t)}function d$1(e){const t=e&&e.coords||{},r={accuracy:t.accuracy,altitude:t.altitude,altitudeAccuracy:t.altitudeAccuracy,heading:t.heading,latitude:t.latitude,longitude:t.longitude,speed:t.speed};return e?{coords:r,timestamp:e.timestamp}:e}function y$1(e){const t=e&&e.coords;return t?new j$2({longitude:t.longitude,latitude:t.latitude,z:t.altitude||null,spatialReference:{wkid:4326}}):null}function P(e,t,r){if(!t)return Promise.resolve(e);const s=t.spatialReference;return s.isWGS84?Promise.resolve(e):s.isWebMercator?Promise.resolve(d$7(e)):w$1(r).then((t=>{if(!t)throw new s$3("geometry-service:missing-url","Geometry service URL is missing");const i=new a$9({geometries:[e],outSpatialReference:s});return n$b(t,i,r).then((e=>e[0]))}))}function w$1(e){if(s$5.geometryServiceUrl)return Promise.resolve(s$5.geometryServiceUrl);const r=w$4.getDefault();return r.load(e).catch((()=>{})).then((()=>r.get("helperServices.geometry.url")))}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
function q(e,t){return e.hasOwnProperty(t)&&null!=e[t]&&""!==e[t]}const W=()=>c$9("esri/widgets/Search/t9n/Search"),K="esri.widgets.Search.SearchViewModel",X=n$8.getLogger(K),Y="highlight",$=L$2.ofType({key:e=>e.layer?"layer":"locator",base:i$3,typeMap:{layer:n$5,locator:h}}),ee=k$2.WGS84,te="esri/images/search/search-symbol-32.svg",re="esri/images/search/search-symbol-32.png",se=/<(?:.|\s)*?>/g,oe=-1;let ie=class extends(e$6(n$c.EventedMixin(u$8))){constructor(e){super(e),this._handles=new u$9,this._gotoController=null,this._searching=null,this.autoNavigate=!0,this.autoSelect=!0,this.defaultPopupTemplate=null,this.defaultSources=new $,this.defaultSymbol=new n$d({url:a$a(t$3("trident")?re:te),size:24,width:24,height:24}),this.includeDefaultSources=!0,this.maxInputLength=128,this.maxResults=6,this.maxSuggestions=6,this.messages=null,this.minSuggestCharacters=1,this.popupEnabled=!0,this.popupTemplate=null,this.portal=w$4.getDefault(),this.resultCount=null,this.resultGraphicEnabled=!0,this.resultGraphic=null,this.results=null,this.selectedSuggestion=null,this.searchAllEnabled=!0,this.selectedResult=null,this.sources=new $,this.suggestionDelay=150,this.suggestionCount=null,this.suggestions=null,this.suggestionsEnabled=!0,this.view=null;}initialize(){const e=async()=>{const e=await W();this.messages=e,this.defaultPopupTemplate=new M$1({title:e.searchResult,content:"{Match_addr}"});};e(),this._handles.add([C$1(this,["defaultSources","sources"],"change",(()=>this.notifyChange("allSources"))),d$8(this,["includeDefaultSources","view","portal"],(()=>this._update())),f$4(e)]);}destroy(){this._abortGoTo(),this.clearGraphics(),this._handles.destroy(),this._handles=null;}get activeSource(){return this.allSources.getItemAt(this.activeSourceIndex)||null}get activeSourceIndex(){return 1===this.allSources.length||!this.searchAllEnabled?0:oe}set activeSourceIndex(e){void 0!==e?this._override("activeSourceIndex",e):this._clearOverride("activeSourceIndex");}get allPlaceholder(){var e;return null==(e=this.messages)?void 0:e.allPlaceholder}set allPlaceholder(e){e?this._override("allPlaceholder",e):this._clearOverride("allPlaceholder");}get allSources(){const{sources:e,defaultSources:t,includeDefaultSources:r}=this,s="function"==typeof r?r.call(null,{sources:e,defaultSources:t}):r?t.concat(e):e,o=this._get("allSources")||new $;return o.removeAll(),o.addMany(s.filter(Boolean)),o}get locationEnabled(){return this._get("locationEnabled")||g()}set locationEnabled(e){if(void 0===e)return void this._clearOverride("locationEnabled");const t=g();if(e&&!t){const e=new s$3("locationEnabled:geolocation-unsupported","Geolocation API is unsupported.",{geolocation:navigator.geolocation});X.error(e);}this._override("locationEnabled",e&&t);}get placeholder(){const{allSources:e,activeSourceIndex:t,allPlaceholder:r}=this;if(t===oe)return r;const s=e.getItemAt(t);return s?s.placeholder:""}set searchTerm(e){this._set("searchTerm",e||""),this.clearGraphics(),this.selectedSuggestion&&this.selectedSuggestion.text!==e&&this._set("selectedSuggestion",null),""===e&&this._clear();}get searchTerm(){return this._get("searchTerm")||""}get state(){return this._searching?"searching":this.updating?"loading":0===this.allSources.length?"disabled":"ready"}get updating(){return null!=this._updatingPromise}clear(){this.searchTerm="";}clearGraphics(){this._removeHighlight(),this._closePopup(),this.view&&this.view.graphics.remove(this.resultGraphic),this._set("resultGraphic",null);}search(e,t){this.emit("search-start"),this.clearGraphics();const r=this._createSuggestionForSearch(e),s=this.when().then((()=>this._getResultsFromSources(r,t).then((e=>{const t={activeSourceIndex:this.activeSourceIndex,searchTerm:r.text,numResults:0,numErrors:0,errors:[],results:[]};this._formatResponse(t,e,r);const s=this._getFirstResult(t.results),o=(r.location&&s?s.name:r.text).replace(se,"");return this._set("searchTerm",o),(r.key&&"number"==typeof r.sourceIndex||r.location)&&this._set("selectedSuggestion",r),this._set("results",t.results),this._set("resultCount",t.results.reduce(((e,t)=>e+t.results.length),0)),this.emit("search-complete",t),this._selectFirstResult(s).then((()=>t))})))).then((e=>(this._clearSearching(),e)),(e=>{throw this._clearSearching(),e}));return this._searching=s,this.notifyChange("state"),s}searchNearby(e){if(!this.locationEnabled){const e=new s$3("searchNearby:geolocation-unsupported","Geolocation API is unsupported.",{geolocation:navigator.geolocation});return X.error(e),Promise.reject(e)}const t=f().then((t=>j({position:t,view:this.view},e))).then((t=>this.search(t,e)));return this._searching=t,this.notifyChange("state"),t.catch((()=>{})).then((()=>this._clearSearching())),t}select(e){if(this.clearGraphics(),!e){const t=new s$3("select:missing-parameter","Cannot select without a searchResult.",{searchResult:e});return X.error(t),Promise.reject(t)}const{view:t}=this,r=q(e,"sourceIndex")?e.sourceIndex:this._getSourceIndexOfResult(e),o=this.allSources.getItemAt(r);if(!o){const e=new s$3("select:missing-source","Cannot select without a source.",{source:o});return X.error(e),Promise.reject(e)}const i=o instanceof n$5?this._getLayerSourcePopupTemplate(o):o.popupTemplate,l=o.resultSymbol||this._getDefaultSymbol(e),a=q(o,"resultGraphicEnabled")?o.resultGraphicEnabled:this.resultGraphicEnabled,n=q(o,"autoNavigate")?o.autoNavigate:this.autoNavigate,h=q(o,"popupEnabled")?o.popupEnabled:this.popupEnabled,p=h?i||this.popupTemplate||this.defaultPopupTemplate:null,{feature:d}=e;if(!d){const e=new s$3("select:missing-feature","Cannot select without a feature.",{feature:d});return X.error(e),Promise.reject(e)}const{attributes:g,geometry:m,layer:y,sourceLayer:S}=d,f=m$2(m),v={layerViewQuery:this._getLayerView(d),elevationQuery:t&&r$1(f)?s(f,t).catch((()=>f)):Promise.resolve(f)};return E$1(v).then((i=>{const u=i.layerViewQuery.value,c=i.elevationQuery.value;l instanceof y$8&&(l.text=e.name);const f=t&&n?e.target||e.extent:null;return (r$1(f)?this._goToSearchResult(f):Promise.resolve()).then((()=>{var s;const i=u?d:new n$9({geometry:m,symbol:l,attributes:g,layer:y,sourceLayer:S,popupTemplate:p}),n=h&&(null==(s=this.view)?void 0:s.popup),f=n&&i.getEffectivePopupTemplate(n.defaultPopupTemplateEnabled);return f&&t.popup.open({features:[i],location:c}),u&&e$7(u)&&!f&&this._highlightFeature({graphic:i,layerView:u}),!u&&a&&t&&t.graphics.push(i),this._set("selectedResult",e),this._set("resultGraphic",i),this.emit("select-result",{result:e,source:o,sourceIndex:r}),e}))}))}suggest(e,t,r){const s=e||this.searchTerm;return this.emit("suggest-start",{searchTerm:s}),this._suggestTimer(t,r).then((()=>this._suggestImmediate(s,r).then((e=>(this._set("suggestions",e.results),this._set("suggestionCount",e.results.reduce(((e,t)=>e+t.results.length),0)),this.emit("suggest-complete",e),e)))))}async when(){await $$2(this,"updating");}async _update(){const{portal:e,view:t}=this;if(this.includeDefaultSources){const r=this._updatingPromise=E$1([null==e?void 0:e.load(),null==t?void 0:t.when()]);if(this.destroyed)return;if(this.notifyChange("updating"),await r,r!==this._updatingPromise)return}this._updatingPromise=null,this.notifyChange("updating");const r=j$3(this,"messages");this.destroyed||(this._handles.add(r),await r,this._updateDefaultSources());}_clearSearching(){this._searching=null,this.notifyChange("state");}_convertHelperServices(){var e,t;const s=null==(e=this.portal)||null==(t=e.helperServices)?void 0:t.geocode;if(!s)return [];return s.map((e=>{var t;if(!1===e.placefinding)return;const s=s$5.apiKey&&y$2(e.url)?{url:"https://geocode-api.arcgis.com/arcgis/rest/services/World/GeocodeServer"}:null,o=h.fromJSON({...e,...s}),i=null==(t=o.locator)?void 0:t.url;if(y$2(i)||p$2(i)||g$1(i)){const e=o.outFields||["Addr_type","Match_addr","StAddr","City"],t=o.placeholder||this.messages.placeholder,r="number"==typeof o.defaultZoomScale?o.defaultZoomScale:2500;o.set({singleLineFieldName:"SingleLine",outFields:e,placeholder:t,defaultZoomScale:r});}return o.singleLineFieldName?o:void 0})).filter(Boolean)}_getLayerSources(e,t){var r;const s=null==(r=this.view)?void 0:r.map;return e.map((e=>{const r=s.findLayerById(e.id);if(!r)return;const o=this._getLayerJSON(e),i=n$5.fromJSON(o);return i.placeholder=t,this._getLayer(r,o).then((e=>{i.layer=e;})),i})).filter(Boolean).toArray()}_getTableSources(e,t){var r;const s=null==(r=this.view)?void 0:r.map;return e.map((e=>{const r=s.findTableById(e.id);if(!r)return;const o=this._getLayerJSON(e),i=n$5.fromJSON(o);return i.placeholder=t,this._getLayer(r,o).then((e=>{i.layer=e;})),i})).filter(Boolean).toArray()}_convertApplicationProperties(){var e,t,r;const s=null==(e=this.view)?void 0:e.map,o=null==s||null==(t=s.applicationProperties)||null==(r=t.viewing)?void 0:r.search;if(!o)return [];const{enabled:i,hintText:l,layers:a,tables:n}=o;if(!i)return [];return [...this._getLayerSources(a,l),...this._getTableSources(n,l)]}_getSubLayer(e,t){return e.load().then((()=>{if(!e.allSublayers)return Promise.reject();const r=e.allSublayers.find((e=>e.id===t.subLayer));return r?r.createFeatureLayer():Promise.reject()}))}async _getBuildingSubLayer(e,t){await e.load();const r=e.allSublayers.find((e=>e.id===t.subLayer));return "building-component"!==(null==r?void 0:r.type)?Promise.reject():(await r.load(),null==r.associatedLayer?Promise.reject():(await r.associatedLayer.load(),r))}_getLayer(e,t){return "feature"===e.type||"scene"===e.type||"csv"===e.type||"geojson"===e.type||"ogc-feature"===e.type?Promise.resolve(e):"map-image"===e.type?this._getSubLayer(e,t).catch((()=>{const t=new s$3("search:create-featurelayer","Could not create a FeatureLayer from the MapImageLayer",{layer:e});return X.error(t),null})):"building-scene"===e.type?this._getBuildingSubLayer(e,t):Promise.resolve(null)}_getLayerJSON(e){return "function"==typeof e.toJSON?e.toJSON():e}_updateDefaultSources(){const{defaultSources:e,includeDefaultSources:t}=this;e.removeAll(),t&&e.addMany([...this._convertApplicationProperties(),...this._convertHelperServices()]),this.notifyChange("allSources");}_abortGoTo(){this._gotoController&&this._gotoController.abort(),this._gotoController=null;}_clear(){this._abortGoTo(),this._set("resultCount",null),this._set("results",null),this._set("suggestions",null),this._set("suggestionCount",null),this._set("selectedResult",null),this._set("selectedSuggestion",null),this.emit("search-clear");}_closePopup(){var e;const t=null==(e=this.view)?void 0:e.popup,{resultGraphic:r}=this;if(!t||!r)return;const{selectedFeature:s}=t;s&&s===r&&t.close();}_suggestTimer(e,t){const r=null!=e?e:this.suggestionDelay;return C$2(r,null,t&&t.signal)}_createLocationForSearch(e){return e instanceof n$9?m$2(e.geometry):e instanceof j$2?e:Array.isArray(e)&&2===e.length?new j$2({longitude:e[0],latitude:e[1]}):null}_createSuggestionForSearch(e){if(e&&q(e,"key")&&q(e,"text")&&q(e,"sourceIndex"))return e;const t=this._createLocationForSearch(e),r="string"==typeof e?e:this.searchTerm,{selectedSuggestion:s,selectedResult:i}=this,l=!e&&s&&i,a=l&&s.key===i.key&&s.sourceIndex===i.sourceIndex,n=l&&s.location;return a||n?s:{location:e$3(t),text:t?"":r,sourceIndex:null,key:null}}_getFirstResult(e){let t=null;return e&&e.some((e=>{const{results:r}=e,s=r[0],o=!!s;return o&&(t=s),o})),t}_selectFirstResult(e){return this.autoSelect&&e?this.select(e):Promise.resolve(null)}_suggestImmediate(e,t){return this.when().then((()=>this._getSuggestionsFromSources(e,t))).then((t=>{const r={activeSourceIndex:this.activeSourceIndex,searchTerm:e,numResults:0,numErrors:0,errors:[],results:[]};return this._formatResponse(r,t),r}))}_formatSourceResponse(e,t,r){const s=t&&t.value||[],o=t&&t.error,i=this.allSources.getItemAt(r);if(o){const t={sourceIndex:r,source:i,error:o};e.errors.push(t),e.numErrors++;}else {const t={sourceIndex:r,source:i,results:s};e.results.push(t),e.numResults+=s.length;}}_formatResponse(e,t,r){if(t)if(e.activeSourceIndex===oe){const s=r&&q(r,"sourceIndex")&&-1!==r.sourceIndex?r.sourceIndex:void 0;t.forEach(((t,r)=>{const o=void 0!==s?s:r;this._formatSourceResponse(e,t,o);}));}else this._formatSourceResponse(e,t[0],e.activeSourceIndex);}_getResultsFromSources(e,t){const{allSources:r}=this,s=!e.location&&q(e,"sourceIndex")?e.sourceIndex:this.activeSourceIndex,o=[];if(!r.length){const e=new s$3("search:no-sources-defined","At least one source is required.",{allSources:r});return X.error(e),Promise.reject(e)}return s===oe?r.forEach(((r,s)=>{o.push(this._getResultsFromSource(e,s,t));})):o.push(this._getResultsFromSource(e,s,t)),E$1(o)}_getSuggestionsFromSources(e,t){const{allSources:r,activeSourceIndex:s}=this,o=[];if(!r.length){const e=new s$3("suggest:no-sources-defined","At least one source is required.",{allSources:r});return X.error(e),Promise.reject(e)}return s===oe?r.forEach(((r,s)=>{o.push(this._getSuggestionsFromSource(e,s,t));})):o.push(this._getSuggestionsFromSource(e,s,t)),E$1(o)}_getResultsFromSource(e,t,r){var s;const o=this.allSources.getItemAt(t),{location:i=null}=e,l=(null==(s=this.view)?void 0:s.spatialReference)||ee,a=q(o,"maxResults")?o.maxResults:this.maxResults,n=!!(o instanceof n$5&&q(o,"exactMatch"))&&o.exactMatch,{view:u}=this;return o.getResults({view:u,sourceIndex:t,location:i,suggestResult:e,spatialReference:l,exactMatch:n,maxResults:a},r)}_getSuggestionsFromSource(e,t,r){const s=this.allSources.getItemAt(t),o=q(s,"suggestionsEnabled")?s.suggestionsEnabled:this.suggestionsEnabled,i=e.length,l=q(s,"minSuggestCharacters")?s.minSuggestCharacters:this.minSuggestCharacters;if(o&&e.trim()&&i>=l){var a;const o=(null==(a=this.view)?void 0:a.spatialReference)||ee,i=q(s,"maxSuggestions")?s.maxSuggestions:this.maxSuggestions,{view:l}=this;return s.getSuggestions({view:l,sourceIndex:t,suggestTerm:e,spatialReference:o,maxSuggestions:i},r)}return Promise.resolve(null)}createDefaultSymbol(e,t){if("point"===t){const t=e;return new y$9({color:e.color,size:t.size,outline:{color:t.outline.color,width:t.outline.width}})}if("polyline"===t){const t=e;return new d$9({color:t.color,width:t.width})}if("polygon"===t){const t=e;return new u$a({color:t.color,outline:{color:t.outline.color,width:t.outline.width}})}}_getLayerSourcePopupTemplate(e){const{layer:t}=e;if(t)return q(e,"popupTemplate")?e.popupTemplate:t.popupTemplate}_getSourceIndexOfResult(e){const t=this.results;let r=null;return t.some((t=>t.results.some((s=>s===e&&(r=t.sourceIndex,!0))))),r}async _goToSearchResult(e){const t=!!e;this._abortGoTo();const r=a$b();this._gotoController=r;const s={target:{target:e},options:{animate:t,signal:r.signal}};await this.callGoTo(s),this._gotoController=null;}_getDefaultSymbol(e){var t,r,o;const l=null==(t=this.view)||null==(r=t.map)||null==(o=r.basemap)?void 0:o.id,a=g$3(e,"feature","geometry","type");if(r$1(a)){const e=n$6({basemap:l,geometryType:a})||n$6({basemap:"topo",geometryType:a}),t=e&&e.primaryScheme;if(t)return t.color&&q(t,"opacity")&&(t.color.a=t.opacity),this.createDefaultSymbol(t,a)}return this.defaultSymbol}_removeHighlight(){this._handles.remove(Y);}async _getLayerView(e){const{view:t}=this;if(!e||!t||"building-component"===e.layer.type)return Promise.resolve(null);const{layer:r}=e;return await t.when(),t.whenLayerView(r)}_highlightFeature(e){const{graphic:t,layerView:r}=e,{attributes:s,layer:o}=t,{objectIdField:i}=o,l=s&&s[i],a=r.highlight(l||t);this._handles.add(a,Y);}};ie.ALL_INDEX=oe,e$2([y$7({readOnly:!0,value:null})],ie.prototype,"activeSource",null),e$2([y$7()],ie.prototype,"activeSourceIndex",null),e$2([y$7()],ie.prototype,"allPlaceholder",null),e$2([y$7({readOnly:!0,dependsOn:["defaultSources.length","sources.length","includeDefaultSources"]})],ie.prototype,"allSources",null),e$2([y$7()],ie.prototype,"autoNavigate",void 0),e$2([y$7()],ie.prototype,"autoSelect",void 0),e$2([y$7()],ie.prototype,"defaultPopupTemplate",void 0),e$2([y$7({readOnly:!0})],ie.prototype,"defaultSources",void 0),e$2([y$7()],ie.prototype,"defaultSymbol",void 0),e$2([y$7()],ie.prototype,"includeDefaultSources",void 0),e$2([y$7()],ie.prototype,"locationEnabled",null),e$2([y$7()],ie.prototype,"maxInputLength",void 0),e$2([y$7()],ie.prototype,"maxResults",void 0),e$2([y$7()],ie.prototype,"maxSuggestions",void 0),e$2([y$7()],ie.prototype,"messages",void 0),e$2([y$7()],ie.prototype,"minSuggestCharacters",void 0),e$2([y$7({readOnly:!0})],ie.prototype,"placeholder",null),e$2([y$7()],ie.prototype,"popupEnabled",void 0),e$2([y$7({type:M$1})],ie.prototype,"popupTemplate",void 0),e$2([y$7({type:w$4})],ie.prototype,"portal",void 0),e$2([y$7()],ie.prototype,"resultCount",void 0),e$2([y$7()],ie.prototype,"resultGraphicEnabled",void 0),e$2([y$7({readOnly:!0})],ie.prototype,"resultGraphic",void 0),e$2([y$7({readOnly:!0})],ie.prototype,"results",void 0),e$2([y$7({readOnly:!0})],ie.prototype,"selectedSuggestion",void 0),e$2([y$7()],ie.prototype,"searchAllEnabled",void 0),e$2([y$7({readOnly:!0})],ie.prototype,"selectedResult",void 0),e$2([y$7()],ie.prototype,"searchTerm",null),e$2([y$7({type:$})],ie.prototype,"sources",void 0),e$2([y$7({readOnly:!0,dependsOn:["allSources.length","updating"]})],ie.prototype,"state",null),e$2([y$7()],ie.prototype,"suggestionDelay",void 0),e$2([y$7()],ie.prototype,"suggestionCount",void 0),e$2([y$7({readOnly:!0})],ie.prototype,"suggestions",void 0),e$2([y$7()],ie.prototype,"suggestionsEnabled",void 0),e$2([y$7({readOnly:!0})],ie.prototype,"updating",null),e$2([y$7()],ie.prototype,"view",void 0),e$2([y$7()],ie.prototype,"clear",null),ie=e$2([i$4(K)],ie);var le=ie;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const n={base:"esri-search-result-renderer esri-widget",anchor:"esri-widget__anchor",showMoreResults:"esri-search-result-renderer__more-results--show-more-results",moreResults:"esri-search-result-renderer__more-results",moreResultsList:"esri-search-result-renderer__more-results-list",moreResultsHeader:"esri-search-result-renderer__more-results-header",moreResultsItem:"esri-search-result-renderer__more-results-item",moreResultsListHeader:"esri-search-result-renderer__more-results-list-header"};let c=class extends L$3{constructor(e,s){super(e,s),this.messages=null,this.showMoreResultsOpen=!1,this.viewModel=null;}render(){const e={[n.showMoreResults]:this.showMoreResultsOpen};return o$5("div",{class:n.base},o$5("div",{key:"esri-search-renderer__container",class:this.classes(n.moreResults,e)},this.renderSearchResultName(),this.renderMoreResults()))}renderMoreResults(){return o$5("div",{key:"esri-search-renderer__more-results"},this.renderMoreResultsButton(),this.renderMoreResultsLists())}renderSearchResultName(){var e;const s=null==(e=this.viewModel)?void 0:e.selectedResult,r=s&&s.name||"";return o$5("div",{key:"esri-search-renderer__result-name",class:n.moreResultsItem},r)}renderMoreResultsLists(){var e;const s=null==(e=this.viewModel)?void 0:e.results,{resultCount:r}=this.viewModel;if(r<2)return null;const t=s.map((e=>this.renderMoreResultsList(e)));return o$5("div",{key:"esri-search-renderer__more-results-container",class:n.moreResultsList},t)}renderMoreResultsButton(){const{messages:e}=this,{resultCount:s}=this.viewModel;return s<2?null:o$5("div",{key:"esri-search-renderer__more-results-button",class:n.moreResultsItem},o$5("a",{class:n.anchor,href:"#",bind:this,onclick:this._showMoreResultsClick,onkeydown:this._showMoreResultsClick},this.showMoreResultsOpen?e.hideMoreResults:e.showMoreResults))}renderMoreResultsHeader(e,s){return o$5("div",{key:`esri-search-result-renderer__header-${s}`,class:n.moreResultsListHeader},e)}renderMoreResultsList(e){var s,r;const{results:t}=e,o=t.length,i=!!o,u=null==(s=this.viewModel)?void 0:s.selectedResult,n=1===o&&t[0]===u,c=this._getSourceName(e.source,e.sourceIndex),d=(null==(r=this.viewModel)?void 0:r.results.length)>1&&!n?this.renderMoreResultsHeader(c,e.sourceIndex):null,a=i&&t.map(((e,s)=>this.renderMoreResultsListItem(e,s))),h=i&&!n?o$5("ul",{key:`esri-search-result-renderer__list-${e.sourceIndex}`},a):null;return i?o$5("div",{key:`esri-search-result-renderer__results-${e.sourceIndex}`},d,h):null}renderMoreResultsListItem(e,s){return e!==this.get("viewModel.selectedResult")?o$5("li",{key:`esri-search-result-renderer__list-item-${s}`},o$5("a",{class:n.anchor,href:"#",tabindex:"0",bind:this,"data-result":e,onclick:this._selectResultClick,onkeydown:this._selectResultClick},e.name)):null}_showMoreResultsClick(e){e.preventDefault(),this.showMoreResultsOpen=!this.showMoreResultsOpen;const s=this.get("viewModel.view.popup");s&&s.reposition();}_selectResultClick(e){e.preventDefault();const s=e.currentTarget["data-result"];this.viewModel&&this.viewModel.select(s);}_getSourceName(e,s){return s===le.ALL_INDEX?this.messages.all:e.name}};e$2([y$7(),e$8("esri/widgets/Search/t9n/Search")],c.prototype,"messages",void 0),e$2([y$7()],c.prototype,"showMoreResultsOpen",void 0),e$2([y$7()],c.prototype,"viewModel",void 0),e$2([n$e()],c.prototype,"_showMoreResultsClick",null),e$2([n$e()],c.prototype,"_selectResultClick",null),c=e$2([i$4("esri.widgets.Search.SearchResultRenderer")],c);var d=c;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
const w={base:"esri-search esri-widget",loader:"esri-widget__loader",loaderText:"esri-widget__loader-text",loaderAnimation:"esri-widget__loader-animation",esriInput:"esri-input",hasMultipleSources:"esri-search--multiple-sources",isLoading:"esri-search--loading",isSearching:"esri-search--searching",showSuggestions:"esri-search--show-suggestions",showSources:"esri-search--sources",showWarning:"esri-search--warning",container:"esri-search__container",input:"esri-search__input",inputContainer:"esri-search__input-container",form:"esri-search__form",submitButton:"esri-search__submit-button",sourcesButton:"esri-search__sources-button",clearButton:"esri-search__clear-button",sourceName:"esri-search__source-name",suggestionsMenu:"esri-search__suggestions-menu",suggestionList:"esri-search__suggestions-list",suggestionListCurrentLocation:"esri-search__suggestions-list--current-location",sourcesMenu:"esri-search__sources-menu",source:"esri-search__source",warningMenu:"esri-search__warning-menu",warningMenuBody:"esri-search__warning-body",warningMenuHeader:"esri-search__warning-header",warningMenuText:"esri-search__warning-text",noValueText:"esri-search__no-value-text",esriWidgetDisabled:"esri-widget--disabled",button:"esri-widget--button",fallbackText:"esri-icon-font-fallback-text",header:"esri-widget__heading",locate:"esri-icon-locate-circled",menu:"esri-menu",menuList:"esri-menu__list",menuItem:"esri-menu__list-item",menuItemActive:"esri-menu__list-item--active",menuItemFocus:"esri-menu__list-item--focus",menuHeader:"esri-menu__header",loadingIcon:"esri-icon-loading-indicator esri-rotating",searchIcon:"esri-icon-search",dropdownIcon:"esri-icon-down-arrow esri-search__sources-button--down",dropupIcon:"esri-icon-up-arrow esri-search__sources-button--up",clearIcon:"esri-icon-close",noticeIcon:"esri-icon-notice-triangle",widgetIcon:"esri-icon-search",disabled:"esri-disabled"},S=/<[a-z/][\s\S]*>/i;let b=class extends L$3{constructor(e,t){super(e,t),this._activeMenuItemIndex=-1,this._handles=new u$9,this._inputNode=null,this._menuItemCount=0,this._sourceMenuButtonNode=null,this._sourceListNode=null,this._suggestionListNode=null,this._searchResultRenderer=new d,this._relatedTarget=null,this._locateFailed=null,this.activeMenu="none",this.activeSource=null,this.activeSourceIndex=null,this.allPlaceholder=null,this.allSources=null,this.autoNavigate=null,this.autoSelect=null,this.defaultSources=null,this.disabled=!1,this.goToOverride=null,this.iconClass=w.widgetIcon,this.includeDefaultSources=null,this.label=void 0,this.locationEnabled=null,this.maxResults=null,this.maxSuggestions=null,this.messages=null,this.messagesCommon=null,this.minSuggestCharacters=null,this.popupEnabled=null,this.popupTemplate=null,this.portal=null,this.resultGraphic=null,this.resultGraphicEnabled=null,this.results=null,this.searchAllEnabled=null,this.searchTerm=null,this.selectedResult=null,this.sources=null,this.suggestions=null,this.suggestionsEnabled=null,this.view=null,this.viewModel=new le,this.own(h$3(this,"searchTerm",(e=>{(e&&"warning"===this.activeMenu||!e&&!this.get("viewModel.selectedSuggestion.location"))&&(this.activeMenu="none");})),C$1(this,"viewModel.allSources","change",(()=>this._watchSourceChanges())),d$8(this,"activeMenu",(()=>this._resetActiveMenuItemIndex())),d$8(this,"viewModel.defaultPopupTemplate",(e=>{e&&(e.content=this._renderSearchResultsContent.bind(this));})));}destroy(){this._handles.destroy(),this._handles=null,this._cancelSuggest(),this._cancelSearch(),this._searchResultRenderer&&(this._searchResultRenderer.viewModel=null,this._searchResultRenderer.destroy(),this._searchResultRenderer=null);}get displayedSearchTerm(){return `${this.viewModel.searchTerm}`.trim()}get inputId(){return this._buildId("input")}get suggestionsMenuId(){return this._buildId("suggest-menu")}get sourceMenuId(){return this._buildId("source-menu")}get sourceMenuButtonId(){return this._buildId("source-menu-button")}clear(){}focus(){this._inputNode&&(this.activeMenu="suggestion",this._inputNode.focus(),this.emit("search-focus"));}blur(e){this._inputNode&&(this._inputNode.blur(),this._inputBlur(e),this.emit("search-blur"));}search(e){this.activeMenu="none",this._cancelSuggest(),this._cancelSearch();const t=a$b(),{signal:s}=t;return this._searchController=t,this.viewModel.search(e,{signal:s}).catch((e=>{if(this._searchController===t)return this.activeMenu="none",this._searchController=null,e})).then((e=>{if(this._searchController===t)return this.activeMenu=e.numResults?"none":"warning",this._searchController=null,e}))}suggest(e){this._cancelSuggest();const t=a$b(),{signal:s}=t;return this._suggestController=t,this.viewModel.suggest(e,null,{signal:s}).then((e=>{if(this._suggestController===t)return this._suggestController=null,e.numResults&&(this.activeMenu="suggestion"),this._scrollToTopSuggestion(),e})).catch((()=>{if(this._suggestController===t)return this._suggestController=null,null}))}render(){const{state:e}=this.viewModel,t={[w.disabled]:"disabled"===e,[w.esriWidgetDisabled]:this.disabled};return o$5("div",{class:this.classes(w.base,t)},"loading"===e?this.renderLoader():this.renderContainer())}renderSubmitButton(){const{messages:e}=this;return o$5("button",{"aria-label":e.searchButtonTitle,bind:this,class:this.classes(w.submitButton,w.button),key:"esri-search__submit-button",onclick:this._handleSearchButtonClick,title:e.searchButtonTitle},o$5("span",{"aria-hidden":"true",class:w.searchIcon}))}renderWarningMenu(){return o$5("div",{key:"esri-search__error-menu",class:this.classes(w.menu,w.warningMenu)},o$5("div",{class:w.warningMenuBody},this.renderWarning()))}renderSourceMenuButton(){const{messages:e,activeMenu:t,sourceMenuId:s,sourceMenuButtonId:i}=this,{activeSourceIndex:r,allSources:n}=this.viewModel;return n.length>1?o$5("button",{id:i,key:"esri-search__source-menu-button",bind:this,"aria-label":e.searchIn,title:e.searchIn,"aria-haspopup":"true","aria-expanded":("source"===t).toString(),"aria-controls":s,class:this.classes(w.sourcesButton,w.button),onclick:this._handleSourcesMenuToggleClick,onblur:this._sourcesButtonBlur,afterCreate:p$8,"data-node-ref":"_sourceMenuButtonNode"},o$5("span",{"aria-hidden":"true",class:w.dropdownIcon}),o$5("span",{"aria-hidden":"true",class:w.dropupIcon}),o$5("span",{class:w.sourceName},this._getSourceName(r))):null}renderSourcesList(){const{allSources:e,searchAllEnabled:t}=this.viewModel,{_activeMenuItemIndex:s,activeMenu:i,sourceMenuId:r,sourceMenuButtonId:n}=this,o="source"===i&&s>-1?this._buildId("source-item",s):null;return e.length>1?o$5("ul",{"aria-activedescendant":o,"aria-labelledby":n,id:r,role:"menu",bind:this,afterCreate:p$8,onkeydown:this._handleSourceMenuKeydown,onkeyup:this._handleSourceMenuKeyup,"data-node-ref":"_sourceListNode",class:w.menuList,tabIndex:-1},t?this.renderSource(le.ALL_INDEX):null,e.map(((e,t)=>this.renderSource(t))).toArray()):null}renderSourcesMenu(){const{allSources:e}=this.viewModel;return e.length>1?o$5("div",{key:"esri-search__source-menu",class:this.classes(w.menu,w.sourcesMenu)},this.renderSourcesList()):null}renderLoader(){const{messages:e,messagesCommon:t}=this;return o$5("div",{class:w.loader,key:"base-loader"},o$5("span",{"aria-hidden":"true",class:w.loaderAnimation}),o$5("span",{class:w.fallbackText},e.searchButtonTitle),o$5("span",{class:w.loaderText},t.loading))}renderContainer(){const{allSources:e,state:t}=this.viewModel,{activeMenu:s}=this,i={[w.hasMultipleSources]:e.length>1,[w.isLoading]:"loading"===t,[w.isSearching]:"searching"===t,[w.showWarning]:"warning"===s,[w.showSources]:"source"===s,[w.showSuggestions]:"suggestion"===s};return o$5("div",{class:this.classes(i,w.container),key:"base-container"},this.renderSourceMenuButton(),this.renderSourcesMenu(),this.renderInputContainer(),this.renderSubmitButton(),this.renderWarningMenu())}renderClearButton(){return this.searchTerm?o$5("button",{bind:this,class:this.classes(w.clearButton,w.button),key:"esri-search__clear-button",onclick:this._handleClearButtonClick,onfocus:this._clearButtonFocus,title:this.messages.clearButtonTitle},o$5("span",{"aria-hidden":"true",class:w.clearIcon})):null}renderLocationGroup(){const{messages:e,locationEnabled:t,displayedSearchTerm:s}=this,i=t&&!s,r="suggestion"===this.activeMenu&&0===this._activeMenuItemIndex;return i?o$5("ul",{role:"group",key:"esri-search__suggestion-list-current-location",class:this.classes(w.menuList,w.suggestionList,w.suggestionListCurrentLocation)},o$5("li",{bind:this,"data-current-location-item":!0,onclick:this._handleUseCurrentLocationClick,id:this._buildId("suggestion-item",0),"aria-selected":("suggestion"===this.activeMenu&&0===this._activeMenuItemIndex).toString(),role:"option",class:this.classes(w.menuItem,r?w.menuItemFocus:null)},o$5("span",{"aria-hidden":"true",class:w.locate})," ",e.useCurrentLocation)):null}renderInput(){const{activeMenu:e,locationEnabled:t,displayedSearchTerm:s,messages:i,suggestionsMenuId:r,inputId:n,_activeMenuItemIndex:o}=this,{maxInputLength:a,placeholder:u,searchTerm:l,suggestionCount:c}=this.viewModel,d=!(!(t&&!s)&&!c),g="suggestion"===e&&o>-1?this._buildId("suggestion-item",o):null;return o$5("input",{"aria-activedescendant":g,"aria-autocomplete":"list","aria-expanded":(d&&"suggestion"===e).toString(),"aria-controls":d?r:null,"aria-owns":d?r:null,"aria-haspopup":"listbox","aria-label":i.searchButtonTitle,bind:this,placeholder:u,maxlength:a,autocomplete:"off",type:"text",class:this.classes(w.esriInput,w.input),value:l,id:n,role:"combobox",onkeyup:this._handleInputKeyup,onclick:this._handleInputClick,oninput:this._handleInputPaste,onpaste:this._handleInputPaste,afterCreate:p$8,"data-node-ref":"_inputNode",onfocusout:this._storeRelatedTarget,onfocus:this.focus,onblur:this.blur,title:l?"":u})}renderForm(){return o$5("form",{key:"esri-search__form",bind:this,class:w.form,onsubmit:this._formSubmit,role:"search"},this.renderInput())}renderSuggestList(e){const{sourceIndex:t}=e,s=e.results.length,i=e.results;return s?o$5("ul",{role:"group",key:`esri-search__suggestion-list-${t}`,class:this.classes(w.menuList,w.suggestionList)},i.map((e=>this.renderSuggestion(e,this._menuItemCount++)))):null}renderSuggestionsGroup(){const{suggestions:e}=this.viewModel;return e?e.map((e=>[this.renderSuggestionHeader(e),this.renderSuggestList(e)])):null}renderSuggestionsMenu(){const{displayedSearchTerm:e,locationEnabled:t,suggestionsMenuId:s,inputId:i}=this,{suggestionCount:r}=this.viewModel,n=t&&!e||r;return this._menuItemCount=0,n?o$5("div",{id:s,key:"esri-search__suggestions-menu",class:this.classes(w.menu,w.suggestionsMenu),role:"listbox","aria-labelledby":i,bind:this,afterCreate:p$8,"data-node-ref":"_suggestionListNode"},this.renderLocationGroup(),this.renderSuggestionsGroup()):null}renderInputContainer(){return o$5("div",{key:"esri-search__input-container",class:w.inputContainer},this.renderForm(),this.renderSuggestionsMenu(),this.renderClearButton())}renderSuggestionHeader(e){const{allSources:t,activeSourceIndex:s}=this.viewModel,{sourceIndex:i}=e,r=e.results.length,n=t.length>1&&s===le.ALL_INDEX;return r&&n?o$5("div",{key:`esri-search__suggestion-header-${i}`,class:w.menuHeader},this._getSourceName(i)):null}renderSuggestion(e,t){const{_activeMenuItemIndex:s,messages:i}=this,{searchTerm:r}=this.viewModel;if(r){const{text:n}=e,o=n||i.untitledResult,a=S.test(o),u=[];if(a)u.push(o$5("div",{innerHTML:o}));else {const e=this._splitResult(o,r),t=r.toLowerCase();e.forEach(((e,s)=>{e&&e.length&&(e.toLowerCase()===t?u.push(o$5("strong",{key:s},e)):u.push(e));}));}const l="suggestion"===this.activeMenu&&s===t;return o$5("li",{bind:this,id:this._buildId("suggestion-item",t),"aria-selected":("suggestion"===this.activeMenu&&this._activeMenuItemIndex===t).toString(),onclick:this._handleSuggestionClick,key:`esri-search__suggestion_${t}`,"data-suggestion":e,role:"option",class:this.classes(w.menuItem,l?w.menuItemFocus:null)},u)}}renderSource(e){const{activeSourceIndex:t,searchAllEnabled:s}=this.viewModel,i={[w.menuItemActive]:e===t,[w.menuItemFocus]:"source"===this.activeMenu&&e===(s?this._activeMenuItemIndex-1:this._activeMenuItemIndex)},r=s?e+1:e;return o$5("li",{bind:this,key:`esri-search__source-${e}`,id:this._buildId("source-item",r),"aria-checked":(e===t).toString(),onclick:this._handleSourceClick,"data-source-index":e,role:"menuitemradio",class:this.classes(w.source,w.menuItem,i)},this._getSourceName(e))}renderNoResultsWarning(e){const{messages:t}=this,s=e?s$4(t.noResultsFoundForValue,{value:`"${e}"`}):t.noResultsFound;return o$5("div",{key:"esri-search__no_results"},o$5("div",{class:w.warningMenuHeader},t.noResults),o$5("div",{class:w.warningMenuText},s))}renderEmptySearchWarning(){const{messages:e}=this;return o$5("div",{key:"esri-search__empty-search"},o$5("span",{"aria-hidden":"true",class:w.noticeIcon}),o$5("span",{class:w.noValueText},e.emptyValue))}renderLocateWarning(){const{messages:e}=this;return o$5("div",{key:"esri-search__locate-error"},o$5("span",{"aria-hidden":"true",class:w.noticeIcon}),o$5("span",{class:w.noValueText},e.locateError))}renderWarning(){var e;const{displayedSearchTerm:t,_locateFailed:s}=this,{viewModel:i}=this;return s?this.renderLocateWarning():null!=(e=i.selectedSuggestion)&&e.location||t?this.renderNoResultsWarning(t):this.renderEmptySearchWarning()}_resetActiveMenuItemIndex(){this._activeMenuItemIndex=-1;}_buildId(e,t){return `${this.id}-${e}${void 0===t?"":`-${t}`}`}_watchSourceChanges(){const{_handles:e,viewModel:{allSources:t}}=this,s="sources";e.remove(s),t.forEach((t=>e.add(h$3(t,"name",(()=>this.scheduleRender())),s)));}_handleSourcesMenuToggleClick(){const e="source"===this.activeMenu;var t;(this.activeMenu=e?"none":"source",this.renderNow(),"source"===this.activeMenu)&&(null==(t=this._sourceListNode)||t.focus());}_handleClearButtonClick(){this.viewModel.clear(),this._focus();}_handleSearchButtonClick(){this.search();}_handleSuggestionClick(e){const t=e.currentTarget["data-suggestion"];t&&(this._focus(),this.search(t));}_handleUseCurrentLocationClick(){this._useCurrentLocation();}_useCurrentLocation(){this._focus("none"),this._cancelSuggest(),this._cancelSearch();const e=a$b(),{signal:t}=e;this._searchController=e,this.viewModel.searchNearby({signal:t}).catch((()=>{this._locateFailed=!0,this.activeMenu="warning";})).then((()=>{this._searchController=null;}));}_handleSourceClick(e){this._setSourceFromMenuItem(e.currentTarget);}_setSourceFromMenuItem(e){var t;if(!e)return;const s=e["data-source-index"];this.viewModel.activeSourceIndex=s,this.activeMenu="none",null==(t=this._sourceMenuButtonNode)||t.focus();}_sourcesButtonBlur(e){const t=e&&e.relatedTarget;this._removeActiveMenu(t,this._sourceListNode);}_inputBlur(e){const t=e&&e.relatedTarget;this._removeActiveMenu(t||this._relatedTarget,this._suggestionListNode);}_storeRelatedTarget(e){this._relatedTarget=e.relatedTarget;}_clearButtonFocus(){this.activeMenu="none";}_removeActiveMenu(e,t){!e||e&&t&&t.contains(e)||(this.activeMenu="none");}_cancelSuggest(){this._suggestController&&(this._suggestController.abort(),this._suggestController=null);}_cancelSearch(){this._searchController&&(this._searchController.abort(),this._searchController=null),this._locateFailed=!1;}_handleInputKeyup(e){var t;const s=i$5(e);if(e.ctrlKey||e.metaKey||"Copy"===s||"ArrowLeft"===s||"ArrowRight"===s||"Shift"===s)return;if("Tab"===s||"Escape"===s||e.shiftKey&&"Tab"===s)return this._cancelSuggest(),void("Escape"===s&&(this.activeMenu="none"));const i="Home"===s||"End"===s||"ArrowUp"===s||"ArrowDown"===s;if("Enter"===s&&this._activeMenuItemIndex<0)return void this._cancelSuggest();const r=null==(t=this._suggestionListNode)?void 0:t.getElementsByTagName("li");if(null!=r&&r.length){if("suggestion"!==this.activeMenu&&(this.activeMenu="suggestion"),i)return e.preventDefault(),this._cancelSuggest(),void this.handleItemNavigation(s,r,this._suggestionListNode);const t=r[this._activeMenuItemIndex];if("Enter"===s&&t){const e=t["data-suggestion"];return void(e?(this._focus(),this.search(e)):t["data-current-location-item"]&&this._useCurrentLocation())}}this.viewModel.searchTerm&&this.suggest();}handleItemNavigation(e,t,s){const i=this._activeMenuItemIndex;"Home"===e&&(this._activeMenuItemIndex=0),"End"===e&&(this._activeMenuItemIndex=t.length-1),"ArrowUp"===e&&(this._activeMenuItemIndex=this._activeMenuItemIndex<=0?t.length-1:this._activeMenuItemIndex-1),"ArrowDown"===e&&(this._activeMenuItemIndex=this._activeMenuItemIndex===t.length-1?0:this._activeMenuItemIndex+1),i!==this._activeMenuItemIndex&&L$4(t[this._activeMenuItemIndex],s);}_scrollToTopSuggestion(){this._suggestionListNode&&(this._suggestionListNode.scrollTop=0);}_handleInputClick(){this.activeMenu="suggestion";}_handleInputPaste(e){const t=e.target;this.viewModel.searchTerm!==t.value&&(this.viewModel.searchTerm=t.value),this.viewModel.searchTerm&&this.suggest();}_handleSourceMenuKeydown(e){const t=i$5(e);if(" "!==t&&"Enter"!==t)"ArrowUp"!==t&&"ArrowDown"!==t&&"End"!==t&&"Home"!==t||e.preventDefault();else {e.preventDefault();const t=this._sourceListNode.getElementsByTagName("li")[this._activeMenuItemIndex];this._setSourceFromMenuItem(t);}}_handleSourceMenuKeyup(e){var t;const s=i$5(e),i="ArrowUp"===s||"ArrowDown"===s||"End"===s||"Home"===s;var r;if(i&&e.preventDefault(),"Escape"===s)return this.activeMenu="none",void(null==(r=this._sourceMenuButtonNode)||r.focus());const o=null==(t=this._sourceListNode)?void 0:t.getElementsByTagName("li");return o&&0!==o.length&&i?("source"!==this.activeMenu&&(this.activeMenu="source"),void this.handleItemNavigation(s,o,this._sourceListNode.parentElement)):void 0}_focus(e){this.focus(),e&&(this.activeMenu=e);}_formSubmit(e){e.preventDefault(),-1===this._activeMenuItemIndex&&this.search();}_getSourceName(e){const{messages:t}=this,s=this.viewModel,{allSources:i}=s,r=i.getItemAt(e);return e===le.ALL_INDEX?t.all:r&&r.name||t.untitledSource}_splitResult(e,s){const i=o$7(s);return e.replace(new RegExp(`(^|)(${i})(|$)`,"ig"),"$1|$2|$3").split("|")}_renderSearchResultsContent(){return this._searchResultRenderer.showMoreResultsOpen=!1,this._searchResultRenderer.viewModel=this.viewModel,this._searchResultRenderer}};e$2([y$7()],b.prototype,"_activeMenuItemIndex",void 0),e$2([y$7()],b.prototype,"displayedSearchTerm",null),e$2([y$7({readOnly:!0})],b.prototype,"inputId",null),e$2([y$7({readOnly:!0})],b.prototype,"suggestionsMenuId",null),e$2([y$7({readOnly:!0})],b.prototype,"sourceMenuId",null),e$2([y$7({readOnly:!0})],b.prototype,"sourceMenuButtonId",null),e$2([y$7()],b.prototype,"activeMenu",void 0),e$2([o$6("viewModel.activeSource")],b.prototype,"activeSource",void 0),e$2([o$6("viewModel.activeSourceIndex")],b.prototype,"activeSourceIndex",void 0),e$2([o$6("viewModel.allPlaceholder")],b.prototype,"allPlaceholder",void 0),e$2([o$6("viewModel.allSources")],b.prototype,"allSources",void 0),e$2([o$6("viewModel.autoNavigate")],b.prototype,"autoNavigate",void 0),e$2([o$6("viewModel.autoSelect")],b.prototype,"autoSelect",void 0),e$2([o$6("viewModel.defaultSources")],b.prototype,"defaultSources",void 0),e$2([y$7()],b.prototype,"disabled",void 0),e$2([o$6("viewModel.goToOverride")],b.prototype,"goToOverride",void 0),e$2([y$7()],b.prototype,"iconClass",void 0),e$2([o$6("viewModel.includeDefaultSources")],b.prototype,"includeDefaultSources",void 0),e$2([y$7({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],b.prototype,"label",void 0),e$2([o$6("viewModel.locationEnabled")],b.prototype,"locationEnabled",void 0),e$2([o$6("viewModel.maxResults")],b.prototype,"maxResults",void 0),e$2([o$6("viewModel.maxSuggestions")],b.prototype,"maxSuggestions",void 0),e$2([y$7(),e$8("esri/widgets/Search/t9n/Search")],b.prototype,"messages",void 0),e$2([y$7(),e$8("esri/t9n/common")],b.prototype,"messagesCommon",void 0),e$2([o$6("viewModel.minSuggestCharacters")],b.prototype,"minSuggestCharacters",void 0),e$2([o$6("viewModel.popupEnabled")],b.prototype,"popupEnabled",void 0),e$2([o$6("viewModel.popupTemplate")],b.prototype,"popupTemplate",void 0),e$2([o$6("viewModel.portal")],b.prototype,"portal",void 0),e$2([o$6("viewModel.resultGraphic")],b.prototype,"resultGraphic",void 0),e$2([o$6("viewModel.resultGraphicEnabled")],b.prototype,"resultGraphicEnabled",void 0),e$2([o$6("viewModel.results")],b.prototype,"results",void 0),e$2([o$6("viewModel.searchAllEnabled")],b.prototype,"searchAllEnabled",void 0),e$2([o$6("viewModel.searchTerm")],b.prototype,"searchTerm",void 0),e$2([o$6("viewModel.selectedResult")],b.prototype,"selectedResult",void 0),e$2([o$6("viewModel.sources")],b.prototype,"sources",void 0),e$2([o$6("viewModel.suggestions")],b.prototype,"suggestions",void 0),e$2([o$6("viewModel.suggestionsEnabled")],b.prototype,"suggestionsEnabled",void 0),e$2([o$6("viewModel.view")],b.prototype,"view",void 0),e$2([t$4(["search-complete","search-clear","search-start","select-result","suggest-start","suggest-complete"]),y$7({type:le})],b.prototype,"viewModel",void 0),e$2([o$6("viewModel.clear")],b.prototype,"clear",null),b=e$2([i$4("esri.widgets.Search")],b);var y=b;

export default y;
